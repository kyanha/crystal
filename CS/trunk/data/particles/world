<?xml version="1.0" encoding="utf-8" ?>
<world>
  <plugins>
    <plugin name="thingFact">crystalspace.mesh.loader.factory.thing</plugin>
    <plugin name="thing">crystalspace.mesh.loader.thing</plugin>
    <plugin name="genmeshFactory">crystalspace.mesh.loader.factory.genmesh</plugin>
    <plugin name="genmesh">crystalspace.mesh.loader.genmesh</plugin>
  </plugins>

  <textures>
    <texture name="brick">
      <file>/lib/stdtex/oldbrick.jpg</file>
    </texture>
    <texture name="dot">
      <file>dot.png</file>
    </texture>
  </textures>

  <materials>
    <material name="walls">
      <texture>brick</texture>
    </material>
    <material name="particle">
      <texture>dot</texture>
    </material>
  </materials>


  <settings>
    <clearzbuf>yes</clearzbuf>
    <lightmapcellsize>16</lightmapcellsize>
  </settings>

  <start>
    <sector>room</sector>
    <position x="0" y="5" z="0" />
    <forward x="0" y="0" z="1" />
    <up x="0" y="1" z="0" />
  </start>

  <meshfact name="f">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="-10" y="10" z="10" u="1.000" v="0.000" />
      <v x="10" y="10" z="10" u="0.000" v="0.000" />
      <v x="-10" y="0" z="10" u="1.000" v="1.000" />
      <v x="10" y="0" z="10" u="0.000" v="1.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="b">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="10" y="0" z="-10" u="1.000" v="1.000" />
      <v x="10" y="10" z="-10" u="1.000" v="0.000" />
      <v x="-10" y="0" z="-10" u="0.000" v="1.000" />
      <v x="-10" y="10" z="-10" u="0.000" v="0.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="d">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="10" y="0" z="10" u="1.000" v="1.000" />
      <v x="10" y="0" z="-10" u="1.000" v="0.000" />
      <v x="-10" y="0" z="10" u="0.000" v="1.000" />
      <v x="-10" y="0" z="-10" u="0.000" v="0.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="l">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="10" y="10" z="10" u="1.000" v="0.000" />
      <v x="10" y="10" z="-10" u="0.000" v="0.000" />
      <v x="10" y="0" z="10" u="1.000" v="1.000" />
      <v x="10" y="0" z="-10" u="0.000" v="1.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="u">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="-10" y="10" z="10" u="1.000" v="1.000" />
      <v x="-10" y="10" z="-10" u="1.000" v="0.000" />
      <v x="10" y="10" z="10" u="0.000" v="1.000" />
      <v x="10" y="10" z="-10" u="0.000" v="0.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="r">
    <plugin>genmeshFactory</plugin>
    <params>
      <numtri>2</numtri>
      <numvt>4</numvt>
      <v x="-10" y="0" z="10" u="0.000" v="1.000" />
      <v x="-10" y="0" z="-10" u="1.000" v="1.000" />
      <v x="-10" y="10" z="10" u="0.000" v="0.000" />
      <v x="-10" y="10" z="-10" u="1.000" v="0.000" />
      <t v1="0" v2="1" v3="2" />
      <t v1="3" v2="2" v3="1" />
      <autonormals />
    </params>
  </meshfact>
  <meshfact name="fountainFACT">
    <plugin>crystalspace.mesh.loader.factory.particles</plugin>
    <params>
      <particlesize x="0.1" y="0.1" />
      <sortmode>dot</sortmode>
      <emitter type="cone">
        <emissionrate>50</emissionrate>
        <mass min="5" max="7.5" />
        <extent x="0.5" y="1" z="0" />
        <coneangle>0.2</coneangle>
        <initialvelocity x="2" y="0" z="0" />
        <initialttl min="5" max="5.5" />
      </emitter>
      <effector type="force">
        <acceleration x="0" y="-1" z="0" />
      </effector>
      <effector type="lincolor">
        <color red="0" green="0" blue="1" time="5.5" />
        <color red="0" green="0.5" blue="1" time="2.75" />
        <color red="1" green="1" blue="1" time="0" />
      </effector>
    </params>
  </meshfact>
  
  <meshfact name="fireFACT">
    <plugin>crystalspace.mesh.loader.factory.particles</plugin>
    <params>
      <particlesize x="0.3" y="0.3" />
      <sortmode>dot</sortmode>
      <emitter type="sphere">
        <emissionrate>300</emissionrate>
        <mass min="1" max="1" />
        <radius>0.3</radius>
        <uniformvelocity />
        <initialvelocity x="0" y="4" z="0" />
        <initialttl min="1" max="1.5" />
      </emitter>
      <effector type="force">
        <acceleration x="0" y="-1" z="0" />
      </effector>
      <effector type="lincolor">
        <color red="1.00" green="0.35" blue="0.00" alpha="0" time="1.5" />
        <color red="1.00" green="0.22" blue="0.00" alpha=".1" time="1.3125" />
        <color red="1.00" green="0.12" blue="0.00" alpha=".3" time="1.125" />
        <color red="0.80" green="0.02" blue="0.00" alpha=".8" time="0.9375" />
        <color red="0.60" green="0.00" blue="0.00" alpha=".9" time="0.75" />
        <color red="0.40" green="0.00" blue="0.00" alpha=".97" time="0.5625" />
        <color red="0.20" green="0.00" blue="0.00" alpha="1" time="0.375" />
        <color red="0.00" green="0.00" blue="0.00" alpha="1" time="0.1875" />
        <color red="0.00" green="0.00" blue="0.00" alpha="1" time="0" />
      </effector>
    </params>
  </meshfact> 

  <sector name="room">
    <light name="sun">
      <center x="5" y="5" z="5" />
      <radius>100</radius>
      <color red="4" green="4" blue="4" />
      <influenceradius>100</influenceradius>
      <!-- <attenuation>realistic</attenuation> -->
    </light>

    <meshobj name="u">
      <plugin>genmesh</plugin>
      <params>
        <factory>u</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="d">
      <plugin>genmesh</plugin>
      <params>
        <factory>d</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="l">
      <plugin>genmesh</plugin>
      <params>
        <factory>l</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="r">
      <plugin>genmesh</plugin>
      <params>
        <factory>r</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="f">
      <plugin>genmesh</plugin>
      <params>
        <factory>f</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="b">
      <plugin>genmesh</plugin>
      <params>
        <factory>b</factory>
        <material>walls</material>
      </params>
      <priority>wall</priority>
    </meshobj>
    <meshobj name="fountain">
      <plugin>crystalspace.mesh.loader.particles</plugin>
      <params>
        <factory>fountainFACT</factory>
        <material>particle</material>
        <mixmode>
          <add/>
        </mixmode>
      </params>
      <move>
        <v x="-2.5" y="1" z="5"/>
      </move>
      <priority>alpha</priority>
      <ztest/>
      
    </meshobj>
    <meshobj name="fire">
      <plugin>crystalspace.mesh.loader.particles</plugin>
      <params>
        <factory>fireFACT</factory>
        <material>particle</material>
        <mixmode>
          <add/>
        </mixmode>
      </params>
      <move>
        <v x="0" y="1" z="7"/>
      </move>
      <priority>alpha</priority>
      <ztest/>

    </meshobj>

  </sector>

</world>

