SubDir TOP plugins cscript cspython ;

if $(PYTHON.AVAILABLE) = "yes"
{
  if $(CMD.SWIG)
  {
    # We need to work a bit on our own, because we create cs_pyth.cpp from
    # cspace.i instead of cspace.cpp.
    local target = [ FGristFiles cs_pyth.cpp ] ;
    local sources = [ FGristFiles cspace.i ] ;
    
    # Source files are not in current directory.
    SEARCH on $(sources) = $(TOP)/include/ivaria ;
        
    # Scan for special swig includes.
    HDRGRIST on $(sources) = $(HDRGRIST) ;
    HDRSEARCH on $(sources) =
      $(SEARCH_SOURCE:E) $(SUBDIRHDRS) $(HDRS) $(STDHDRS) ;
    HDRRULE on $(sources) = HeaderRule ;
    HDRSCAN on $(sources) = $(SWIG.HDRPATTERN) ;
    SWIG.FLAGS on $(target) += -python -c++ -shadow -I$(TOP)/include ;

    Swig $(target) : $(sources) ;
  }
  
  Plugin cspython : 
      cs_pyth.cpp cspython.h cspython.cpp pytocs.h pytocs.cpp
  ;
  LinkWith cspython : cstool csgfx csgeom csutil ;
  ExternalLibs cspython : PYTHON ;
  CFlags cspython : -DSWIG_GLOBAL ;
  Help cspython : "Crystal Script Python plug-in" ;
}
