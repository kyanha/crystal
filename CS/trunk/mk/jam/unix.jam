#============================================================================
# Jam configuration and actions for Linux/Unix
#============================================================================
if $(PTHREAD.AVAILABLE) = "yes"
{
  LINKLIBS += $(PTHREAD.LFLAGS) ;
  C++FLAGS += $(PTHREAD.CFLAGS) ;
  CCFLAGS += $(PTHREAD.CFLAGS) ;
}

SHELL ?= "/bin/sh" ;

# only use nasm on x86 for now...
NASM.FLAGS += -f elf ;
SUFPLUGIN ?= .so ;
# disabled (Matze: I really think we should eanble this, regardless of the 1%
# speed loss...)
#PLUGIN.CFLAGS += -fPIC ;

actions LinkPlugin bind NEEDLIBS
{
  $(CMD.LINK) -shared -Wl,-soname -Wl,$(<) -o $(<) $(>) $(EXTRAOBJECTS) $(NEEDLIBS) $(LINKLIBS)
}

actions LinkApplication bind NEEDLIBS bind EXTRAOBJECTS
{
  $(CMD.LINK) -o $(<) $(>) $(EXTRAOBJECTS) $(NEEDLIBS) $(LINKLIBS)
}

rule LinkApplicationConsole
{
  LinkApplication $(<) : $(>) $(EXTRAOBJECTS) ;
}
