if ! $(BUILDTOP)
{
BUILDTOP = . ;
}

# Include config
JAMCONFIG ?= $(BUILDTOP)/Jamconfig ;
include $(JAMCONFIG) ;
if ! $(JAMCONFIG_READ)
{
  EXIT "Couldn't find config. Please configure the project." ;
}

# csutil uses zlib
APPLICATION.LFLAGS += $(ZLIB.LFLAGS) ;
APPLICATION.CFLAGS += $(ZLIB.CFLAGS) ;
# cssys uses pthread
if $(PTHREAD.AVAILABLE) = "yes"
{
  LINKLIBS += $(PTHREAD.LFLAGS) ;
  C++FLAGS += $(PTHREAD.CFLAGS) ;
  CFLAGS += $(PTHREAD.CFLAGS) ;
}

# Put output files into out/systemname.
LOCATE.OBJECTS = $(BUILDTOP)/out/$(OSFULL[1]:L) ;
LOCATE.TARGETS = $(BUILDTOP) ;
LOCATE.DOCS = $(BUILDTOP)/out ;

# List of plugins which should be linked in when building static.
STATIC.PLUGINLIST =
    ball
    ballldr
    bezier
    bezierldr
    bugplug
    crossbld
    csbmpimg
    csconin
    csfont
    csgifimg
    csjpgimg
    csparser
    cspngimg
    cssynldr
    dynavis
    effects
    emit
    emitldr
    engine
    engseq
    explo
    exploldr
    fire
    fireldr
    fountain
    fountldr
    frustvis
    genmesh
    gl3d
    glx2d
    gmeshldr
    gtreeldr
    haze
    hazeldr
    ieplex
    imgplex
    mballldr
    metaball
    metagen
    motion
    motldr
    nullmesh
    rain
    rainldr
    rapid
    reporter
    sequence
    simpcon
    snow
    snowldr
    soft3d
    x2d
    spiral
    spirldr
    spr2d
    spr2dldr
    spr3d
    spr3dldr
    starldr
    stars
    stdrep
    stdpt
    thing
    thingldr
    vfs
    xext86vm
    xextshm
    xwin
    ;

# Include CS build rules.
include $(TOP)/mk/jam/build.jam ;

# Project-specific settings.
if $(TARGET.OS) = MACOS_X
{
  ApplicationIconDefaultOSX appicon.icns : $(TOP) libs cssys macosx ;
}

# Common include directory.
IncludeDir
    $(BUILDTOP)/include
    $(TOP)
    $(TOP)/include
    $(TOP)/apps
    $(TOP)/libs
    $(TOP)/plugins
    ;
