<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csutil/scf.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000022.html">csutil</a></div>
<h1>scf.h</h1><a href="scf_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">    Crystal Space Shared Class Facility (SCF)</span>
00003 <span class="comment">    Copyright (C) 1999 by Andrew Zabolotny</span>
00004 <span class="comment"></span>
00005 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00006 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
00007 <span class="comment">    License as published by the Free Software Foundation; either</span>
00008 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00009 <span class="comment"></span>
00010 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00013 <span class="comment">    Library General Public License for more details.</span>
00014 <span class="comment"></span>
00015 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
00016 <span class="comment">    License along with this library; if not, write to the Free</span>
00017 <span class="comment">    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00018 <span class="comment">*/</span>
00019 
00020 <span class="preprocessor">#ifndef __CSSCF_H__</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define __CSSCF_H__</span>
00022 <span class="preprocessor"></span>
00023 <span class="preprocessor">#include "csextern.h"</span>
00024 
00033 <span class="keyword">class </span><a class="code" href="classcsPluginPaths.html">csPluginPaths</a>;
00034 
00035 <span class="preprocessor">#include "<a class="code" href="ref_8h.html">ref.h</a>"</span>
00036 <span class="preprocessor">#include "<a class="code" href="array_8h.html">array.h</a>"</span>
00037 
<a name="l00041"></a><a class="code" href="group__scf.html#ga0">00041</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> scfInterfaceID;
00042 
00047 <span class="preprocessor">#ifdef SCF_DEBUG</span>
00048 <span class="preprocessor"></span><span class="preprocessor">#  define SCF_TRACE(x)                                                  \</span>
00049 <span class="preprocessor">   {                                                                    \</span>
00050 <span class="preprocessor">     printf ("SCF [%s:%d]:\n", __FILE__, __LINE__);                     \</span>
00051 <span class="preprocessor">     printf x; SCF_PRINT_CALL_ADDRESS                                   \</span>
00052 <span class="preprocessor">   }</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00054"></a><a class="code" href="group__scf.html#ga18">00054</a> <span class="preprocessor"></span><span class="preprocessor">#  define SCF_TRACE(x)</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00056 <span class="preprocessor"></span>
00061 <span class="preprocessor">#if (__GNUC__ &gt;= 3) || ((__GNUC__ &gt;= 2) &amp;&amp; (__GNUC_MINOR__ &gt;= 8))</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#  define SCF_PRINT_CALL_ADDRESS                                        \</span>
00063 <span class="preprocessor">   printf ("  Called from address %p\n", __builtin_return_address (0));</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00065"></a><a class="code" href="group__scf.html#ga19">00065</a> <span class="preprocessor"></span><span class="preprocessor">#  define SCF_PRINT_CALL_ADDRESS</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00067 <span class="preprocessor"></span>
<a name="l00069"></a><a class="code" href="group__scf.html#ga20">00069</a> <span class="preprocessor">#define SCF_CONSTRUCT_VERSION(Major,Minor,Micro)                        \</span>
00070 <span class="preprocessor">  ((Major &lt;&lt; 24) | (Minor &lt;&lt; 16) | Micro)</span>
00071 <span class="preprocessor"></span>
<a name="l00077"></a><a class="code" href="structiBase.html">00077</a> <span class="keyword">struct </span><a class="code" href="structiBase.html">iBase</a>
00078 {
00080   <span class="keyword">virtual</span> <span class="keywordtype">void</span> IncRef () = 0;
00082   <span class="keyword">virtual</span> <span class="keywordtype">void</span> DecRef () = 0;
00084   <span class="keyword">virtual</span> <span class="keywordtype">int</span> GetRefCount () = 0;
00086   <span class="keyword">virtual</span> <span class="keywordtype">void</span> *QueryInterface (<a class="code" href="group__scf.html#ga0">scfInterfaceID</a> iInterfaceID, <span class="keywordtype">int</span> iVersion) = 0;
<a name="l00091"></a><a class="code" href="structiBase.html#e0">00091</a>   <span class="keyword">static</span> <span class="keywordtype">void</span>* QueryInterfaceSafe (<a class="code" href="structiBase.html">iBase</a>* ibase, scfInterfaceID iInterfaceID,
00092         <span class="keywordtype">int</span> iVersion)
00093   {
00094     <span class="keywordflow">if</span> (ibase == 0) <span class="keywordflow">return</span> 0;
00095     <span class="keywordflow">else</span> <span class="keywordflow">return</span> ibase-&gt;<a class="code" href="structiBase.html#a3">QueryInterface</a> (iInterfaceID, iVersion);
00096   }
00098   <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddRefOwner (<a class="code" href="structiBase.html">iBase</a>** ref_owner) = 0;
00100   <span class="keyword">virtual</span> <span class="keywordtype">void</span> RemoveRefOwner (<a class="code" href="structiBase.html">iBase</a>** ref_owner) = 0;
00101 };
00102 
00103 <span class="preprocessor">#ifdef CS_REF_TRACKER</span>
00104 <span class="preprocessor"></span><span class="preprocessor"> #include &lt;typeinfo&gt;</span>
00105 <span class="preprocessor"> #define CS_TYPENAME(x)             typeid(x).name()</span>
00106 <span class="preprocessor"></span> <span class="comment">/* @@@ HACK: Force an AddAlias() call for every contained interface</span>
00107 <span class="comment">  * However, when iSCF::SCF == 0, don't call QI to prevent interface ID </span>
00108 <span class="comment">  * resolution (which will fail).</span>
00109 <span class="comment">  */</span>
00110 <span class="preprocessor"> #define SCF_INIT_TRACKER_ALIASES    \</span>
00111 <span class="preprocessor">  if (iSCF::SCF != 0) QueryInterface ((scfInterfaceID)-1, -1);</span>
00112 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00113 <span class="preprocessor"></span><span class="preprocessor"> #define CS_TYPENAME(x)             0</span>
00114 <span class="preprocessor"></span><span class="preprocessor"> #define SCF_INIT_TRACKER_ALIASES</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00116 <span class="preprocessor"></span>
<a name="l00121"></a><a class="code" href="group__scf.html#ga23">00121</a> <span class="preprocessor">#define SCF_DECLARE_IBASE                                               \</span>
00122 <span class="preprocessor">  int scfRefCount;              </span><span class="comment">/* Reference counter */</span>                 \
00123   csArray&lt;iBase**&gt;* scfWeakRefOwners;                                   \
00124   void scfRemoveRefOwners ();                                           \
00125   SCF_DECLARE_EMBEDDED_IBASE (iBase)
00126 
<a name="l00131"></a><a class="code" href="group__scf.html#ga24">00131</a> <span class="preprocessor">#define SCF_DECLARE_EMBEDDED_IBASE(OuterClass)                          \</span>
00132 <span class="preprocessor">public:                                                                 \</span>
00133 <span class="preprocessor">  OuterClass *scfParent;        </span><span class="comment">/* The parent object */</span>                 \
00134   virtual void IncRef ();                                               \
00135   virtual void DecRef ();                                               \
00136   virtual int GetRefCount ();                                           \
00137   virtual void AddRefOwner (iBase** ref_owner);                         \
00138   virtual void RemoveRefOwner (iBase** ref_owner);                      \
00139   virtual void *QueryInterface (scfInterfaceID iInterfaceID, int iVersion)
00140 
<a name="l00150"></a><a class="code" href="group__scf.html#ga25">00150</a> <span class="preprocessor">#define SCF_CONSTRUCT_IBASE(Parent)                                     \</span>
00151 <span class="preprocessor">  csRefTrackerAccess::TrackConstruction (this);                         \</span>
00152 <span class="preprocessor">  csRefTrackerAccess::SetDescription (this, CS_TYPENAME(*this));        \</span>
00153 <span class="preprocessor">  scfRefCount = 1;                                                      \</span>
00154 <span class="preprocessor">  scfWeakRefOwners = 0;                                                 \</span>
00155 <span class="preprocessor">  scfParent = Parent; if (scfParent) scfParent-&gt;IncRef();               \</span>
00156 <span class="preprocessor">  SCF_INIT_TRACKER_ALIASES                                              </span>
00157 <span class="preprocessor"></span>
<a name="l00167"></a><a class="code" href="group__scf.html#ga26">00167</a> <span class="preprocessor">#define SCF_CONSTRUCT_EMBEDDED_IBASE(Interface)                         \</span>
00168 <span class="preprocessor">  Interface.scfParent = this;                                           \</span>
00169 <span class="preprocessor">  csRefTrackerAccess::AddAlias (&amp;Interface, this);</span>
00170 <span class="preprocessor"></span>
<a name="l00176"></a><a class="code" href="group__scf.html#ga27">00176</a> <span class="preprocessor">#define SCF_DESTRUCT_IBASE()                                            \</span>
00177 <span class="preprocessor">  csRefTrackerAccess::TrackDestruction (this, scfRefCount);             \</span>
00178 <span class="preprocessor">  scfRemoveRefOwners ();</span>
00179 <span class="preprocessor"></span>
<a name="l00186"></a><a class="code" href="group__scf.html#ga28">00186</a> <span class="preprocessor">#define SCF_DESTRUCT_EMBEDDED_IBASE(Interface)                          \</span>
00187 <span class="preprocessor">  csRefTrackerAccess::RemoveAlias (&amp;Interface, this);                   \</span>
00188 <span class="preprocessor">  Interface.scfParent = 0;</span>
00189 <span class="preprocessor"></span>
<a name="l00195"></a><a class="code" href="group__scf.html#ga29">00195</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_INCREF(Class)                               \</span>
00196 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
00197 <span class="preprocessor">{                                                                       \</span>
00198 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;IncRef (%d)\n", #Class, this, scfRefCount + 1));\</span>
00199 <span class="preprocessor">  csRefTrackerAccess::TrackIncRef (this, scfRefCount);                  \</span>
00200 <span class="preprocessor">  scfRefCount++;                                                        \</span>
00201 <span class="preprocessor">}</span>
00202 <span class="preprocessor"></span>
<a name="l00211"></a><a class="code" href="group__scf.html#ga30">00211</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_DECREF(Class)                               \</span>
00212 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
00213 <span class="preprocessor">{                                                                       \</span>
00214 <span class="preprocessor">  csRefTrackerAccess::TrackDecRef (this, scfRefCount);                  \</span>
00215 <span class="preprocessor">  if (scfRefCount == 1)                                                 \</span>
00216 <span class="preprocessor">  {                                                                     \</span>
00217 <span class="preprocessor">    SCF_TRACE ((" delete (%s *)%p\n", #Class, this));                   \</span>
00218 <span class="preprocessor">    scfRemoveRefOwners ();                                              \</span>
00219 <span class="preprocessor">    if (scfParent)                                                      \</span>
00220 <span class="preprocessor">      scfParent-&gt;DecRef ();                                             \</span>
00221 <span class="preprocessor">    delete this;                                                        \</span>
00222 <span class="preprocessor">    return;                                                             \</span>
00223 <span class="preprocessor">  }                                                                     \</span>
00224 <span class="preprocessor">  scfRefCount--;                                                        \</span>
00225 <span class="preprocessor">}</span>
00226 <span class="preprocessor"></span>
<a name="l00233"></a><a class="code" href="group__scf.html#ga31">00233</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_REMOVE_REF_OWNERS(Class)                    \</span>
00234 <span class="preprocessor">void Class::scfRemoveRefOwners ()                                       \</span>
00235 <span class="preprocessor">{                                                                       \</span>
00236 <span class="preprocessor">  if (!scfWeakRefOwners) return;                                        \</span>
00237 <span class="preprocessor">  for (size_t i = 0 ; i &lt; scfWeakRefOwners-&gt;Length () ; i++)            \</span>
00238 <span class="preprocessor">  {                                                                     \</span>
00239 <span class="preprocessor">    iBase** p = (*scfWeakRefOwners)[i];                                 \</span>
00240 <span class="preprocessor">    *p = 0;                                                             \</span>
00241 <span class="preprocessor">  }                                                                     \</span>
00242 <span class="preprocessor">  delete scfWeakRefOwners;                                              \</span>
00243 <span class="preprocessor">  scfWeakRefOwners = 0;                                                 \</span>
00244 <span class="preprocessor">}</span>
00245 <span class="preprocessor"></span>
<a name="l00250"></a><a class="code" href="group__scf.html#ga32">00250</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_REFOWNER(Class)                             \</span>
00251 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
00252 <span class="preprocessor">{                                                                       \</span>
00253 <span class="preprocessor">  if (!scfWeakRefOwners)                                                \</span>
00254 <span class="preprocessor">    scfWeakRefOwners = new csArray&lt;iBase**&gt; (0, 4);                     \</span>
00255 <span class="preprocessor">  scfWeakRefOwners-&gt;InsertSorted (ref_owner);                           \</span>
00256 <span class="preprocessor">}                                                                       \</span>
00257 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
00258 <span class="preprocessor">{                                                                       \</span>
00259 <span class="preprocessor">  if (!scfWeakRefOwners)                                                \</span>
00260 <span class="preprocessor">    return;                                                             \</span>
00261 <span class="preprocessor">  size_t index = scfWeakRefOwners-&gt;FindSortedKey (                      \</span>
00262 <span class="preprocessor">    csArrayCmp&lt;iBase**, iBase**&gt; (ref_owner));                          \</span>
00263 <span class="preprocessor">  if (index != csArrayItemNotFound) scfWeakRefOwners-&gt;DeleteIndex (     \</span>
00264 <span class="preprocessor">    index);                                                             \</span>
00265 <span class="preprocessor">}</span>
00266 <span class="preprocessor"></span>
<a name="l00271"></a><a class="code" href="group__scf.html#ga33">00271</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_GETREFCOUNT(Class)                          \</span>
00272 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
00273 <span class="preprocessor">{                                                                       \</span>
00274 <span class="preprocessor">  return scfRefCount;                                                   \</span>
00275 <span class="preprocessor">}</span>
00276 <span class="preprocessor"></span>
<a name="l00283"></a><a class="code" href="group__scf.html#ga34">00283</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_QUERY(Class)                                \</span>
00284 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
00285 <span class="preprocessor">{                                                                       \</span>
00286 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;QueryInterface (%u, %08X)\n",                \</span>
00287 <span class="preprocessor">    #Class, this, iInterfaceID, iVersion));</span>
00288 <span class="preprocessor"></span>
<a name="l00295"></a><a class="code" href="group__scf.html#ga35">00295</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_QUERY_END                                   \</span>
00296 <span class="preprocessor">  return scfParent ?                                                    \</span>
00297 <span class="preprocessor">    scfParent-&gt;QueryInterface (iInterfaceID, iVersion) : 0;             \</span>
00298 <span class="preprocessor">}</span>
00299 <span class="preprocessor"></span>
<a name="l00305"></a><a class="code" href="group__scf.html#ga36">00305</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE(Class)                                      \</span>
00306 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_INCREF(Class)                                     \</span>
00307 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_DECREF(Class)                                     \</span>
00308 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_GETREFCOUNT(Class)                                \</span>
00309 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_REFOWNER(Class)                                   \</span>
00310 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_REMOVE_REF_OWNERS(Class)                          \</span>
00311 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_QUERY(Class)</span>
00312 <span class="preprocessor"></span>
<a name="l00317"></a><a class="code" href="group__scf.html#ga37">00317</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_END                                         \</span>
00318 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_QUERY_END</span>
00319 <span class="preprocessor"></span>
<a name="l00326"></a><a class="code" href="group__scf.html#ga38">00326</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_INCREF(Class)                      \</span>
00327 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
00328 <span class="preprocessor">{                                                                       \</span>
00329 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;IncRef (%d)\n", #Class, this,                \</span>
00330 <span class="preprocessor">    scfParent-&gt;GetRefCount () + 1));                                    \</span>
00331 <span class="preprocessor">  scfParent-&gt;IncRef ();                                                 \</span>
00332 <span class="preprocessor">}</span>
00333 <span class="preprocessor"></span>
<a name="l00340"></a><a class="code" href="group__scf.html#ga39">00340</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_DECREF(Class)                      \</span>
00341 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
00342 <span class="preprocessor">{                                                                       \</span>
00343 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;DecRef (%d)\n", #Class, this,                \</span>
00344 <span class="preprocessor">              scfParent-&gt;GetRefCount ()-1));                            \</span>
00345 <span class="preprocessor">  scfParent-&gt;DecRef ();                                                 \</span>
00346 <span class="preprocessor">}</span>
00347 <span class="preprocessor"></span>
<a name="l00352"></a><a class="code" href="group__scf.html#ga40">00352</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_GETREFCOUNT(Class)                 \</span>
00353 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
00354 <span class="preprocessor">{                                                                       \</span>
00355 <span class="preprocessor">  return scfParent-&gt;GetRefCount ();                                     \</span>
00356 <span class="preprocessor">}</span>
00357 <span class="preprocessor"></span>
<a name="l00362"></a><a class="code" href="group__scf.html#ga41">00362</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_REFOWNER(Class)                    \</span>
00363 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
00364 <span class="preprocessor">{                                                                       \</span>
00365 <span class="preprocessor">  scfParent-&gt;AddRefOwner (ref_owner);                                   \</span>
00366 <span class="preprocessor">}                                                                       \</span>
00367 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
00368 <span class="preprocessor">{                                                                       \</span>
00369 <span class="preprocessor">  scfParent-&gt;RemoveRefOwner (ref_owner);                                \</span>
00370 <span class="preprocessor">}</span>
00371 <span class="preprocessor"></span>
<a name="l00378"></a><a class="code" href="group__scf.html#ga42">00378</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY(Class)                       \</span>
00379 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
00380 <span class="preprocessor">{                                                                       \</span>
00381 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;QueryInterface (%u, %08X)\n",                \</span>
00382 <span class="preprocessor">    #Class, this, iInterfaceID, iVersion));</span>
00383 <span class="preprocessor"></span>
<a name="l00390"></a><a class="code" href="group__scf.html#ga43">00390</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY_END                          \</span>
00391 <span class="preprocessor">  return scfParent-&gt;QueryInterface (iInterfaceID, iVersion);            \</span>
00392 <span class="preprocessor">}</span>
00393 <span class="preprocessor"></span>
<a name="l00400"></a><a class="code" href="group__scf.html#ga44">00400</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE(Class)                             \</span>
00401 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_INCREF(Class)                            \</span>
00402 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_DECREF(Class)                            \</span>
00403 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_GETREFCOUNT(Class)                       \</span>
00404 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_REFOWNER(Class)                          \</span>
00405 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY(Class)</span>
00406 <span class="preprocessor"></span>
<a name="l00411"></a><a class="code" href="group__scf.html#ga45">00411</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_END                                \</span>
00412 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY_END</span>
00413 <span class="preprocessor"></span>
<a name="l00420"></a><a class="code" href="group__scf.html#ga46">00420</a> <span class="preprocessor">#define SCF_IMPLEMENTS_INTERFACE(Interface)                             \</span>
00421 <span class="preprocessor">  csRefTrackerAccess::AddAlias (CS_STATIC_CAST(Interface*, this), this);\</span>
00422 <span class="preprocessor">  SCF_IMPLEMENTS_INTERFACE_COMMON (Interface, this)</span>
00423 <span class="preprocessor"></span>
<a name="l00428"></a><a class="code" href="group__scf.html#ga47">00428</a> <span class="preprocessor">#define SCF_IMPLEMENTS_EMBEDDED_INTERFACE(Interface)                    \</span>
00429 <span class="preprocessor">  SCF_IMPLEMENTS_INTERFACE_COMMON (Interface, (&amp;scf##Interface))</span>
00430 <span class="preprocessor"></span>
<a name="l00434"></a><a class="code" href="group__scf.html#ga48">00434</a> <span class="preprocessor">#define SCF_IMPLEMENTS_INTERFACE_COMMON(Interface,Object)               \</span>
00435 <span class="preprocessor">  static scfInterfaceID Interface##_scfID = (scfInterfaceID)-1;         \</span>
00436 <span class="preprocessor">  if (Interface##_scfID == (scfInterfaceID)-1)                          \</span>
00437 <span class="preprocessor">    Interface##_scfID = iSCF::SCF-&gt;GetInterfaceID (#Interface);         \</span>
00438 <span class="preprocessor">  if (iInterfaceID == Interface##_scfID &amp;&amp;                              \</span>
00439 <span class="preprocessor">    scfCompatibleVersion (iVersion, scfInterface&lt;Interface&gt;::GetVersion())) \</span>
00440 <span class="preprocessor">  {                                                                     \</span>
00441 <span class="preprocessor">    (Object)-&gt;IncRef ();                                                \</span>
00442 <span class="preprocessor">    return CS_STATIC_CAST(Interface*, Object);                          \</span>
00443 <span class="preprocessor">  }</span>
00444 <span class="preprocessor"></span>
<a name="l00455"></a><a class="code" href="group__scf.html#ga49">00455</a> <span class="preprocessor">#define SCF_DECLARE_IBASE_EXT(ParentClass)                              \</span>
00456 <span class="preprocessor">  typedef ParentClass __scf_superclass;                                 \</span>
00457 <span class="preprocessor">  virtual void IncRef ();                                               \</span>
00458 <span class="preprocessor">  virtual void DecRef ();                                               \</span>
00459 <span class="preprocessor">  virtual int GetRefCount ();                                           \</span>
00460 <span class="preprocessor">  virtual void AddRefOwner (iBase** ref_owner);                         \</span>
00461 <span class="preprocessor">  virtual void RemoveRefOwner (iBase** ref_owner);                      \</span>
00462 <span class="preprocessor">  virtual void *QueryInterface (scfInterfaceID iInterfaceID, int iVersion)</span>
00463 <span class="preprocessor"></span>
<a name="l00470"></a><a class="code" href="group__scf.html#ga50">00470</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_INCREF(Class)                           \</span>
00471 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
00472 <span class="preprocessor">{                                                                       \</span>
00473 <span class="preprocessor">  __scf_superclass::IncRef ();                                          \</span>
00474 <span class="preprocessor">}</span>
00475 <span class="preprocessor"></span>
<a name="l00482"></a><a class="code" href="group__scf.html#ga51">00482</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_DECREF(Class)                           \</span>
00483 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
00484 <span class="preprocessor">{                                                                       \</span>
00485 <span class="preprocessor">  __scf_superclass::DecRef ();                                          \</span>
00486 <span class="preprocessor">}</span>
00487 <span class="preprocessor"></span>
<a name="l00494"></a><a class="code" href="group__scf.html#ga52">00494</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_GETREFCOUNT(Class)                      \</span>
00495 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
00496 <span class="preprocessor">{                                                                       \</span>
00497 <span class="preprocessor">  return __scf_superclass::GetRefCount ();                              \</span>
00498 <span class="preprocessor">}</span>
00499 <span class="preprocessor"></span>
<a name="l00504"></a><a class="code" href="group__scf.html#ga53">00504</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_REFOWNER(Class)                 \</span>
00505 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
00506 <span class="preprocessor">{                                                                       \</span>
00507 <span class="preprocessor">  __scf_superclass::AddRefOwner (ref_owner);                            \</span>
00508 <span class="preprocessor">}                                                                       \</span>
00509 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
00510 <span class="preprocessor">{                                                                       \</span>
00511 <span class="preprocessor">  __scf_superclass::RemoveRefOwner (ref_owner);                         \</span>
00512 <span class="preprocessor">}</span>
00513 <span class="preprocessor"></span>
<a name="l00520"></a><a class="code" href="group__scf.html#ga54">00520</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_QUERY(Class)                            \</span>
00521 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
00522 <span class="preprocessor">{</span>
00523 <span class="preprocessor"></span>
<a name="l00530"></a><a class="code" href="group__scf.html#ga55">00530</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_QUERY_END                               \</span>
00531 <span class="preprocessor">  return __scf_superclass::QueryInterface (iInterfaceID, iVersion);     \</span>
00532 <span class="preprocessor">}</span>
00533 <span class="preprocessor"></span>
<a name="l00538"></a><a class="code" href="group__scf.html#ga56">00538</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT(Class)                                  \</span>
00539 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_INCREF(Class)                                 \</span>
00540 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_DECREF(Class)                                 \</span>
00541 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_GETREFCOUNT(Class)                            \</span>
00542 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_REFOWNER(Class)                               \</span>
00543 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_QUERY(Class)</span>
00544 <span class="preprocessor"></span>
<a name="l00549"></a><a class="code" href="group__scf.html#ga57">00549</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_END                                     \</span>
00550 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_QUERY_END</span>
00551 <span class="preprocessor"></span>
00567 <span class="preprocessor">#ifdef CS_MEMORY_TRACKER</span>
00568 <span class="preprocessor"></span><span class="comment">// This special version of SCF_IMPLEMENT_FACTORY_INIT will make sure that</span>
00569 <span class="comment">// the memory tracker for this plugin is implemented.</span>
00570 <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_INIT(Class)                               \</span>
00571 <span class="preprocessor">static inline void Class ## _scfUnitInitialize(iSCF* SCF)               \</span>
00572 <span class="preprocessor">{                                                                       \</span>
00573 <span class="preprocessor">  iSCF::SCF = SCF;                                                      \</span>
00574 <span class="preprocessor">  extern void RegisterMemoryTrackerModule (char*);                      \</span>
00575 <span class="preprocessor">  RegisterMemoryTrackerModule (#Class);                                 \</span>
00576 <span class="preprocessor">}                                                                       \</span>
00577 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
00578 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfInitialize)(iSCF* SCF)                  \</span>
00579 <span class="preprocessor">{ Class ## _scfUnitInitialize(SCF); }</span>
00580 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00581"></a><a class="code" href="group__scf.html#ga58">00581</a> <span class="preprocessor"></span><span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_INIT(Class)                               \</span>
00582 <span class="preprocessor">static inline void Class ## _scfUnitInitialize(iSCF* SCF)               \</span>
00583 <span class="preprocessor">{ iSCF::SCF = SCF; }                                                    \</span>
00584 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
00585 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfInitialize)(iSCF* SCF)                  \</span>
00586 <span class="preprocessor">{ Class ## _scfUnitInitialize(SCF); }</span>
00587 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00588 <span class="preprocessor"></span>
<a name="l00594"></a><a class="code" href="group__scf.html#ga59">00594</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_FINIS(Class)                              \</span>
00595 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
00596 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfFinalize)()                             \</span>
00597 <span class="preprocessor">{                                                                       \</span>
00598 <span class="preprocessor">CS_STATIC_VARIABLE_CLEANUP                                              \</span>
00599 <span class="preprocessor">}</span>
00600 <span class="preprocessor"></span>
<a name="l00607"></a><a class="code" href="group__scf.html#ga60">00607</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_CREATE(Class)                             \</span>
00608 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
00609 <span class="preprocessor">void* CS_EXPORTED_NAME(Class,_Create)(iBase *iParent)                   \</span>
00610 <span class="preprocessor">{                                                                       \</span>
00611 <span class="preprocessor">  void *ret = new Class (iParent);                                      \</span>
00612 <span class="preprocessor">  SCF_TRACE (("  %p = new %s ()\n", ret, #Class));                      \</span>
00613 <span class="preprocessor">  return ret;                                                           \</span>
00614 <span class="preprocessor">}</span>
00615 <span class="preprocessor"></span>
<a name="l00622"></a><a class="code" href="group__scf.html#ga61">00622</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY(Class)                                    \</span>
00623 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_INIT(Class)                                     \</span>
00624 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_FINIS(Class)                                    \</span>
00625 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_CREATE(Class)</span>
00626 <span class="preprocessor"></span>
00627 <span class="preprocessor">#define SCF_STATIC_CLASS_CONTEXT      "*static*"</span>
00628 <span class="preprocessor"></span>
<a name="l00637"></a><a class="code" href="group__scf.html#ga63">00637</a> <span class="preprocessor">#define SCF_REGISTER_STATIC_CLASS(Class,Ident,Desc,Dep)                 \</span>
00638 <span class="preprocessor">  CS_EXPORTED_FUNCTION void* CS_EXPORTED_NAME(Class,_Create)(iBase*);   \</span>
00639 <span class="preprocessor">  class Class##_StaticInit__                                            \</span>
00640 <span class="preprocessor">  {                                                                     \</span>
00641 <span class="preprocessor">  public:                                                               \</span>
00642 <span class="preprocessor">    Class##_StaticInit__()                                              \</span>
00643 <span class="preprocessor">    {                                                                   \</span>
00644 <span class="preprocessor">      scfInitialize(0);                                                 \</span>
00645 <span class="preprocessor">      iSCF::SCF-&gt;RegisterClass(                                         \</span>
00646 <span class="preprocessor">        CS_EXPORTED_NAME(Class,_Create), Ident, Desc, Dep,              \</span>
00647 <span class="preprocessor">        SCF_STATIC_CLASS_CONTEXT);                                      \</span>
00648 <span class="preprocessor">    }                                                                   \</span>
00649 <span class="preprocessor">  } Class##_static_init__;</span>
00650 <span class="preprocessor"></span>
<a name="l00655"></a><a class="code" href="group__scf.html#ga64">00655</a> <span class="preprocessor">#define SCF_REGISTER_STATIC_LIBRARY(Module, MetaInfo)                   \</span>
00656 <span class="preprocessor">  class Module##_StaticInit                                             \</span>
00657 <span class="preprocessor">  {                                                                     \</span>
00658 <span class="preprocessor">  public:                                                               \</span>
00659 <span class="preprocessor">    Module##_StaticInit()                                               \</span>
00660 <span class="preprocessor">    {                                                                   \</span>
00661 <span class="preprocessor">      scfInitialize(0);                                                 \</span>
00662 <span class="preprocessor">      iSCF::SCF-&gt;RegisterClasses(MetaInfo, SCF_STATIC_CLASS_CONTEXT);   \</span>
00663 <span class="preprocessor">    }                                                                   \</span>
00664 <span class="preprocessor">  } Module##_static_init__;</span>
00665 <span class="preprocessor"></span>
<a name="l00670"></a><a class="code" href="group__scf.html#ga65">00670</a> <span class="preprocessor">#define SCF_DEFINE_FACTORY_FUNC_REGISTRATION(Class)                     \</span>
00671 <span class="preprocessor">  CS_EXPORTED_FUNCTION void* CS_EXPORTED_NAME(Class,_Create)(iBase*);   \</span>
00672 <span class="preprocessor">  class Class##_StaticInit                                              \</span>
00673 <span class="preprocessor">  {                                                                     \</span>
00674 <span class="preprocessor">  public:                                                               \</span>
00675 <span class="preprocessor">    Class##_StaticInit()                                                \</span>
00676 <span class="preprocessor">    {                                                                   \</span>
00677 <span class="preprocessor">      scfInitialize(0);                                                 \</span>
00678 <span class="preprocessor">      iSCF::SCF-&gt;RegisterFactoryFunc(CS_EXPORTED_NAME(Class,_Create),#Class); \</span>
00679 <span class="preprocessor">    }                                                                   \</span>
00680 <span class="preprocessor">  };</span>
00681 <span class="preprocessor"></span>
<a name="l00686"></a><a class="code" href="group__scf.html#ga66">00686</a> <span class="preprocessor">#define SCF_USE_STATIC_PLUGIN(Module)                                   \</span>
00687 <span class="preprocessor">  namespace csStaticPluginInit                                          \</span>
00688 <span class="preprocessor">  {                                                                     \</span>
00689 <span class="preprocessor">    class Module { public: Module(); };                                 \</span>
00690 <span class="preprocessor">    Module Module##_StaticInit;                                         \</span>
00691 <span class="preprocessor">  }</span>
00692 <span class="preprocessor"></span>
<a name="l00701"></a><a class="code" href="group__scf.html#ga67">00701</a> <span class="preprocessor">#define SCF_REGISTER_FACTORY_FUNC(Class)                                \</span>
00702 <span class="preprocessor">  SCF_DEFINE_FACTORY_FUNC_REGISTRATION(Class)                           \</span>
00703 <span class="preprocessor">  Class##_StaticInit Class##_static_init__;</span>
00704 <span class="preprocessor"></span>
00705 <span class="comment">//--------------------------------------------- Class factory interface -----//</span>
00706 
<a name="l00720"></a><a class="code" href="structiFactory.html">00720</a> <span class="keyword">struct </span><a class="code" href="structiFactory.html">iFactory</a> : <span class="keyword">public</span> <a class="code" href="structiBase.html">iBase</a>
00721 {
00723   <span class="keyword">virtual</span> <span class="keywordtype">void</span> *<a class="code" href="structiFactory.html#a0">CreateInstance</a> () = 0;
00725   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiFactory.html#a1">TryUnload</a> () = 0;
00727   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a2">QueryDescription</a> () = 0;
00729   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a3">QueryDependencies</a> () = 0;
00731   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a4">QueryClassID</a> () = 0;
00733   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a5">QueryModuleName</a> () = 0;
00734 };
00735 
00736 <span class="comment">//----------------------------------------------- Client-side functions -----//</span>
00737 
00738 <span class="keyword">struct </span><a class="code" href="structiDocument.html">iDocument</a>;
00739 <span class="keyword">struct </span><a class="code" href="structiStringArray.html">iStringArray</a>;
00740 
<a name="l00742"></a><a class="code" href="group__scf.html#ga1">00742</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span>* (*scfFactoryFunc)(<a class="code" href="structiBase.html">iBase</a>*);
00743 
<a name="l00748"></a><a class="code" href="group__scf.html#ga68">00748</a> <span class="preprocessor">#define SCF_CREATE_INSTANCE(ClassID,Interface)                          \</span>
00749 <span class="preprocessor">  csPtr&lt;Interface&gt; (                                                    \</span>
00750 <span class="preprocessor">    (Interface *)iSCF::SCF-&gt;CreateInstance (                            \</span>
00751 <span class="preprocessor">    ClassID, #Interface, scfInterface&lt;Interface&gt;::GetVersion()))</span>
00752 <span class="preprocessor"></span>
<a name="l00765"></a><a class="code" href="group__scf.html#ga69">00765</a> <span class="preprocessor">#define SCF_VERSION(Name,Major,Minor,Micro)                             \</span>
00766 <span class="preprocessor">struct Name;                                                            \</span>
00767 <span class="preprocessor">CS_SPECIALIZE_TEMPLATE                                                  \</span>
00768 <span class="preprocessor">class scfInterface&lt;Name&gt;                                                \</span>
00769 <span class="preprocessor">{                                                                       \</span>
00770 <span class="preprocessor">public:                                                                 \</span>
00771 <span class="preprocessor">  static int GetVersion()                                               \</span>
00772 <span class="preprocessor">  {                                                                     \</span>
00773 <span class="preprocessor">    return SCF_CONSTRUCT_VERSION(Major, Minor, Micro);                  \</span>
00774 <span class="preprocessor">  }                                                                     \</span>
00775 <span class="preprocessor">  static scfInterfaceID GetID()                                         \</span>
00776 <span class="preprocessor">  {                                                                     \</span>
00777 <span class="preprocessor">    static scfInterfaceID ID = (scfInterfaceID)-1;                      \</span>
00778 <span class="preprocessor">    if (ID == (scfInterfaceID)(-1))                                     \</span>
00779 <span class="preprocessor">      ID = iSCF::SCF-&gt;GetInterfaceID(#Name);                            \</span>
00780 <span class="preprocessor">    return ID;                                                          \</span>
00781 <span class="preprocessor">  }                                                                     \</span>
00782 <span class="preprocessor">  static char const* GetName()                                          \</span>
00783 <span class="preprocessor">  {                                                                     \</span>
00784 <span class="preprocessor">    return #Name;                                                       \</span>
00785 <span class="preprocessor">  }                                                                     \</span>
00786 <span class="preprocessor">}</span>
00787 <span class="preprocessor"></span>
<a name="l00794"></a><a class="code" href="classscfInterface.html">00794</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="classscfInterface.html">scfInterface</a>
00795 {
00796 <span class="keyword">public</span>:
<a name="l00801"></a><a class="code" href="classscfInterface.html#e0">00801</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> GetVersion()
00802   {
00803     CS_ASSERT_MSG(<span class="stringliteral">"illegal invocation of non-specialized "</span>
00804       <span class="stringliteral">"scfInterface&lt;&gt;::GetVersion()"</span>, 1 == 0);
00805     <span class="keywordflow">return</span> 0;
00806   }
00807 
<a name="l00815"></a><a class="code" href="classscfInterface.html#e1">00815</a>   <span class="keyword">static</span> <a class="code" href="group__scf.html#ga0">scfInterfaceID</a> GetID()
00816   {
00817     CS_ASSERT_MSG(<span class="stringliteral">"illegal invocation of non-specialized "</span>
00818       <span class="stringliteral">"scfInterface&lt;&gt;::GetID()"</span>, 1 == 0);
00819     <span class="keywordflow">return</span> (scfInterfaceID)(-1);
00820   }
00821 
<a name="l00825"></a><a class="code" href="classscfInterface.html#e2">00825</a>   <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span>* GetName()
00826   {
00827     CS_ASSERT_MSG(<span class="stringliteral">"illegal invocation of non-specialized "</span>
00828       <span class="stringliteral">"scfInterface&lt;&gt;::GetName()"</span>, 1 == 0);
00829     <span class="keywordflow">return</span> 0;
00830   }
00831 };
00832 
<a name="l00837"></a><a class="code" href="group__scf.html#ga70">00837</a> <span class="preprocessor">#define SCF_QUERY_INTERFACE(Object,Interface)                           \</span>
00838 <span class="preprocessor">  csPtr&lt;Interface&gt; ((Interface *)(Object)-&gt;QueryInterface (             \</span>
00839 <span class="preprocessor">  scfInterface&lt;Interface&gt;::GetID (), scfInterface&lt;Interface&gt;::GetVersion()))</span>
00840 <span class="preprocessor"></span>
<a name="l00846"></a><a class="code" href="group__scf.html#ga71">00846</a> <span class="preprocessor">#define SCF_QUERY_INTERFACE_SAFE(Object,Interface)                      \</span>
00847 <span class="preprocessor">  csPtr&lt;Interface&gt; ((Interface *)(iBase::QueryInterfaceSafe ((Object),  \</span>
00848 <span class="preprocessor">  scfInterface&lt;Interface&gt;::GetID (), scfInterface&lt;Interface&gt;::GetVersion())))</span>
00849 <span class="preprocessor"></span>
00865 <span class="keyword">extern</span> CS_CSUTIL_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga3">scfInitialize</a>(<a class="code" href="classcsPluginPaths.html">csPluginPaths</a>* pluginPaths,
00866   <span class="keywordtype">bool</span> verbose = <span class="keyword">false</span>);
00867 
00872 <span class="keyword">extern</span> CS_CSUTIL_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga3">scfInitialize</a>(<span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> argv[]);
00873 
<a name="l00880"></a><a class="code" href="group__scf.html#ga4">00880</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="group__scf.html#ga4">scfCompatibleVersion</a> (<span class="keywordtype">int</span> iVersion, <span class="keywordtype">int</span> iItfVersion)
00881 {
00882   <span class="keywordflow">return</span> ((iVersion &amp; 0xff000000) == (iItfVersion &amp; 0xff000000))
00883       &amp;&amp; ((iVersion &amp; 0x00ffffff) &lt;= (iItfVersion &amp; 0x00ffffff));
00884 }
00885 
00886 <span class="preprocessor">#if defined(CS_DEBUG) || defined(CS_MEMORY_TRACKER)</span>
00887 <span class="preprocessor"></span>  <span class="keyword">struct </span><a class="code" href="structiObjectRegistry.html">iObjectRegistry</a>;
00888 <span class="preprocessor">#endif</span>
00889 <span class="preprocessor"></span>
<a name="l00896"></a><a class="code" href="structiSCF.html">00896</a> <span class="keyword">struct </span><a class="code" href="structiSCF.html">iSCF</a> : <span class="keyword">public</span> <a class="code" href="structiBase.html">iBase</a>
00897 {
<a name="l00909"></a><a class="code" href="structiSCF.html#s0">00909</a>   <span class="keyword">static</span> CS_CSUTIL_EXPORT <a class="code" href="structiSCF.html">iSCF</a>* SCF;
00910 
00911 <span class="preprocessor">#if defined(CS_DEBUG) || defined(CS_MEMORY_TRACKER)</span>
00912 <span class="preprocessor"></span>  <span class="comment">// This is EXTREMELY dirty but I see no other solution for now.</span>
00913   <span class="comment">// For debugging reasons I must have a global (global over the application</span>
00914   <span class="comment">// and all plugins)pointer to the object registry. I have no other</span>
00915   <span class="comment">// global object to tag this pointer on that except for iSCF.</span>
00916   <span class="comment">// This pointer is only here in debug mode though. That ensures that it</span>
00917   <span class="comment">// cannot be misused in real code.</span>
00918   <span class="comment">// If you know another solution for this problem? This global pointer</span>
00919   <span class="comment">// will be used by csDebuggingGraph in csutil.</span>
00920   <a class="code" href="structiObjectRegistry.html">iObjectRegistry</a>* object_reg;
00921 <span class="preprocessor">#endif</span>
00922 <span class="preprocessor"></span>
00926   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a0">RegisterClasses</a> (<a class="code" href="structiDocument.html">iDocument</a>* metadata,
00927     <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
00928 
00934   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a0">RegisterClasses</a> (<span class="keywordtype">char</span> <span class="keyword">const</span>* xml,
00935     <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
00936 
00940   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a0">RegisterClasses</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* pluginPath,
00941     <a class="code" href="structiDocument.html">iDocument</a>* metadata, <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
00942 
00949   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a3">ClassRegistered</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID) = 0;
00950 
00966   <span class="keyword">virtual</span> <span class="keywordtype">void</span> *<a class="code" href="structiSCF.html#a4">CreateInstance</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID,
00967         <span class="keyword">const</span> <span class="keywordtype">char</span> *iInterface, <span class="keywordtype">int</span> iVersion) = 0;
00968 
00974   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiSCF.html#a5">GetClassDescription</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID) = 0;
00975 
00981   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiSCF.html#a6">GetClassDependencies</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID) = 0;
00982 
01009   <span class="keyword">virtual</span> <a class="code" href="classcsRef.html">csRef&lt;iDocument&gt;</a> <a class="code" href="structiSCF.html#a7">GetPluginMetadata</a> (<span class="keywordtype">char</span> <span class="keyword">const</span> *iClassID) = 0;
01010 
01017   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a8">UnloadUnusedModules</a> () = 0;
01018 
01029   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a9">RegisterClass</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID,
01030         <span class="keyword">const</span> <span class="keywordtype">char</span> *iLibraryName, <span class="keyword">const</span> <span class="keywordtype">char</span> *iFactoryClass,
01031         <span class="keyword">const</span> <span class="keywordtype">char</span> *Description, <span class="keyword">const</span> <span class="keywordtype">char</span> *Dependencies = 0,
01032         <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
01033 
01040   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a9">RegisterClass</a> (scfFactoryFunc, <span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID,
01041         <span class="keyword">const</span> <span class="keywordtype">char</span> *Description, <span class="keyword">const</span> <span class="keywordtype">char</span> *Dependencies = 0,
01042         <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
01043 
01051   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a11">RegisterFactoryFunc</a> (scfFactoryFunc, <span class="keyword">const</span> <span class="keywordtype">char</span> *FactClass) = 0;
01052 
01059   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a12">UnregisterClass</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID) = 0;
01060 
01065   <span class="keyword">virtual</span> <span class="keywordtype">char</span> <span class="keyword">const</span>* <a class="code" href="structiSCF.html#a13">GetInterfaceName</a> (scfInterfaceID) <span class="keyword">const </span>= 0;
01066 
01072   <span class="keyword">virtual</span> <a class="code" href="group__scf.html#ga0">scfInterfaceID</a> <a class="code" href="structiSCF.html#a14">GetInterfaceID</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *iInterface) = 0;
01073 
01080   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a15">Finish</a> () = 0;
01081 
01091   <span class="keyword">virtual</span> <a class="code" href="classcsRef.html">csRef&lt;iStringArray&gt;</a> <a class="code" href="structiSCF.html#a16">QueryClassList</a> (<span class="keywordtype">char</span> <span class="keyword">const</span>* pattern) = 0;
01092 
01096   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiSCF.html#a17">ScanPluginsPath</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* path, <span class="keywordtype">bool</span> recursive = <span class="keyword">false</span>,
01097     <span class="keyword">const</span> <span class="keywordtype">char</span>* context = 0) = 0;
01098 
01108   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiSCF.html#a18">RegisterPlugin</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* path) = 0;
01109 };
01110 
01111 <a class="code" href="group__scf.html#ga69">SCF_VERSION</a> (<a class="code" href="structiFactory.html">iFactory</a>, 0, 0, 2);
01112 <a class="code" href="group__scf.html#ga69">SCF_VERSION</a> (<a class="code" href="structiBase.html">iBase</a>, 0, 1, 0);
01113 <a class="code" href="group__scf.html#ga69">SCF_VERSION</a> (<a class="code" href="structiSCF.html">iSCF</a>, 0, 2, 1);
01114 
01115 <span class="comment">// A bit hacky.</span>
01116 <span class="preprocessor">#include "csutil/reftrackeraccess.h"</span>
01117 
01120 <span class="preprocessor">#endif // __CSSCF_H__</span>
</pre></div><hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.9.1 
</small></address> </div></body> </html>
