<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csColorQuantizer Class Reference (Crystal Space Public API Reference)</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr height="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr height="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>csColorQuantizer Class Reference<br>
<small>
[<a class="el" href="group__gfx.html">Graphics</a>]</small>
</h1><!-- doxytag: class="csColorQuantizer" -->Color quantizer.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="quantize_8h-source.html">csgfx/quantize.h</a>&gt;</code>
<p>
<a href="classcsColorQuantizer-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#1d73ac0678daab7f654b3eb118217bff">Begin</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin quantization.  <a href="#1d73ac0678daab7f654b3eb118217bff"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#a8abf0295b273f9e7eedebc7be0868f8">Bias</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *colors, int count, int weight)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bias the color histogram towards given colors (weight = 0..100).  <a href="#a8abf0295b273f9e7eedebc7be0868f8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#043da94b7c934abd46d5974630f21ddb">Count</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *image, int pixels, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *transp=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Count the colors in a image and update the color histogram.  <a href="#043da94b7c934abd46d5974630f21ddb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#eb05e5b854a5fe981534c9ab7fae5fb1">csColorQuantizer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a new quantizer object.  <a href="#eb05e5b854a5fe981534c9ab7fae5fb1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#c631dd7b8d6ca1d09fc596ef695130ce">DoRGB</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *image, int pixels, int pixperline, <a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;outimage, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&amp;outpalette, int &amp;maxcolors, bool dither)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Quantize a RGB image into a paletted image.  <a href="#c631dd7b8d6ca1d09fc596ef695130ce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#16aadeb718e2c5faab6dcf06f71a8456">End</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finish quantization.  <a href="#16aadeb718e2c5faab6dcf06f71a8456"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&amp;outpalette, int &amp;maxcolors, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *transp=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the optimal palette for all images passed to QuantizeCount().  <a href="#1d78571bdf47a077225861e640b8f6cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#1ffc6b5013e324b4dacbbf749ec3e7ba">Remap</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *image, int pixels, <a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;outimage, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *transp=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remap a image to the palette computed by <a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette()</a>.  <a href="#1ffc6b5013e324b4dacbbf749ec3e7ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#cf258b95d561ecb1467f2cec848d0923">RemapDither</a> (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *image, int pixels, int pixperline, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *palette, int colors, <a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;outimage, <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *transp=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Same but apply Floyd-Steinberg dithering for nicer (but slower) results.  <a href="#cf258b95d561ecb1467f2cec848d0923"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#796cc3fe80954db017e2bfd6331e0f84">~csColorQuantizer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destruct and cleanup.  <a href="#796cc3fe80954db017e2bfd6331e0f84"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2688c45d6dc8868c10467b8a4553c298"></a><!-- doxytag: member="csColorQuantizer::csColorBox" ref="2688c45d6dc8868c10467b8a4553c298" args="" -->
struct&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcsColorQuantizer.html#2688c45d6dc8868c10467b8a4553c298">csColorBox</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Color quantizer. 
<p>
The algorithm presented here is a variation of well-known and widely-used Heckbert quantization algorithm. It works in the following way: first, we build a 3-D histogram that describes which colors and how many times the corresponding colors were used. Since we deal with RGB images, all possible colors counts to 256^3 = 16777216 colors, too much to keep in memory. Because of this, we ignore several lowest bits from each color component, taking into consideration human eye's sensivity to different color components we take 5 bits for R, 6 bits for G and 4 bits for B. This summary reduces to 32*64*16 = 32768 histogram cells, which is a reasonable size for an dynamically-allocated array. <p>
Next, we take the entire color box and split it into subboxes. The split happens along the longest of R,G,B axis into half (and taking again into account eye sensivity). After which we take again the biggest box, and split it again and so on until we have that much boxes how much colors we want. Then we assign to each box a color index, and compute the median RGB value for each box. <p>
To keep memory requirements in reasonable bounds, we scale down R/G/B components to 5/6/4 bits respectively. This produces results that are different from those we'll get with, say, 6/7/6 resolution but its a quite suitable solution, for a quality vs speed choice. I've tried 5/6/5 as well as 6/6/4 and its really hard to say they are better - the results are definitely different but it's hard to say they are really better. <p>
WARNING: If the sum of R+G+B bits exceeds 16, you will a need special case for big endian machines for the INDEX_B macro (see below). With big-endian machines the B component starts at bit 8, thus the right shift counter becomes negative. Probably the best solution is to add an #if B_BIT + 8 - HIST_B_BITS - HIST_G_BITS - HIST_R_BITS &lt; 0.<p>
<b>Quantizing</b><br>
 The following routines can be used to split the quantization process into small steps. First, you should call <a class="el" href="classcsColorQuantizer.html#1d73ac0678daab7f654b3eb118217bff">Begin()</a>. This will allocate some memory for color histogram and also do some other maintenance work. Then you call Count () as much times as you want, to count the frequencies of colors. This is a quite fast operation, thus you can use it, for example, to compute a optimal palette for a large number of images (for example, software 3D renderer uses it for computing the optimal palette in paletted modes, by passing every texture to <a class="el" href="classcsColorQuantizer.html#043da94b7c934abd46d5974630f21ddb">Count()</a>). <p>
When you're finished with images, call <a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette()</a>. This will compute the optimal palette. If you need just that, you can call <a class="el" href="classcsColorQuantizer.html#16aadeb718e2c5faab6dcf06f71a8456">End()</a> and you're done. If you need to remap all those textures to the optimal palette, you can call <a class="el" href="classcsColorQuantizer.html#1ffc6b5013e324b4dacbbf749ec3e7ba">Remap()</a> as much times as you wish. Finally you anyway should call <a class="el" href="classcsColorQuantizer.html#16aadeb718e2c5faab6dcf06f71a8456">End()</a> to free all the memory used by quantizer. <p>
Now, a typical quantization sequence could look like this: <div class="fragment"><pre class="fragment"> <a class="code" href="classcsColorQuantizer.html#1d73ac0678daab7f654b3eb118217bff">Begin</a> ();

    <a class="code" href="classcsColorQuantizer.html#043da94b7c934abd46d5974630f21ddb">Count</a> (image, pixels);
   <a class="code" href="classcsColorQuantizer.html#043da94b7c934abd46d5974630f21ddb">Count</a> (...);
   ...

   <span class="keywordtype">int</span> maxcolors = 256;
   <a class="code" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette</a> (outpalette, maxcolors);
   <span class="comment">// now maxcolors contains the actual number of palette entries</span>

   <a class="code" href="classcsColorQuantizer.html#1ffc6b5013e324b4dacbbf749ec3e7ba">Remap</a> (image, pixels, outimage);
   <a class="code" href="classcsColorQuantizer.html#1ffc6b5013e324b4dacbbf749ec3e7ba">Remap</a> (...);
   ...

 <a class="code" href="classcsColorQuantizer.html#16aadeb718e2c5faab6dcf06f71a8456">End</a> ();
</pre></div> The quantizer itself keeps track of its current state, and will silently ignore invalid calls. For example, if you call <a class="el" href="classcsColorQuantizer.html#1ffc6b5013e324b4dacbbf749ec3e7ba">Remap()</a> right after calling <a class="el" href="classcsColorQuantizer.html#1d73ac0678daab7f654b3eb118217bff">Begin()</a> nothing will happen. You still can call <a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette()</a> right after <a class="el" href="classcsColorQuantizer.html#1d73ac0678daab7f654b3eb118217bff">Begin()</a>, and you will get the expected black (or let's call it `empty') palette. <p>
The Bias routine can be used to introduce a bias inside the currently open color histogram towards given colors. The "weight" parameter shows how important those colors are (0 - not at all, 100 - very). This can be used to bias the resulting palette towards some hard-coded values, for example you may want to use it to create a relatively uniform palette that is somewhat biased towards the colors contained in some picture(s). <p>
Some routines accept an additional parameter (<a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *transp). If it is 0, nothing special is performed. If it is non-0, it should point to an valid <a class="el" href="structcsRGBpixel.html">csRGBpixel</a> object; the color of that pixel will be treated in a special way: <a class="el" href="classcsColorQuantizer.html#043da94b7c934abd46d5974630f21ddb">Count()</a> will ignore pixels of that color, <a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette()</a> will allocate color index 0 for that color, and Remap will map all such pixel values to index 0. 
<p>

<p>
Definition at line <a class="el" href="quantize_8h-source.html#l00129">129</a> of file <a class="el" href="quantize_8h-source.html">quantize.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="eb05e5b854a5fe981534c9ab7fae5fb1"></a><!-- doxytag: member="csColorQuantizer::csColorQuantizer" ref="eb05e5b854a5fe981534c9ab7fae5fb1" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">csColorQuantizer::csColorQuantizer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Construct a new quantizer object. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="796cc3fe80954db017e2bfd6331e0f84"></a><!-- doxytag: member="csColorQuantizer::~csColorQuantizer" ref="796cc3fe80954db017e2bfd6331e0f84" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">csColorQuantizer::~csColorQuantizer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destruct and cleanup. 
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="1d73ac0678daab7f654b3eb118217bff"></a><!-- doxytag: member="csColorQuantizer::Begin" ref="1d73ac0678daab7f654b3eb118217bff" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::Begin           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Begin quantization. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a8abf0295b273f9e7eedebc7be0868f8"></a><!-- doxytag: member="csColorQuantizer::Bias" ref="a8abf0295b273f9e7eedebc7be0868f8" args="(csRGBpixel *colors, int count, int weight)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::Bias           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>colors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>weight</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bias the color histogram towards given colors (weight = 0..100). 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="043da94b7c934abd46d5974630f21ddb"></a><!-- doxytag: member="csColorQuantizer::Count" ref="043da94b7c934abd46d5974630f21ddb" args="(csRGBpixel *image, int pixels, csRGBpixel *transp=0)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::Count           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>image</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>transp</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Count the colors in a image and update the color histogram. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c631dd7b8d6ca1d09fc596ef695130ce"></a><!-- doxytag: member="csColorQuantizer::DoRGB" ref="c631dd7b8d6ca1d09fc596ef695130ce" args="(csRGBpixel *image, int pixels, int pixperline, uint8 *&amp;outimage, csRGBpixel *&amp;outpalette, int &amp;maxcolors, bool dither)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::DoRGB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>image</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixperline</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outimage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outpalette</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>maxcolors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>dither</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Quantize a RGB image into a paletted image. 
<p>
This is a relatively expensive operation, in both CPU and memory resources terms. It is pretty fast though (more than 3.200.000 pixels/sec on a relatively weak P5/166) for what it does. It uses a variation of well-known Heckbert quantization algorithm. The side bonus after quantization is that the palette is ordered in most-used-first fashion. If outimage is 0, it is allocated. If outpalette is 0, it is allocated as well. If it is non-0, the routine supposes that the storage the pointers point to has enough size to store resulting image and palette (the size of resulting image is exactly "pixels" bytes, the size of resulting palette is palsize colors). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>image</em>&nbsp;</td><td>input image </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pixels</em>&nbsp;</td><td>number of pixels in input image </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pixperline</em>&nbsp;</td><td>number of pixels in one line </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outimage</em>&nbsp;</td><td>output image (allocated if 0) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outpalette</em>&nbsp;</td><td>output palette (allocated if 0) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxcolors</em>&nbsp;</td><td>maximal number of colors in output palette (actual number of colors on return) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dither</em>&nbsp;</td><td>Use/do not use Floyd-Steinberg dithering </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="16aadeb718e2c5faab6dcf06f71a8456"></a><!-- doxytag: member="csColorQuantizer::End" ref="16aadeb718e2c5faab6dcf06f71a8456" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::End           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Finish quantization. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1d78571bdf47a077225861e640b8f6cd"></a><!-- doxytag: member="csColorQuantizer::Palette" ref="1d78571bdf47a077225861e640b8f6cd" args="(csRGBpixel *&amp;outpalette, int &amp;maxcolors, csRGBpixel *transp=0)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::Palette           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outpalette</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>maxcolors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>transp</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute the optimal palette for all images passed to QuantizeCount(). 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1ffc6b5013e324b4dacbbf749ec3e7ba"></a><!-- doxytag: member="csColorQuantizer::Remap" ref="1ffc6b5013e324b4dacbbf749ec3e7ba" args="(csRGBpixel *image, int pixels, uint8 *&amp;outimage, csRGBpixel *transp=0)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::Remap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>image</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outimage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>transp</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remap a image to the palette computed by <a class="el" href="classcsColorQuantizer.html#1d78571bdf47a077225861e640b8f6cd">Palette()</a>. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cf258b95d561ecb1467f2cec848d0923"></a><!-- doxytag: member="csColorQuantizer::RemapDither" ref="cf258b95d561ecb1467f2cec848d0923" args="(csRGBpixel *image, int pixels, int pixperline, csRGBpixel *palette, int colors, uint8 *&amp;outimage, csRGBpixel *transp=0)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void csColorQuantizer::RemapDither           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>image</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pixperline</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>palette</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>colors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__util.html#g5f423e669d0a8f4ab7c4c3e6da27161a">uint8</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outimage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structcsRGBpixel.html">csRGBpixel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>transp</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Same but apply Floyd-Steinberg dithering for nicer (but slower) results. 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li>csgfx/<a class="el" href="quantize_8h-source.html">quantize.h</a></ul>
<hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.4.5 
</small></address> </div></body> </html>
