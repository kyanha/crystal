<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csplugincommon/macosx/OSXDriver2D.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000005.html">csplugincommon</a>&nbsp;/&nbsp;<a class="el" href="dir_000010.html">macosx</a></div>
<h1>OSXDriver2D.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">//</span>
00002 <span class="comment">//  OSXDriver2D.h</span>
00003 <span class="comment">//</span>
00004 <span class="comment">//</span>
00005 <span class="comment">//  Created by mreda on Wed Oct 31 2001.</span>
00006 <span class="comment">//  Copyright (c) 2001 Matt Reda. All rights reserved.</span>
00007 <span class="comment">//</span>
00008 
00009 
00010 <span class="comment">// This code must be callable from the ObjC delegate.  Since that uses the</span>
00011 <span class="comment">// standard C compiler, it doesn't like C++ classes, so we create a C API to</span>
00012 <span class="comment">// some functions of this object</span>
00013 
00014 <span class="preprocessor">#ifndef __CS_OSXDRIVER2D_H__</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define __CS_OSXDRIVER2D_H__</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#if defined(__cplusplus)</span>
00018 <span class="preprocessor"></span>
00019 <span class="preprocessor">#include "OSXDelegate2D.h"</span>
00020 
00021 <span class="preprocessor">#include "<a class="code" href="csrect_8h.html">csgeom/csrect.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="OSXAssistant_8h.html">csutil/macosx/OSXAssistant.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="eventh_8h.html">iutil/eventh.h</a>"</span>
00024 <span class="preprocessor">#include "<a class="code" href="ivideo_2graph2d_8h.html">ivideo/graph2d.h</a>"</span>
00025 <span class="preprocessor">#include "csplugincommon/canvas/graph2d.h"</span>
00026 
00027 <span class="preprocessor">#include &lt;CoreFoundation/CoreFoundation.h&gt;</span>
00028 <span class="preprocessor">#include &lt;ApplicationServices/ApplicationServices.h&gt;</span>
00029 
00030 
00031 <span class="comment">// Table for storing gamma values</span>
00032 <span class="keyword">struct </span>GammaTable
00033 {
00034   <span class="keywordtype">float</span> r[256];
00035   <span class="keywordtype">float</span> g[256];
00036   <span class="keywordtype">float</span> b[256];
00037 };
00038 
00039 
00040 <span class="keyword">class </span>OSXDriver2D
00041 {
00042 <span class="keyword">public</span>:
00043   <span class="comment">// Constructor</span>
00044   OSXDriver2D(<a class="code" href="classcsGraphics2D.html">csGraphics2D</a> *inCanvas);
00045 
00046   <span class="comment">// Destructor</span>
00047   <span class="keyword">virtual</span> ~OSXDriver2D();
00048 
00049   <span class="comment">// Initialize 2D plugin</span>
00050   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Initialize(<a class="code" href="structiObjectRegistry.html">iObjectRegistry</a> *reg);
00051 
00052   <span class="comment">// Open graphics system (set mode, open window, etc)</span>
00053   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Open();
00054 
00055   <span class="comment">// Close graphics system</span>
00056   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Close();
00057 
00058   <span class="comment">// Flip video page (or dump to framebuffer) - pure virtual</span>
00059   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Print(<a class="code" href="classcsRect.html">csRect</a> <span class="keyword">const</span>* area = 0) = 0;
00060 
00061   <span class="comment">// Pure virtual function - the driver must invlude code to handle resizing</span>
00062   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Resize(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) = 0;
00063 
00064   <span class="comment">// Handle an event</span>
00065   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> HandleEvent(<a class="code" href="structiEvent.html">iEvent</a> &amp;ev);
00066 
00067   <span class="comment">// Dispatch an event to the assistant</span>
00068   <span class="keyword">inline</span> <span class="keywordtype">void</span> DispatchEvent(OSXEvent ev, OSXView view);
00069 
00070   <span class="comment">// Show/Hide the mouse</span>
00071   <span class="keyword">virtual</span> <span class="keywordtype">void</span> HideMouse();
00072   <span class="keyword">virtual</span> <span class="keywordtype">void</span> ShowMouse();
00073 
00074   <span class="comment">// Event handler</span>
00075   <span class="keyword">struct </span>EventHandler : <span class="keyword">public</span> <a class="code" href="structiEventHandler.html">iEventHandler</a>
00076   {
00077   <span class="keyword">private</span>:
00078     OSXDriver2D *parent;
00079   <span class="keyword">public</span>:
00080     SCF_DECLARE_IBASE;
00081     EventHandler(OSXDriver2D *p)
00082     {
00083       <a class="code" href="group__scf.html#ga25">SCF_CONSTRUCT_IBASE</a>(0);
00084       parent = p;
00085     };
00086     <span class="keyword">virtual</span> ~EventHandler()
00087     {
00088       <a class="code" href="group__scf.html#ga27">SCF_DESTRUCT_IBASE</a>();
00089     };
00090     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="structiEventHandler.html#a0">HandleEvent</a> (<a class="code" href="structiEvent.html">iEvent</a>&amp; e) { <span class="keywordflow">return</span> parent-&gt;HandleEvent(e); }
00091   } *scfiEventHandler;
00092 
00093 <span class="keyword">protected</span>:
00094   <span class="comment">// Initialize pixel format for 16 bit depth</span>
00095   <span class="keywordtype">void</span> Initialize16();
00096 
00097   <span class="comment">// Initialize pixel format for 32 bit depth</span>
00098   <span class="keywordtype">void</span> Initialize32();
00099 
00100   <span class="comment">// Switch to fullscreen mode</span>
00101   <span class="keywordtype">bool</span> EnterFullscreenMode();
00102 
00103   <span class="comment">// Switch out of fullscreen mode, to mode stored in originalMode</span>
00104   <span class="keywordtype">void</span> ExitFullscreenMode();
00105 
00106   <span class="comment">// Toggle current state of fullscreen</span>
00107   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> ToggleFullscreen();
00108 
00109   <span class="comment">// Uses CoreGraphics to fade to a given color </span>
00110   <span class="keywordtype">void</span> FadeToRGB(CGDirectDisplayID disp, <span class="keywordtype">float</span> r, <span class="keywordtype">float</span> g, <span class="keywordtype">float</span> b);
00111   
00112   <span class="comment">// Fade to a given gamma table</span>
00113   <span class="keywordtype">void</span> FadeToGammaTable(CGDirectDisplayID disp, GammaTable table);
00114   
00115   <span class="comment">// Save the current gamma values to the given table</span>
00116   <span class="keywordtype">void</span> SaveGamma(CGDirectDisplayID disp, GammaTable &amp;table);
00117 
00118   <span class="comment">// Choose which display to use</span>
00119   <span class="keywordtype">void</span> ChooseDisplay();
00120 
00121   CFDictionaryRef originalMode;         <span class="comment">// Original display mode</span>
00122   GammaTable originalGamma;             <span class="comment">// Original gamma values</span>
00123   <span class="keywordtype">bool</span> inFullscreenMode;                <span class="comment">// In full-screen mode</span>
00124   CGDirectDisplayID display;            <span class="comment">// Screen to display on</span>
00125   uint32_t screen;                      <span class="comment">// Screen number to display on</span>
00126   
00127   <span class="keywordtype">int</span> origWidth, origHeight;            <span class="comment">// Original dimensions kept so they can</span>
00128                                         <span class="comment">// be restored when switching modes</span>
00129 
00130   OSXDelegate2D delegate;               <span class="comment">// Delegate for ObjC stuff</span>
00131   <a class="code" href="classcsGraphics2D.html">csGraphics2D</a> *canvas;                 <span class="comment">// Canvas (parent class)</span>
00132 
00133   <a class="code" href="classcsRef.html">csRef&lt;iOSXAssistant&gt;</a> assistant;       <span class="comment">// Assistant for dispatching events</span>
00134   <a class="code" href="structiObjectRegistry.html">iObjectRegistry</a> *objectReg;           <span class="comment">// Object registry</span>
00135 };
00136 
00137 <span class="preprocessor">#else // __cplusplus</span>
00138 <span class="preprocessor"></span>
00139 <span class="preprocessor">#define DRV2D_FUNC(ret, func) __private_extern__ inline ret OSXDriver2D_##func</span>
00140 <span class="preprocessor"></span>
00141 <span class="keyword">typedef</span> <span class="keywordtype">void</span> *OSXDriver2D;
00142 <span class="keyword">typedef</span> <span class="keywordtype">void</span> *OSXEventHandle;
00143 <span class="keyword">typedef</span> <span class="keywordtype">void</span> *OSXViewHandle;
00144 
00145 <span class="comment">// C API to driver class</span>
00146 DRV2D_FUNC(<span class="keywordtype">void</span>, DispatchEvent)(OSXDriver2D driver, OSXEventHandle ev,
00147   OSXViewHandle view);
00148 DRV2D_FUNC(<span class="keywordtype">bool</span>, Resize)(OSXDriver2D driver, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h);
00149 DRV2D_FUNC(<span class="keywordtype">void</span>, HideMouse)(OSXDriver2D driver);
00150 DRV2D_FUNC(<span class="keywordtype">void</span>, ShowMouse)(OSXDriver2D driver);
00151 
00152 <span class="preprocessor">#undef DRV2D_FUNC</span>
00153 <span class="preprocessor"></span>
00154 <span class="preprocessor">#endif // __cplusplus</span>
00155 <span class="preprocessor"></span>
00156 <span class="preprocessor">#endif // __CS_OSXDRIVER2D_H__</span>
</pre></div><hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.9.1 
</small></address> </div></body> </html>
