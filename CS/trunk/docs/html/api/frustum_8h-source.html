<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csgeom/frustum.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">csgeom</a></div>
<h1>frustum.h</h1><a href="frustum_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">  Copyright (C) 1998-2001 by Jorrit Tyberghein</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This library is free software; you can redistribute it and/or</span>
00005 <span class="comment">  modify it under the terms of the GNU Library General Public</span>
00006 <span class="comment">  License as published by the Free Software Foundation; either</span>
00007 <span class="comment">  version 2 of the License, or (at your option) any later version.</span>
00008 <span class="comment"></span>
00009 <span class="comment">  This library is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00012 <span class="comment">  Library General Public License for more details.</span>
00013 <span class="comment"></span>
00014 <span class="comment">  You should have received a copy of the GNU Library General Public</span>
00015 <span class="comment">  License along with this library; if not, write to the Free</span>
00016 <span class="comment">  Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#ifndef __CS_FRUSTRUM_H__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define __CS_FRUSTRUM_H__</span>
00021 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include "csextern.h"</span>
00029 
00030 <span class="preprocessor">#include "<a class="code" href="cstypes_8h.html">cstypes.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="ref_8h.html">csutil/ref.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="vector3_8h.html">csgeom/vector3.h</a>"</span>
00033 
00034 <span class="keyword">class </span><a class="code" href="classcsTransform.html">csTransform</a>;
00035 <span class="keyword">class </span><a class="code" href="classcsPlane3.html">csPlane3</a>;
00036 
00042 
<a name="l00043"></a><a class="code" href="group__geom__utils.html#ga67">00043</a> <span class="preprocessor">#define CS_FRUST_OUTSIDE  0</span>
00044 <span class="preprocessor"></span>
<a name="l00045"></a><a class="code" href="group__geom__utils.html#ga68">00045</a> <span class="preprocessor">#define CS_FRUST_INSIDE   1</span>
00046 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="group__geom__utils.html#ga69">00047</a> <span class="preprocessor">#define CS_FRUST_COVERED  2</span>
00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="group__geom__utils.html#ga70">00049</a> <span class="preprocessor">#define CS_FRUST_PARTIAL  3</span>
00050 <span class="preprocessor"></span>
<a name="l00058"></a><a class="code" href="structcsClipInfo.html">00058</a> <span class="keyword">struct </span>CS_CRYSTALSPACE_EXPORT <a class="code" href="structcsClipInfo.html">csClipInfo</a>
00059 {
00060 <span class="preprocessor"># define CS_CLIPINFO_ORIGINAL 0</span>
00061 <span class="preprocessor"></span><span class="preprocessor"># define CS_CLIPINFO_ONEDGE 1</span>
00062 <span class="preprocessor"></span><span class="preprocessor"># define CS_CLIPINFO_INSIDE 2</span>
00063 <span class="preprocessor"></span>  <span class="keywordtype">int</span> type; <span class="comment">// One of CS_CLIPINFO_???</span>
00064   <span class="keyword">union</span>
00065 <span class="keyword">  </span>{
00066     <span class="keyword">struct </span>{ <span class="keywordtype">int</span> idx; } original;
00067     <span class="keyword">struct </span>{ <span class="keywordtype">int</span> i1, i2; <span class="keywordtype">float</span> r; } onedge;
00068     <span class="keyword">struct </span>{ <a class="code" href="structcsClipInfo.html">csClipInfo</a>* ci1, * ci2; <span class="keywordtype">float</span> r; } inside;
00069   };
00070 
00071   <a class="code" href="structcsClipInfo.html">csClipInfo</a> () : type (CS_CLIPINFO_ORIGINAL) { }
00072   <span class="keywordtype">void</span> Clear ();
00073   ~<a class="code" href="structcsClipInfo.html">csClipInfo</a> () { Clear (); }
00074 
<a name="l00076"></a><a class="code" href="structcsClipInfo.html#a3">00076</a>   <span class="keywordtype">void</span> Copy (<a class="code" href="structcsClipInfo.html">csClipInfo</a>&amp; other)
00077   {
00078     <span class="keywordflow">if</span> (&amp;other == <span class="keyword">this</span>) <span class="keywordflow">return</span>;
00079     Clear ();
00080     type = other.<a class="code" href="structcsClipInfo.html#o0">type</a>;
00081     <span class="keywordflow">if</span> (type == CS_CLIPINFO_INSIDE)
00082     {
00083       inside.r = other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.r;
00084       inside.ci1 = <span class="keyword">new</span> <a class="code" href="structcsClipInfo.html">csClipInfo</a> ();
00085       inside.ci1-&gt;Copy (*other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.ci1);
00086       inside.ci2 = <span class="keyword">new</span> <a class="code" href="structcsClipInfo.html">csClipInfo</a> ();
00087       inside.ci2-&gt;Copy (*other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.ci2);
00088     }
00089     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == CS_CLIPINFO_ORIGINAL)
00090       original.idx = other.<a class="code" href="structcsClipInfo.html#o2">original</a>.idx;
00091     <span class="keywordflow">else</span>
00092       onedge = other.<a class="code" href="structcsClipInfo.html#o6">onedge</a>;
00093   }
00094 
<a name="l00096"></a><a class="code" href="structcsClipInfo.html#a4">00096</a>   <span class="keywordtype">void</span> Move (<a class="code" href="structcsClipInfo.html">csClipInfo</a>&amp; other)
00097   {
00098     <span class="keywordflow">if</span> (&amp;other == <span class="keyword">this</span>) <span class="keywordflow">return</span>;
00099     Clear ();
00100     type = other.type;
00101     <span class="keywordflow">if</span> (type == CS_CLIPINFO_INSIDE)
00102       inside = other.inside;
00103     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == CS_CLIPINFO_ORIGINAL)
00104       original.idx = other.original.idx;
00105     <span class="keywordflow">else</span>
00106       onedge = other.onedge;
00107     other.type = CS_CLIPINFO_ORIGINAL;
00108   }
00109 
00110   <span class="keywordtype">void</span> Dump (<span class="keywordtype">int</span> indent)
00111   {
00112     <span class="keywordtype">char</span> ind[255];
00113     <span class="keywordtype">int</span> i;
00114     <span class="keywordflow">for</span> (i = 0 ; i &lt; indent ; i++) ind[i] = <span class="charliteral">' '</span>;
00115     ind[i] = 0;
00116     <span class="keywordflow">switch</span> (type)
00117     {
00118       <span class="keywordflow">case</span> CS_CLIPINFO_ORIGINAL:
00119         printf (<span class="stringliteral">"%s ORIGINAL idx=%d\n"</span>, ind, original.idx);
00120         <span class="keywordflow">break</span>;
00121       <span class="keywordflow">case</span> CS_CLIPINFO_ONEDGE:
00122         printf (<span class="stringliteral">"%s ONEDGE i1=%d i2=%d r=%g\n"</span>, ind, onedge.i1, onedge.i2,
00123           onedge.r);
00124         <span class="keywordflow">break</span>;
00125       <span class="keywordflow">case</span> CS_CLIPINFO_INSIDE:
00126         printf (<span class="stringliteral">"%s INSIDE r=%g\n"</span>, ind, inside.r);
00127         inside.ci1-&gt;Dump (indent+2);
00128         inside.ci2-&gt;Dump (indent+2);
00129         <span class="keywordflow">break</span>;
00130     }
00131     fflush (stdout);
00132   }
00133 };
00134 
<a name="l00145"></a><a class="code" href="classcsFrustum.html">00145</a> <span class="keyword">class </span>CS_CRYSTALSPACE_EXPORT csFrustum
00146 {
00147 <span class="keyword">private</span>:
00149   <a class="code" href="classcsVector3.html">csVector3</a> origin;
00150 
00156   <a class="code" href="classcsVector3.html">csVector3</a>* vertices;
00158   <span class="keywordtype">int</span> num_vertices;
00160   <span class="keywordtype">int</span> max_vertices;
00161 
00163   <a class="code" href="classcsPlane3.html">csPlane3</a>* backplane;
00164 
00172   <span class="keywordtype">bool</span> wide;
00173 
00178   <span class="keywordtype">bool</span> mirrored;
00179 
00181   <span class="keywordtype">int</span> ref_count;
00182 
00184   <span class="keywordtype">void</span> Clear ();
00185 
00187   <span class="keywordtype">void</span> ExtendVertexArray (<span class="keywordtype">int</span> num);
00188 
00189 <span class="keyword">public</span>:
00190 
<a name="l00192"></a><a class="code" href="classcsFrustum.html#a0">00192</a>   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o) :
00193     origin (o), vertices (0), num_vertices (0), max_vertices (0),
00194     backplane (0), wide (false), mirrored (false), ref_count (1)
00195   { }
00196 
00202   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o, <a class="code" href="classcsVector3.html">csVector3</a>* verts, <span class="keywordtype">int</span> num_verts,
00203         <a class="code" href="classcsPlane3.html">csPlane3</a>* backp = 0);
00204 
00210   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o, <span class="keywordtype">int</span> num_verts,
00211         <a class="code" href="classcsPlane3.html">csPlane3</a>* backp = 0);
00212 
00214   csFrustum (<span class="keyword">const</span> csFrustum &amp;copy);
00215 
00217   <span class="keyword">virtual</span> ~csFrustum ();
00218 
<a name="l00220"></a><a class="code" href="classcsFrustum.html#a5">00220</a>   <span class="keywordtype">void</span> SetOrigin (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o) { origin = o; }
00221 
<a name="l00223"></a><a class="code" href="classcsFrustum.html#a6">00223</a>   <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetOrigin () { <span class="keywordflow">return</span> origin; }
00224 
<a name="l00226"></a><a class="code" href="classcsFrustum.html#a7">00226</a>   <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetOrigin ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> origin; }
00227 
<a name="l00233"></a><a class="code" href="classcsFrustum.html#a8">00233</a>   <span class="keywordtype">void</span> SetMirrored (<span class="keywordtype">bool</span> m) { mirrored = m; }
00234 
<a name="l00236"></a><a class="code" href="classcsFrustum.html#a9">00236</a>   <span class="keywordtype">bool</span> IsMirrored ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mirrored; }
00237 
00244   <span class="keywordtype">void</span> SetBackPlane (<a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane);
00245 
<a name="l00249"></a><a class="code" href="classcsFrustum.html#a11">00249</a>   <a class="code" href="classcsPlane3.html">csPlane3</a>* GetBackPlane () { <span class="keywordflow">return</span> backplane; }
00250 
00254   <span class="keywordtype">void</span> RemoveBackPlane ();
00255 
00259   <span class="keywordtype">void</span> AddVertex (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v);
00260 
<a name="l00264"></a><a class="code" href="classcsFrustum.html#a14">00264</a>   <span class="keywordtype">int</span> GetVertexCount () { <span class="keywordflow">return</span> num_vertices; }
00265 
<a name="l00269"></a><a class="code" href="classcsFrustum.html#a15">00269</a>   <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetVertex (<span class="keywordtype">int</span> idx)
00270   {
00271     CS_ASSERT (idx &gt;= 0 &amp;&amp; idx &lt; num_vertices);
00272     <span class="keywordflow">return</span> vertices[idx];
00273   }
00274 
<a name="l00278"></a><a class="code" href="classcsFrustum.html#a16">00278</a>   <a class="code" href="classcsVector3.html">csVector3</a>* GetVertices () { <span class="keywordflow">return</span> vertices; }
00279 
00283   <span class="keywordtype">void</span> Transform (<a class="code" href="classcsTransform.html">csTransform</a>* trans);
00284 
00290   <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2);
00291 
00300   <span class="keyword">static</span> <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>* vertices, <span class="keywordtype">int</span>&amp; num_vertices,
00301     <a class="code" href="structcsClipInfo.html">csClipInfo</a>* clipinfo, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2);
00302 
00311   <span class="keyword">static</span> <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>* vertices, <span class="keywordtype">int</span>&amp; num_vertices,
00312     <a class="code" href="structcsClipInfo.html">csClipInfo</a>* clipinfo, <span class="keyword">const</span> <a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane);
00313 
00320   <span class="keywordtype">void</span> ClipPolyToPlane (<a class="code" href="classcsPlane3.html">csPlane3</a>* plane);
00321 
00330   <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (<span class="keyword">const</span> csFrustum&amp; other) <span class="keyword">const</span>;
00331 
00346   <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (<a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num) <span class="keyword">const</span>;
00347 
00362   <span class="keyword">static</span> <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (
00363     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; frust_origin, <a class="code" href="classcsVector3.html">csVector3</a>* frust, <span class="keywordtype">int</span> num_frust,
00364     <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num);
00365 
00380   <span class="keyword">static</span> <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (
00381     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; frust_origin, <a class="code" href="classcsVector3.html">csVector3</a>* frust, <span class="keywordtype">int</span> num_frust,
00382     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v3);
00383 
00389   <span class="keyword">static</span> <span class="keywordtype">int</span> Classify (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00390     <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num_poly);
00391 
00398   <span class="keyword">static</span> <span class="keywordtype">int</span> BatchClassify (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <a class="code" href="classcsVector3.html">csVector3</a>* frustumNormals,
00399         <span class="keywordtype">int</span> num_frust, <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num_poly);
00400 
00405   <span class="keywordtype">bool</span> Contains (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00406 
00413   <span class="keyword">static</span> <span class="keywordtype">bool</span> Contains (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00414     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00415 
00421   <span class="keyword">static</span> <span class="keywordtype">bool</span> Contains (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00422     <span class="keyword">const</span> <a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00423 
<a name="l00425"></a><a class="code" href="classcsFrustum.html#a23">00425</a>   <span class="keywordtype">bool</span> IsEmpty ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !wide &amp;&amp; vertices == 0; }
00426 
<a name="l00428"></a><a class="code" href="classcsFrustum.html#a24">00428</a>   <span class="keywordtype">bool</span> IsInfinite ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> wide &amp;&amp; vertices == 0 &amp;&amp; backplane == 0; }
00429 
<a name="l00434"></a><a class="code" href="classcsFrustum.html#a25">00434</a>   <span class="keywordtype">bool</span> IsWide ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> wide &amp;&amp; vertices == 0; }
00435 
00440   <span class="keywordtype">void</span> MakeInfinite ();
00441 
00445   <span class="keywordtype">void</span> MakeEmpty ();
00446 
<a name="l00448"></a><a class="code" href="classcsFrustum.html#a28">00448</a>   <span class="keywordtype">void</span> IncRef () { ref_count++; }
<a name="l00450"></a><a class="code" href="classcsFrustum.html#a29">00450</a>   <span class="keywordtype">void</span> DecRef () { <span class="keywordflow">if</span> (ref_count == 1) <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">else</span> ref_count--; }
<a name="l00452"></a><a class="code" href="classcsFrustum.html#a30">00452</a>   <span class="keywordtype">int</span> GetRefCount () { <span class="keywordflow">return</span> ref_count; }
00453 };
00454 
00457 <span class="preprocessor">#endif // __CS_FRUSTRUM_H__</span>
</pre></div><hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.4.2 
</small></address> </div></body> </html>
