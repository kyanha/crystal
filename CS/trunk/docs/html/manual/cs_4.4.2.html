<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Crystal Space: 4.4.2 Scheduling</title>

<meta name="description" content="Crystal Space: 4.4.2 Scheduling">
<meta name="keywords" content="Crystal Space: 4.4.2 Scheduling">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Event-Scheduling"></a>
<a name="4.4.2"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cs_4.4.1.html#4.4.1" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cs_4.4.3.html#4.4.3" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cs_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cs_4.4.html#4.4" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cs_5.html#5." title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="cs_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="cs_Index.html#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="cs_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.4.2 Scheduling </h3>

<p>The event system provides a generic mechanism for representing the order in 
which handlers of particular events should be invoked, regardless of the order 
in which they are initialized or in which their respective plugins are loaded.
</p>
<p>The event scheduler takes advantage of properties exposed by the 
<code>iEventHandler</code> interface to do exactly this.  For each event name that an 
event handler subscribes to, it may also specify essentially arbitrary 
<em>happens-before</em> and <em>happens-after</em> relationships with other event 
handlers, both abstractly ('I want to handle all input events before any 
instance of the <samp>`crystalspace.aws'</samp> handler') and specifically ('I want 
to handle the mouse event only after the <samp>`crystalspace.cel'</samp> event 
handler').
</p>
<p>Specifically, the functions that all <code>iEventHandler</code> implementations 
must provide are:
</p>
<ul>
<li>
<code>const char *GenericName()</code> Returns a simple text name common to all 
instances of this event handler.
</li><li>
<code>csHandlerID GenericID()</code> A csHandlerID is a lightweight way to manage 
generic handler names.  Under almost all circumstances, the implementation of 
this method simply returns <code>csHandlerRegistry::GetID(this-&gt;GenericName())</code>.
</li><li>
<code>const csHandlerID[] GenericPrec(csEventID)</code> Returns an array 
(terminated by <code>CS_EVENTLIST_END</code>) of <samp>`csHandlerID'</samp>s of generic 
event handlers which, for the event name identified by the argument, should 
always handle events with that name <em>before</em> instances of the current handler.
</li><li>
<code>const csHandlerID[] GenericSucc(csEventID)</code> Returns an array 
(terminated by <code>CS_EVENTLIST_END</code>) of <samp>`csHandlerID'</samp>s of generic 
event handlers which, for the event name identified by the argument, should 
always handle events with that name <em>after</em> instances of the current 
handler.
</li><li>
<code>const csHandlerID[] InstancePrec(csEventID)</code> Returns an array 
(terminated by <code>CS_EVENTLIST_END</code>) of <samp>`csHandlerID'</samp>s of both generic 
event handlers and event handler instances which, for the event name 
identified by the argument, should always handle event with that name 
<em>before</em> this <em>particular</em> instance of the event handler.
</li><li>
<code>const csHandlerID[] InstanceSucc(csEventID)</code> Returns an array 
(terminated by <code>CS_EVENTLIST_END</code>) of <samp>`csHandlerID'</samp>s of both generic 
event handlers and event handler instances which, for the event name 
identified by the argument, should always handle event with that name 
<em>after</em> this <em>particular</em> instance of the event handler.
</li></ul>

<p>In many simple cases, you will want to use default implementations of these 
functions provided by the <code>CS_EVENTHANDLER_NAMES()</code> and 
<code>CS_EVENTHANDLER_NIL_CONSTRAINTS</code> macros, like so:
</p><table><tr><td>&nbsp;</td><td><pre class="example"> struct myEventHandler : public iEventHandler
 {
   virtual bool HandleEvent (iEvent &amp;Event)
   {
     foo();
     bar();
     return baz();
   }
   CS_EVENTHANDLER_NAMES(&quot;crystalspace.module.name&quot;)
   CS_EVENTHANDLER_NIL_CONSTRAINTS
 }
</pre></td></tr></table>
<p>As a convention, most csEventHandlers will implement a static method, 
<code>const char *StaticHandlerName()</code>, which can be retrieved and converted 
without instantiating the handler.  This name string can then be converted 
into a <samp>`csHandlerID'</samp> by calling 
<code>csHandlerRegistry::GetID(myHandlerClass::StaticHandlerName())</code>.  
The <samp>`csHandlerID'</samp> of an instance of an event handler class can be 
retrieved by passing a pointer to that class to 
<code>csHandlerRegistry::GetID()</code>, e.g., 
<code>csHandlerRegistry::GetID(new myHandlerClass())</code>.
</p>
<hr size="1">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="cs_4.4.1.html#4.4.1" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="cs_4.4.3.html#4.4.3" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="cs_4.html#4." title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="cs_4.4.html#4.4" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="cs_5.html#5." title="Next chapter"> &gt;&gt; </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
