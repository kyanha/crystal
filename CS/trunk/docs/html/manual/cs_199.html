<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HTML>
<HEAD>
<TITLE>Crystal Space: XML Init Section</TITLE>

<META NAME="description" CONTENT="Crystal Space: XML Init Section">
<META NAME="keywords" CONTENT="Crystal Space: XML Init Section">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC495"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC493"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_200.html#SEC507"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_197.html#SEC492"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC493"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_203.html#SEC516"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC962">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H4> 7.6.1.1 Initalization Section </H4>
<!--docid::SEC495::-->
<P>

This section describes the initialization section.
</P><P>

<A NAME="SEC496"></A>
<H4> Texture Specification Section </H4>
<!--docid::SEC496::-->
<P>

Here is an example texture specification section:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;textures&#62;
  &#60;texture name="wood"&#62;
    &#60;file&#62;/mygamedata/wood.png&#60;/file&#62;
  &#60;/texture&#62;
  &#60;texture name="transp"&#62;
    &#60;file&#62;/mygamedata/stripes.png&#60;/file&#62;
    &#60;transparent red="1" green="0" blue="0"/&#62;
  &#60;/texture&#62;
  &#60;proctex name="plasma"&#62;
    &#60;type&#62;plasma&#60;/type&#62;
  &#60;/proctex&#62;
&#60;/textures&#62;
</pre></td></tr></table></P><P>

In this example we define three textures. The first one is called
`<SAMP>wood</SAMP>' and will be loaded from the VFS file
`<TT>/mygamedata/wood.png</TT>'. See section <A HREF="cs_159.html#SEC393">7.2 Virtual File System (VFS)</A>.
</P><P>

The second texture, `<SAMP>transp</SAMP>', is loaded from
`<TT>/mygamedata/stripes.png</TT>'. The red color will be made fully
transparent. If you want to use an alpha channel then this is supported
too. In that case simply load a PNG image that has an alpha channel (or
any other type of image that supports an alpha channel).
</P><P>

The third texture is a procedural texture. There are four types of
procedural textures predefined in Crystal Space: `<SAMP>fire</SAMP>', `<SAMP>water</SAMP>',
`<SAMP>dots</SAMP>', and `<SAMP>plasma</SAMP>'.
</P><P>

<A NAME="SEC497"></A>
<H4> Material Specification Section </H4>
<!--docid::SEC497::-->
<P>

Materials are very important in Crystal Space. Almost all objects will
use materials to define the surface characteristics of their geometry.
A material itself is usually made from one or more textures.
</P><P>

Here is an example material section. It uses the textures defined
in the previous section:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;materials&#62;
  &#60;material name="table_material"&#62;
    &#60;texture&#62;wood&#60;/texture&#62;
  &#60;/material&#62;
  &#60;material name="fence_material"&#62;
    &#60;texture&#62;transp&#60;/texture&#62;
  &#60;/material&#62;
  &#60;material name="plasma_wood"&#62;
    &#60;texture&#62;wood&#60;/texture&#62;
    &#60;layer&#62;
      &#60;texture&#62;plasma&#60;/texture&#62;
      &#60;scale u="10" v="10" /&#62;
      &#60;mixmode&#62;
        &#60;add /&#62;
        &#60;tiling /&#62;
      &#60;/mixmode&#62;
    &#60;/layer&#62;
  &#60;/material&#62;
&#60;/materials&#62;
</pre></td></tr></table></P><P>

When defining materials you usually use a name that indicates the use of that
material.  That way you can easily replace how the material looks like (by
swapping textures) without having to change the material name itself.
</P><P>

In the example above we first define a `<SAMP>table_material</SAMP>' which uses only
the `<SAMP>wood</SAMP>' texture.  The second material is `<SAMP>fence_material</SAMP>' which
uses the semi-transparent `<SAMP>transp</SAMP>' texture.
</P><P>

The last material is interesting. The base of the material is the
`<SAMP>wood</SAMP>' texture. On top of that there is an additional texture layer
that uses the `<SAMP>plasma</SAMP>' texture. The layer is scaled 10 times in both
<EM>u</EM> and <EM>v</EM> direction and it is added to the original texture
(i.e. the colors are added). The `<SAMP>&#60;tiling /&#62;</SAMP>' flag indicates that the
`<SAMP>plasma</SAMP>' texture will be repeated when needed (i.e. if the surface
on which this material is used is large). Note that not all renderers
support layered materials. In that case the second layer will be ignored.
</P><P>

<A NAME="SEC498"></A>
<H4> Shader Section </H4>
<!--docid::SEC498::-->
<P>

With shaders you can describe more advanced texture and material
effects. The documentation for this section is not up-to-date
since the entire shader system is still work in progress.
</P><P>

<A NAME="SEC499"></A>
<H4> Sounds Section </H4>
<!--docid::SEC499::-->
<P>

@@@Todo.
</P><P>

<A NAME="SEC500"></A>
<H4> Variable Section </H4>
<!--docid::SEC500::-->
<P>

@@@Todo.
</P><P>

<A NAME="SEC501"></A>
<H4> Render Priority Section </H4>
<!--docid::SEC501::-->
<P>

Render priorities are important for deciding when to render objects.
When placing objects in a sector you place them in some render priority
queue (see section <A HREF="cs_122.html#SEC283">5.8.12 Render Priorities and Objects in Sectors</A>).
</P><P>

Here is an example render priority section. It is also the default
render priority section. i.e. if you don't specify render priorities you
will get at least `<SAMP>sky</SAMP>', `<SAMP>wall</SAMP>', `<SAMP>object</SAMP>', and `<SAMP>alpha</SAMP>':
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;renderpriorities&#62;
    &#60;priority name="sky"&#62;
        &#60;level&#62;1&#60;/level&#62;
        &#60;sort&#62;NONE&#60;/sort&#62;
    &#60;/priority&#62;
    &#60;priority name="wall"&#62;
        &#60;level&#62;2&#60;/level&#62;
        &#60;sort&#62;NONE&#60;/sort&#62;
    &#60;/priority&#62;
    &#60;priority name="object"&#62;
        &#60;level&#62;3&#60;/level&#62;
        &#60;sort&#62;NONE&#60;/sort&#62;
    &#60;/priority&#62;
    &#60;priority name="alpha"&#62;
        &#60;level&#62;4&#60;/level&#62;
        &#60;sort&#62;BACK2FRONT&#60;/sort&#62;
    &#60;/priority&#62;
&#60;/renderpriorities&#62;
</pre></td></tr></table></P><P>

<A NAME="SEC502"></A>
<H4> Plugin Section </H4>
<!--docid::SEC502::-->
<P>

The plugin section is purely for convenience later. Normally when creating
mesh objects you have to specify the SCF class name of the loader
which will parse the XML data for that mesh object. This is a long
name. The plugin section allows you to define shorter names for those
plugins. Here is an example where names are defined for the thing,
spr3d, and spr3dfact plugins:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;plugins&#62;
    &#60;plugin name="thing"&#62;
        crystalspace.mesh.loader.thing
    &#60;/plugin&#62;
    &#60;plugin name="spr3dFact"&#62;
        crystalspace.mesh.loader.factory.sprite.3d
    &#60;/plugin&#62;
    &#60;plugin name="spr3d"&#62;
        crystalspace.mesh.loader.sprite.3d
    &#60;/plugin&#62;
&#60;/plugins&#62;
</pre></td></tr></table></P><P>

<A NAME="SEC503"></A>
<H4> Settings Section </H4>
<!--docid::SEC503::-->
<P>

In the settings section there are a few configuration options that you can
specify. Here is a complete settings example:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;settings&#62;
  &#60;clearzbuf /&#62;
  &#60;clearscreen /&#62;
  &#60;lightmapcellsize&#62;16&#60;/lightmapcellsize&#62;
  &#60;maxlightmapsize horizontal="256" vertical="256" /&#62;
  &#60;ambient red=".1" green=".1" blue=".1" /&#62;
  &#60;fastmesh&#62;300&#60;/fastmesh&#62;
&#60;/settings&#62;
</pre></td></tr></table></P><P>

By default Crystal Space does not clear the z-buffer not the screen every
frame. For the z-buffer it depends on objects to fill the z-buffer. In a
typical Crystal Space world every sector would have an outer hull (either
a skybox or else the walls of the room) which would use `<SAMP>zfill</SAMP>' mode
so that the z-buffer is updated but not read. Objects in the room can then
use `<SAMP>zuse</SAMP>'. If you don't want this (i.e. you want to use `<SAMP>zuse</SAMP>'
for all objects) then you can use `<SAMP>clearzbuf</SAMP>'. Similar for
`<SAMP>clearscreen</SAMP>'.
</P><P>

The lightmap cellsize defines how many texels (pixels on a texture) there
are in every lumel (lightmap value). For example, if the lightmap cellsize
is 16 (default) then for every 16x16 texels there will be one lumel.
</P><P>

The maximum lightmap size is usually 256x256. You can change this value
here but this usually doesn't make much sense.
</P><P>

In addition to the lighting information given by all lights in the system,
every object will also get ambient lighting. Ambient lighting is global to
the engine (at least static ambient lighting). You can set the ambient
for a level in the settings block. Default ambient is 0.078 for all color
components.
</P><P>

With `<SAMP>fastmesh</SAMP>' you can control at which point Crystal Space will use
`<SAMP>CS_THING_FASTMESH</SAMP>' for a thing. This is a faster routine (in principle)
but at this moment it only seems to pay off for objects with a high
number of polygons. The default is 500.
</P><P>

<A NAME="SEC504"></A>
<H4> Start Location Section </H4>
<!--docid::SEC504::-->
<P>

A map file can contain zero or more start locations for the camera. How
these start locations are interpreted is up to the application. Typically
there is one start location that has no name and which is considered the
default. But you can have multiple start locations and refer to them by
name in your application. Here is an example:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;start&#62;
    &#60;sector&#62;room&#60;/sector&#62;
    &#60;position x="0" y="0" z="0" /&#62;
&#60;/start&#62;
&#60;start name="alternate"&#62;
    &#60;sector&#62;other_room&#60;/sector&#62;
    &#60;position x="0" y="0" z="0" /&#62;
    &#60;up x="0" y="-1" z="0" /&#62;
    &#60;forward x="0" y="0" z="-1" /&#62;
    &#60;farplane a="0" b="0" c="1" d="100" /&#62;
&#60;/start&#62;
</pre></td></tr></table></P><P>

If there is no start location then by convention many applications assume
that the default start is in sector called `<SAMP>room</SAMP>' at location
`<SAMP>0,0,0</SAMP>'.
</P><P>

The first example above is easy. It just defines the same starting location
as specifying nothing would have done.
</P><P>

The second example is more complicated. It defines a start location called
`<SAMP>alternate</SAMP>'. The up-vector is specified as `<SAMP>0,-1,0</SAMP>' which is just
the reverse of the default `<SAMP>0,1,0</SAMP>'. This means that the camera will
be upside down. The forward vector is `<SAMP>0,0,-1</SAMP>' which means that
the camera will be looking to the negative z axis. By default the camera
looks in the positive z direction.
</P><P>

The last `<SAMP>farplane</SAMP>' option is interesting. It indicates that all
geometry beyond `<SAMP>z=100</SAMP>' will be clipped away. You can use this if
you want to speed up rendering and you know that objects further away than
the specified distance are not interesting or you use fog that would have
made them invisible anyway. Note that fog alone doesn't do that. By default
there is no farplane. If you use the farplane option it is usually recommended
to let the engine clear the z-buffer every frame (see the `<SAMP>settings</SAMP>'
section above) because you can no longer depend on geometry to do it for you
if it is culled away.
</P><P>

<A NAME="SEC505"></A>
<H4> Library Specification Section </H4>
<!--docid::SEC505::-->
<P>

It is possible to define libraries that contain objects like mesh factories,
textures, materials, and so on and then include those libraries in your
map files. Creating a library file is very easy. It is basically the same
as creating a map file but instead of <CODE>&#60;world&#62;</CODE> you would use
<CODE>&#60;library&#62;</CODE>. To use a library you can simply put the following in
your map file:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;library&#62;/mygamedata/library&#60;/library&#62;
</pre></td></tr></table></P><P>

<A NAME="SEC506"></A>
<H4> Keys </H4>
<!--docid::SEC506::-->
<P>

Crystal Space has a system with which you can attach user data to almost
all Crystal Space objects. This user data has a name and several values (string
based) and in code you can query for those name/value pairs. Crystal Space
itself doesn't use this. It only stores the information.
</P><P>

When you specify name/value pairs in the world section itself you are
essentially adding information to the engine class. Here is an example:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;key name="spawn_monster" type="ghost" location="mainhall"
  pos="10,1,12" /&#62;
&#60;key name="spawn_monster" type="goblin" location="corridor"
  pos="15,3,10" /&#62;
</pre></td></tr></table></P><P>

<A NAME="XML World Element Section"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC493"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_200.html#SEC507"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_197.html#SEC492"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC493"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_203.html#SEC516"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC962">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated using
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
