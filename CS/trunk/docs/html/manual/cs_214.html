<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HTML>
<HEAD>
<TITLE>Crystal Space: MeshObject SprCal3D</TITLE>

<META NAME="description" CONTENT="Crystal Space: MeshObject SprCal3D">
<META NAME="keywords" CONTENT="Crystal Space: MeshObject SprCal3D">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC578"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_213.html#SEC571"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_215.html#SEC581"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC492"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_208.html#SEC552"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_228.html#SEC650"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_288.html#SEC939">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H3> 7.8.6 SpriteCal3D Mesh Object </H3>
<!--docid::SEC578::-->
<P>

`<TT>sprcal3d</TT>' is a 3D mesh that can perform skeletal animation using the
Cal3D library.
</P><P>

<A HREF="http://cal3d.sourceforge.net/">http://cal3d.sourceforge.net/</A>
</P><P>

@@@ WRITE ME: Please cover more topics.
</P><P>

<A NAME="SEC579"></A>
<H4> Morph Animations </H4>
<!--docid::SEC579::-->
<P>

You can add morph target meshes to each mesh.  Remember that morph target
meshes need to have the same number of vertices and they need to be in the same
order.  (Do not use the progressive mesh export option!).
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;mesh file="<small>...</small>" name="<small>...</small>" material="<small>...</small>"&#62;
  &#60;morphtarget file="<small>...</small>" name="<small>...</small>"/&#62;
  &#60;morphtarget <small>...</small>/&#62;
  <small>...</small>
&#60;/mesh&#62;
</pre></td></tr></table></P><P>

Each of the morph target meshes need to be assigned to a
`<SAMP>morphanimnation</SAMP>'.  Do not add a `<SAMP>morphtargetmesh</SAMP>' to more than one
`<SAMP>morphanimation</SAMP>', since the library is not designed for this, and it would
cause problems.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;morphanimation name="<small>...</small>"&#62;
  &#60;morphtarget mesh="meshname" morph="morphname"/&#62;
  &#60;morphtarget <small>...</small>/&#62;
  <small>...</small>
&#60;/morphanimation&#62;
</pre></td></tr></table></P><P>

You can test a morphanimation if you load the Cal3D file in the `<TT>viewmesh</TT>'
example program.
</P><P>

You can use morph animations programmatically as follows.
</P><P>

In this example, `<SAMP>cal3dfactorystate</SAMP>' is the Cal3D factory state object.
Using the state object, find the `<SAMP>morphanimationid</SAMP>' with the givven name.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>int morphanimationid =
  cal3dfactorystate-&#62;FindMorphAnimationName(morphanimationname);
</pre></td></tr></table></P><P>

In this example, cal3dstate is the Cal3D state object.  We instruct it to fully
blend (1.0f) the morph animation, over a period of (10.0f) ten seconds.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>cal3dstate-&#62;BlendMorphTarget(morphanimationid, 1.0f, 10.0f);
</pre></td></tr></table></P><P>

This example completely clears a morph animation, over a period of ten seconds
(10.0f).
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>cal3dstate-&#62;ClearMorphTarget(morphanimationid, 10.0f);
</pre></td></tr></table></P><P>

<A NAME="SEC580"></A>
<H4> Sockets </H4>
<!--docid::SEC580::-->
<P>

Sockets enable you to <EM>attach</EM> any mesh object to a triangle.  The attached
mesh object then follows the triangle.  Adding a socket to a Cal3D file
(following the mesh tags) can be done as shown here.  `<SAMP>i</SAMP>', `<SAMP>j</SAMP>', and
`<SAMP>k</SAMP>' should be numbers.  They are all indices.  The loading order of meshes
is maintained, so you can deduce which mesh you are using.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;socket name="<small>...</small>" mesh="i" submesh="j" triangle="k"/&#62;
</pre></td></tr></table></P><P>

You can test a socket if you load the Cal3D file in the `<TT>viewmesh</TT>' example
program.
</P><P>

You can use sockets programmatically as follows.
</P><P>

In this example, `<SAMP>cal3dstate</SAMP>' is the Cal3D state object.  Here we find a
socket with a given name.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>iSpriteCal3DSocket* socket = cal3dstate-&#62;FindSocket(name);
</pre></td></tr></table></P><P>

For this example, `<SAMP>sprite</SAMP>' is the `<SAMP>iMeshWrapper</SAMP>' of the Cal3D sprite,
and `<SAMP>meshwrap</SAMP>' is the `<SAMP>iMeshWrapper</SAMP>' of the mesh object you want to
add.  This adds the `<SAMP>meshwrap</SAMP>' as a hierarchical child of `<SAMP>sprite</SAMP>'.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>sprite-&#62;GetChildren()-&#62;Add(meshwrap);
</pre></td></tr></table></P><P>

Here is how you would set a socket's mesh wrapper.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>socket-&#62;SetMeshWrapper(meshwrap);
</pre></td></tr></table><A NAME="MeshObject Genmesh"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_213.html#SEC571"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_215.html#SEC581"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_198.html#SEC492"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_208.html#SEC552"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_228.html#SEC650"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_288.html#SEC939">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated using
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
