SubDir TOP libs cssys ;

switch $(TARGET.OS)
{
case WIN32 :
  SearchSubdir win32 ;
  SearchSubdir general ; 
  SYSFILES = [ Wildcard win32 : *.cpp *.h ] 
		csprocessorcap.cpp
		findlib.cpp
		getopt.cpp
		pluginpaths.cpp
		resdir.cpp
		runloop.cpp ;
case MACOS_X :
  SearchSubdir macosx ;
  SearchSubdir general ;
  SYSFILES = [ Wildcard macosx : *.cpp *.m *.mm *.h ] 
		apppath.cpp
		csprocessorcap.cpp
		cspthrd.cpp 
		cspthrd.h
		findlib.cpp
		getopt.cpp
		pathutil.cpp 
		pluginpaths.cpp
		printf.cpp
		scanplugins.cpp
		sysroot.cpp ;
  InstallConfig macosx.cfg ;
case * :		# posix/unix/linux mode
  SearchSubdir unix ;
  SearchSubdir general ;
  SYSFILES = [ Filter [ Wildcard unix : *.cpp *.h ] : bfdplugins.cpp ]
		appdir.cpp
		apppath.cpp
		csprocessorcap.cpp
		cspthrd.cpp
		cspthrd.h
		findlib.cpp
		getopt.cpp
		pathutil.cpp
		platformconfig.cpp 
		pluginpaths.cpp
		printf.cpp
		resdir.cpp
		runloop.cpp 
		sysroot.cpp ;
  if $(LIBBFD.AVAILABLE) = "yes"
  {
    SYSFILES += bfdplugins.cpp ;
  }
  else
  {
    SYSFILES += scanplugins.cpp ;
  }
}

Library cssys :
	[ Wildcard *.cpp *.h ]
	$(SYSFILES)
;
CFlags cssys :
  -DCS_CONFIGDIR='\"$(INSTALLDIR.CONFIG)\"' 
  -DCS_PLUGINDIR='\"$(INSTALLDIR.PLUGIN)\"' ;

LibDepends cssys : csutil ;
Help cssys : "Crystal Space system library" ;
