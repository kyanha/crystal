<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csgeom/quaterni.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>csgeom/quaterni.h</h1><a href="quaterni_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">    Copyright (C) 2000 by Norman Kramer</span>
00003 <span class="comment"></span>
00004 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00005 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
00006 <span class="comment">    License as published by the Free Software Foundation; either</span>
00007 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00008 <span class="comment"></span>
00009 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00010 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00012 <span class="comment">    Library General Public License for more details.</span>
00013 <span class="comment"></span>
00014 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
00015 <span class="comment">    License along with this library; if not, write to the Free</span>
00016 <span class="comment">    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#ifndef __CS_QUATERNION_H__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define __CS_QUATERNION_H__</span>
00021 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include "csextern.h"</span>
00029 
00030 <span class="preprocessor">#include "<a class="code" href="math3d_8h.html">csgeom/math3d.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="matrix3_8h.html">csgeom/matrix3.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="csqsqrt_8h.html">csqsqrt.h</a>"</span>
00033 
<a name="l00037"></a><a class="code" href="classcsQuaternion.html">00037</a> <span class="keyword">class </span>CS_CSGEOM_EXPORT csQuaternion
00038 {
00039 <span class="keyword">public</span>:
<a name="l00041"></a><a class="code" href="classcsQuaternion.html#a0">00041</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> Init (<span class="keywordtype">float</span> theR, <span class="keywordtype">float</span> theX, <span class="keywordtype">float</span> theY, <span class="keywordtype">float</span> theZ)
00042   { r = theR; x = theX; y = theY; z = theZ; }
00043 
<a name="l00045"></a><a class="code" href="classcsQuaternion.html#a1">00045</a>   csQuaternion () { Init(0, 0, 0, 0 ); }
<a name="l00047"></a><a class="code" href="classcsQuaternion.html#a2">00047</a>   csQuaternion (<span class="keywordtype">float</span> theR, <span class="keywordtype">float</span> theX=0.0, <span class="keywordtype">float</span> theY=0.0, <span class="keywordtype">float</span> theZ=0.0)
00048   { Init (theR, theX, theY, theZ ); }
<a name="l00050"></a><a class="code" href="classcsQuaternion.html#a3">00050</a>   csQuaternion (<span class="keyword">const</span> csQuaternion&amp; q) { Init (q.r, q.x, q.y, q.z); }
<a name="l00052"></a><a class="code" href="classcsQuaternion.html#a4">00052</a>   csQuaternion (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; q) { Init (0, q.x, q.y, q.z); }
00053 
00055   csQuaternion (<span class="keyword">const</span> <a class="code" href="classcsMatrix3.html">csMatrix3</a>&amp; smat);
00056 
<a name="l00058"></a><a class="code" href="classcsQuaternion.html#n0">00058</a>   <span class="keyword">inline</span> <span class="keyword">friend</span> csQuaternion <a class="code" href="csstring_8h.html#a12">operator+ </a>(<span class="keyword">const</span> csQuaternion&amp; q1,
00059         <span class="keyword">const</span> csQuaternion&amp; q2)
00060   {
00061     <span class="keywordflow">return</span> csQuaternion (q1.<a class="code" href="classcsQuaternion.html#o0">r</a> + q2.<a class="code" href="classcsQuaternion.html#o0">r</a>, q1.<a class="code" href="classcsQuaternion.html#o1">x</a> + q2.<a class="code" href="classcsQuaternion.html#o1">x</a>, q1.<a class="code" href="classcsQuaternion.html#o2">y</a> + q2.<a class="code" href="classcsQuaternion.html#o2">y</a>, q1.<a class="code" href="classcsQuaternion.html#o3">z</a> + q2.<a class="code" href="classcsQuaternion.html#o3">z</a> );
00062   }
00063 
<a name="l00065"></a><a class="code" href="classcsQuaternion.html#n1">00065</a>   <span class="keyword">inline</span> <span class="keyword">friend</span> csQuaternion operator- (<span class="keyword">const</span> csQuaternion&amp; q1,
00066         <span class="keyword">const</span> csQuaternion&amp; q2)
00067   {
00068     <span class="keywordflow">return</span> csQuaternion (q1.<a class="code" href="classcsQuaternion.html#o0">r</a> - q2.<a class="code" href="classcsQuaternion.html#o0">r</a>, q1.<a class="code" href="classcsQuaternion.html#o1">x</a> - q2.<a class="code" href="classcsQuaternion.html#o1">x</a>, q1.<a class="code" href="classcsQuaternion.html#o2">y</a> - q2.<a class="code" href="classcsQuaternion.html#o2">y</a>, q1.<a class="code" href="classcsQuaternion.html#o3">z</a> - q2.<a class="code" href="classcsQuaternion.html#o3">z</a> );
00069   }
00070 
<a name="l00072"></a><a class="code" href="classcsQuaternion.html#n2">00072</a>   <span class="keyword">inline</span> <span class="keyword">friend</span> csQuaternion operator* (<span class="keyword">const</span> csQuaternion&amp; q1,
00073         <span class="keyword">const</span> csQuaternion&amp; q2)
00074   {
00075     <span class="keywordflow">return</span> csQuaternion (q1.<a class="code" href="classcsQuaternion.html#o0">r</a>*q2.<a class="code" href="classcsQuaternion.html#o0">r</a> -  q1.<a class="code" href="classcsQuaternion.html#o1">x</a>*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> - q1.<a class="code" href="classcsQuaternion.html#o2">y</a>*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> - q1.<a class="code" href="classcsQuaternion.html#o3">z</a>*q2.<a class="code" href="classcsQuaternion.html#o3">z</a>,
00076              q1.<a class="code" href="classcsQuaternion.html#o2">y</a>*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> -  q1.<a class="code" href="classcsQuaternion.html#o3">z</a>*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> + q1.<a class="code" href="classcsQuaternion.html#o0">r</a>*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> + q1.<a class="code" href="classcsQuaternion.html#o1">x</a>*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>,
00077              q1.<a class="code" href="classcsQuaternion.html#o3">z</a>*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> -  q1.<a class="code" href="classcsQuaternion.html#o1">x</a>*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> + q1.<a class="code" href="classcsQuaternion.html#o0">r</a>*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> + q1.<a class="code" href="classcsQuaternion.html#o2">y</a>*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>,
00078              q1.<a class="code" href="classcsQuaternion.html#o1">x</a>*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> -  q1.<a class="code" href="classcsQuaternion.html#o2">y</a>*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> + q1.<a class="code" href="classcsQuaternion.html#o0">r</a>*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> + q1.<a class="code" href="classcsQuaternion.html#o3">z</a>*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>);
00079   }
00080 
<a name="l00082"></a><a class="code" href="classcsQuaternion.html#a6">00082</a>   csQuaternion&amp; operator*= (<span class="keyword">const</span> csQuaternion&amp; q2)
00083   {
00084     Init (r*q2.<a class="code" href="classcsQuaternion.html#o0">r</a> -  x*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> - y*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> - z*q2.<a class="code" href="classcsQuaternion.html#o3">z</a>,
00085       y*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> -  z*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> + r*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> + x*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>,
00086       z*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> -  x*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> + r*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> + y*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>,
00087       x*q2.<a class="code" href="classcsQuaternion.html#o2">y</a> -  y*q2.<a class="code" href="classcsQuaternion.html#o1">x</a> + r*q2.<a class="code" href="classcsQuaternion.html#o3">z</a> + z*q2.<a class="code" href="classcsQuaternion.html#o0">r</a>);
00088     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00089   }
00090 
00092   <span class="keywordtype">void</span> Conjugate () { Init (r, -x, -y, -z); }
00093 
<a name="l00095"></a><a class="code" href="classcsQuaternion.html#a8">00095</a>   <span class="keywordtype">void</span> Negate () { Init(-r, -x, -y, -z); }
00096 
00098   <span class="keywordtype">void</span> Invert();
00099 
00105   <span class="keywordtype">void</span> GetAxisAngle(<a class="code" href="classcsVector3.html">csVector3</a>&amp; axis, <span class="keywordtype">float</span>&amp; phi) <span class="keyword">const</span>;
00106 
00112   <span class="keywordtype">void</span> SetWithAxisAngle(<a class="code" href="classcsVector3.html">csVector3</a> axis, <span class="keywordtype">float</span> phi);
00113 
<a name="l00119"></a><a class="code" href="classcsQuaternion.html#a12">00119</a>   <span class="keywordtype">void</span> PrepRotation (<span class="keywordtype">float</span> angle, <a class="code" href="classcsVector3.html">csVector3</a> vec)
00120   {
00121     <span class="keywordtype">double</span> theSin = sin (angle / 2.0f);
00122     Init ((<span class="keywordtype">float</span>) cos (angle / 2.0f), vec.<a class="code" href="classcsVector3.html#o0">x</a> * theSin, vec.<a class="code" href="classcsVector3.html#o1">y</a> * theSin,
00123         vec.<a class="code" href="classcsVector3.html#o2">z</a> * theSin);
00124   }
00125 
<a name="l00127"></a><a class="code" href="classcsQuaternion.html#a13">00127</a>   <a class="code" href="classcsVector3.html">csVector3</a> Rotate (<a class="code" href="classcsVector3.html">csVector3</a> vec)
00128   {
00129     csQuaternion p (vec);
00130     csQuaternion qConj (r, -x, -y, -z);
00131 
00132     p = *<span class="keyword">this</span> * p;
00133     p *= qConj;
00134     <span class="keywordflow">return</span> <a class="code" href="classcsVector3.html">csVector3</a> (p.x, p.y, p.z);
00135   }
00136 
<a name="l00138"></a><a class="code" href="classcsQuaternion.html#a14">00138</a>   <span class="keywordtype">void</span> Normalize ()
00139   {
00140     <span class="keywordtype">float</span> dist, square;
00141     square = x * x + y * y + z * z + r * r;
00142 
00143     <span class="keywordflow">if</span> (square &gt; 0.0) dist = (<span class="keywordtype">float</span>)<a class="code" href="group__floating__point.html#ga6">csQisqrt</a>(square);
00144     <span class="keywordflow">else</span> dist = 1;
00145 
00146     x *= dist;
00147     y *= dist;
00148     z *= dist;
00149     r *= dist;
00150 
00151     <span class="comment">/*if(x*x + y*y + z*z &gt; .999)</span>
00152 <span class="comment">    {</span>
00153 <span class="comment">      // Severe problems...</span>
00154 <span class="comment">      float inverselen = 1.0f / (x*x + y*y + z*z);</span>
00155 <span class="comment">      x *= inverselen;</span>
00156 <span class="comment">      y *= inverselen;</span>
00157 <span class="comment">      z *= inverselen;</span>
00158 <span class="comment">      if(r &gt; 0) r = -1 + r;</span>
00159 <span class="comment">      else r = 1 + r;</span>
00160 <span class="comment">    }</span>
00161 <span class="comment">    else</span>
00162 <span class="comment">    {</span>
00163 <span class="comment">      r = csQsqrt(1.0f - x*x - y*y - z*z);</span>
00164 <span class="comment">      }*/</span>
00165   }
00166 
00172   <span class="keywordtype">void</span> SetWithEuler (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a> &amp;rot);
00173 
00178   <span class="keywordtype">void</span> GetEulerAngles (<a class="code" href="classcsVector3.html">csVector3</a>&amp; angles);
00179 
00183   csQuaternion ToAxisAngle () <span class="keyword">const</span>;
00184 
00190   csQuaternion Slerp (<span class="keyword">const</span> csQuaternion &amp;quat2, <span class="keywordtype">float</span> slerp) <span class="keyword">const</span>;
00191 
00192   <span class="comment">//csQuaternion Lerp(const csQuaternion&amp; quat2, float ratio) const;</span>
00193 
00194   <span class="keywordtype">float</span> r,x,y,z;
00195 };
00196 
00199 <span class="preprocessor">#endif // __CS_QUATERNION_H__</span>
00200 <span class="preprocessor"></span>
</pre></div><hr><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.6 
</small></address> </div></body> </html>
