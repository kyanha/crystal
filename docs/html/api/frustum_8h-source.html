<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csgeom/frustum.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://crystal.sourceforge.net/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>csgeom/frustum.h</h1><a href="frustum_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">  Copyright (C) 1998-2001 by Jorrit Tyberghein</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This library is free software; you can redistribute it and/or</span>
00005 <span class="comment">  modify it under the terms of the GNU Library General Public</span>
00006 <span class="comment">  License as published by the Free Software Foundation; either</span>
00007 <span class="comment">  version 2 of the License, or (at your option) any later version.</span>
00008 <span class="comment"></span>
00009 <span class="comment">  This library is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00012 <span class="comment">  Library General Public License for more details.</span>
00013 <span class="comment"></span>
00014 <span class="comment">  You should have received a copy of the GNU Library General Public</span>
00015 <span class="comment">  License along with this library; if not, write to the Free</span>
00016 <span class="comment">  Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#ifndef __CS_FRUSTRUM_H__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define __CS_FRUSTRUM_H__</span>
00021 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include "csextern.h"</span>
00029 
00030 <span class="preprocessor">#include "<a class="code" href="cstypes_8h.html">cstypes.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="math3d_8h.html">csgeom/math3d.h</a>"</span>
00032 
00033 <span class="keyword">class </span><a class="code" href="classcsTransform.html">csTransform</a>;
00034 
00040 
<a name="l00041"></a><a class="code" href="group__geom__utils.html#a62">00041</a> <span class="preprocessor">#define CS_FRUST_OUTSIDE  0</span>
00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="group__geom__utils.html#a63">00043</a> <span class="preprocessor">#define CS_FRUST_INSIDE   1</span>
00044 <span class="preprocessor"></span>
<a name="l00045"></a><a class="code" href="group__geom__utils.html#a64">00045</a> <span class="preprocessor">#define CS_FRUST_COVERED  2</span>
00046 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="group__geom__utils.html#a65">00047</a> <span class="preprocessor">#define CS_FRUST_PARTIAL  3</span>
00048 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="structcsClipInfo.html">00056</a> <span class="keyword">struct </span>CS_CSGEOM_EXPORT csClipInfo
00057 {
00058 <span class="preprocessor"># define CS_CLIPINFO_ORIGINAL 0</span>
00059 <span class="preprocessor"></span><span class="preprocessor"># define CS_CLIPINFO_ONEDGE 1</span>
00060 <span class="preprocessor"></span><span class="preprocessor"># define CS_CLIPINFO_INSIDE 2</span>
00061 <span class="preprocessor"></span>  <span class="keywordtype">int</span> type; <span class="comment">// One of CS_CLIPINFO_???</span>
00062   <span class="keyword">union</span>
00063 <span class="keyword">  </span>{
00064     <span class="keyword">struct </span>{ <span class="keywordtype">int</span> idx; } original;
00065     <span class="keyword">struct </span>{ <span class="keywordtype">int</span> i1, i2; <span class="keywordtype">float</span> r; } onedge;
00066     <span class="keyword">struct </span>{ csClipInfo* ci1, * ci2; <span class="keywordtype">float</span> r; } inside;
00067   };
00068 
00069   csClipInfo () : type (CS_CLIPINFO_ORIGINAL) { }
00070   <span class="keywordtype">void</span> Clear ();
00071   ~csClipInfo () { Clear (); }
00072 
<a name="l00074"></a><a class="code" href="structcsClipInfo.html#a3">00074</a>   <span class="keywordtype">void</span> Copy (csClipInfo&amp; other)
00075   {
00076     <span class="keywordflow">if</span> (&amp;other == <span class="keyword">this</span>) <span class="keywordflow">return</span>;
00077     Clear ();
00078     type = other.<a class="code" href="structcsClipInfo.html#o0">type</a>;
00079     <span class="keywordflow">if</span> (type == CS_CLIPINFO_INSIDE)
00080     {
00081       inside.r = other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.r;
00082       inside.ci1 = <span class="keyword">new</span> csClipInfo ();
00083       inside.ci1-&gt;Copy (*other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.ci1);
00084       inside.ci2 = <span class="keyword">new</span> csClipInfo ();
00085       inside.ci2-&gt;Copy (*other.<a class="code" href="structcsClipInfo.html#o9">inside</a>.ci2);
00086     }
00087     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == CS_CLIPINFO_ORIGINAL)
00088       original.idx = other.<a class="code" href="structcsClipInfo.html#o2">original</a>.idx;
00089     <span class="keywordflow">else</span>
00090       onedge = other.<a class="code" href="structcsClipInfo.html#o6">onedge</a>;
00091   }
00092 
<a name="l00094"></a><a class="code" href="structcsClipInfo.html#a4">00094</a>   <span class="keywordtype">void</span> Move (csClipInfo&amp; other)
00095   {
00096     <span class="keywordflow">if</span> (&amp;other == <span class="keyword">this</span>) <span class="keywordflow">return</span>;
00097     Clear ();
00098     type = other.<a class="code" href="structcsClipInfo.html#o0">type</a>;
00099     <span class="keywordflow">if</span> (type == CS_CLIPINFO_INSIDE)
00100       inside = other.<a class="code" href="structcsClipInfo.html#o9">inside</a>;
00101     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == CS_CLIPINFO_ORIGINAL)
00102       original.idx = other.<a class="code" href="structcsClipInfo.html#o2">original</a>.idx;
00103     <span class="keywordflow">else</span>
00104       onedge = other.<a class="code" href="structcsClipInfo.html#o6">onedge</a>;
00105     other.<a class="code" href="structcsClipInfo.html#o0">type</a> = CS_CLIPINFO_ORIGINAL;
00106   }
00107 
00108   <span class="keywordtype">void</span> Dump (<span class="keywordtype">int</span> indent)
00109   {
00110     <span class="keywordtype">char</span> ind[255];
00111     <span class="keywordtype">int</span> i;
00112     <span class="keywordflow">for</span> (i = 0 ; i &lt; indent ; i++) ind[i] = <span class="charliteral">' '</span>;
00113     ind[i] = 0;
00114     <span class="keywordflow">switch</span> (type)
00115     {
00116       <span class="keywordflow">case</span> CS_CLIPINFO_ORIGINAL:
00117         printf (<span class="stringliteral">"%s ORIGINAL idx=%d\n"</span>, ind, original.idx);
00118         <span class="keywordflow">break</span>;
00119       <span class="keywordflow">case</span> CS_CLIPINFO_ONEDGE:
00120         printf (<span class="stringliteral">"%s ONEDGE i1=%d i2=%d r=%g\n"</span>, ind, onedge.i1, onedge.i2,
00121           onedge.r);
00122         <span class="keywordflow">break</span>;
00123       <span class="keywordflow">case</span> CS_CLIPINFO_INSIDE:
00124         printf (<span class="stringliteral">"%s INSIDE r=%g\n"</span>, ind, inside.r);
00125         inside.ci1-&gt;Dump (indent+2);
00126         inside.ci2-&gt;Dump (indent+2);
00127         <span class="keywordflow">break</span>;
00128     }
00129     fflush (stdout);
00130   }
00131 };
00132 
<a name="l00143"></a><a class="code" href="classcsFrustum.html">00143</a> <span class="keyword">class </span>CS_CSGEOM_EXPORT csFrustum
00144 {
00145 <span class="keyword">private</span>:
00147   <a class="code" href="classcsVector3.html">csVector3</a> origin;
00148 
00154   <a class="code" href="classcsVector3.html">csVector3</a>* vertices;
00156   <span class="keywordtype">int</span> num_vertices;
00158   <span class="keywordtype">int</span> max_vertices;
00159 
00161   <a class="code" href="classcsPlane3.html">csPlane3</a>* backplane;
00162 
00170   <span class="keywordtype">bool</span> wide;
00171 
00176   <span class="keywordtype">bool</span> mirrored;
00177 
00179   <span class="keywordtype">int</span> ref_count;
00180 
00182   <span class="keywordtype">void</span> Clear ();
00183 
00185   <span class="keywordtype">void</span> ExtendVertexArray (<span class="keywordtype">int</span> num);
00186 
00187 <span class="keyword">public</span>:
00188 
<a name="l00190"></a><a class="code" href="classcsFrustum.html#a0">00190</a>   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o) :
00191     origin (o), vertices (0), num_vertices (0), max_vertices (0),
00192     backplane (0), wide (false), mirrored (false), ref_count (1)
00193   { }
00194 
00200   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o, <a class="code" href="classcsVector3.html">csVector3</a>* verts, <span class="keywordtype">int</span> num_verts,
00201         <a class="code" href="classcsPlane3.html">csPlane3</a>* backp = 0);
00202 
00208   csFrustum (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o, <span class="keywordtype">int</span> num_verts,
00209         <a class="code" href="classcsPlane3.html">csPlane3</a>* backp = 0);
00210 
00212   csFrustum (<span class="keyword">const</span> csFrustum &amp;copy);
00213 
00215   <span class="keyword">virtual</span> ~csFrustum ();
00216 
<a name="l00218"></a><a class="code" href="classcsFrustum.html#a5">00218</a>   <span class="keywordtype">void</span> SetOrigin (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; o) { origin = o; }
00219 
<a name="l00221"></a><a class="code" href="classcsFrustum.html#a6">00221</a>   <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetOrigin () { <span class="keywordflow">return</span> origin; }
00222 
<a name="l00224"></a><a class="code" href="classcsFrustum.html#a7">00224</a>   <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetOrigin ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> origin; }
00225 
<a name="l00231"></a><a class="code" href="classcsFrustum.html#a8">00231</a>   <span class="keywordtype">void</span> SetMirrored (<span class="keywordtype">bool</span> m) { mirrored = m; }
00232 
<a name="l00234"></a><a class="code" href="classcsFrustum.html#a9">00234</a>   <span class="keywordtype">bool</span> IsMirrored () { <span class="keywordflow">return</span> mirrored; }
00235 
00242   <span class="keywordtype">void</span> SetBackPlane (<a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane);
00243 
<a name="l00247"></a><a class="code" href="classcsFrustum.html#a11">00247</a>   <a class="code" href="classcsPlane3.html">csPlane3</a>* GetBackPlane () { <span class="keywordflow">return</span> backplane; }
00248 
00252   <span class="keywordtype">void</span> RemoveBackPlane ();
00253 
00257   <span class="keywordtype">void</span> AddVertex (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v);
00258 
<a name="l00262"></a><a class="code" href="classcsFrustum.html#a14">00262</a>   <span class="keywordtype">int</span> GetVertexCount () { <span class="keywordflow">return</span> num_vertices; }
00263 
<a name="l00267"></a><a class="code" href="classcsFrustum.html#a15">00267</a>   <a class="code" href="classcsVector3.html">csVector3</a>&amp; GetVertex (<span class="keywordtype">int</span> idx)
00268   {
00269     CS_ASSERT (idx &gt;= 0 &amp;&amp; idx &lt; num_vertices);
00270     <span class="keywordflow">return</span> vertices[idx];
00271   }
00272 
<a name="l00276"></a><a class="code" href="classcsFrustum.html#a16">00276</a>   <a class="code" href="classcsVector3.html">csVector3</a>* GetVertices () { <span class="keywordflow">return</span> vertices; }
00277 
00281   <span class="keywordtype">void</span> Transform (<a class="code" href="classcsTransform.html">csTransform</a>* trans);
00282 
00288   <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2);
00289 
00298   <span class="keyword">static</span> <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>* vertices, <span class="keywordtype">int</span>&amp; num_vertices,
00299     csClipInfo* clipinfo, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2);
00300 
00309   <span class="keyword">static</span> <span class="keywordtype">void</span> ClipToPlane (<a class="code" href="classcsVector3.html">csVector3</a>* vertices, <span class="keywordtype">int</span>&amp; num_vertices,
00310     csClipInfo* clipinfo, <span class="keyword">const</span> <a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane);
00311 
00318   <span class="keywordtype">void</span> ClipPolyToPlane (<a class="code" href="classcsPlane3.html">csPlane3</a>* plane);
00319 
00328   <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (<span class="keyword">const</span> csFrustum&amp; other);
00329 
00344   <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (<a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num);
00345 
00360   <span class="keyword">static</span> <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (
00361     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; frust_origin, <a class="code" href="classcsVector3.html">csVector3</a>* frust, <span class="keywordtype">int</span> num_frust,
00362     <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num);
00363 
00378   <span class="keyword">static</span> <a class="code" href="classcsPtr.html">csPtr&lt;csFrustum&gt;</a> Intersect (
00379     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; frust_origin, <a class="code" href="classcsVector3.html">csVector3</a>* frust, <span class="keywordtype">int</span> num_frust,
00380     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v1, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v2, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; v3);
00381 
00387   <span class="keyword">static</span> <span class="keywordtype">int</span> Classify (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00388     <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num_poly);
00389 
00396   <span class="keyword">static</span> <span class="keywordtype">int</span> BatchClassify (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <a class="code" href="classcsVector3.html">csVector3</a>* frustumNormals,
00397         <span class="keywordtype">int</span> num_frust, <a class="code" href="classcsVector3.html">csVector3</a>* poly, <span class="keywordtype">int</span> num_poly);
00398 
00403   <span class="keywordtype">bool</span> Contains (<span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00404 
00411   <span class="keyword">static</span> <span class="keywordtype">bool</span> Contains (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00412     <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00413 
00419   <span class="keyword">static</span> <span class="keywordtype">bool</span> Contains (<a class="code" href="classcsVector3.html">csVector3</a>* frustum, <span class="keywordtype">int</span> num_frust,
00420     <span class="keyword">const</span> <a class="code" href="classcsPlane3.html">csPlane3</a>&amp; plane, <span class="keyword">const</span> <a class="code" href="classcsVector3.html">csVector3</a>&amp; point);
00421 
<a name="l00423"></a><a class="code" href="classcsFrustum.html#a23">00423</a>   <span class="keywordtype">bool</span> IsEmpty ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !wide &amp;&amp; vertices == 0; }
00424 
<a name="l00426"></a><a class="code" href="classcsFrustum.html#a24">00426</a>   <span class="keywordtype">bool</span> IsInfinite ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> wide &amp;&amp; vertices == 0 &amp;&amp; backplane == 0; }
00427 
<a name="l00432"></a><a class="code" href="classcsFrustum.html#a25">00432</a>   <span class="keywordtype">bool</span> IsWide ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> wide &amp;&amp; vertices == 0; }
00433 
00438   <span class="keywordtype">void</span> MakeInfinite ();
00439 
00443   <span class="keywordtype">void</span> MakeEmpty ();
00444 
<a name="l00446"></a><a class="code" href="classcsFrustum.html#a28">00446</a>   <span class="keywordtype">void</span> IncRef () { ref_count++; }
<a name="l00448"></a><a class="code" href="classcsFrustum.html#a29">00448</a>   <span class="keywordtype">void</span> DecRef () { <span class="keywordflow">if</span> (ref_count == 1) <span class="keyword">delete</span> <span class="keyword">this</span>; <span class="keywordflow">else</span> ref_count--; }
<a name="l00450"></a><a class="code" href="classcsFrustum.html#a30">00450</a>   <span class="keywordtype">int</span> GetRefCount () { <span class="keywordflow">return</span> ref_count; }
00451 };
00452 
00455 <span class="preprocessor">#endif // __CS_FRUSTRUM_H__</span>
</pre></div><hr><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.3 
</small></address> </div></body> </html>
