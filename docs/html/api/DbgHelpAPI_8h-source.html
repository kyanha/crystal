<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csutil/win32/DbgHelpAPI.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://crystal.sourceforge.net/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>csutil/win32/DbgHelpAPI.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">  DbgHelp API stuff.</span>
00003 <span class="comment">  Unfortunately, dbghelp.h isn't included in MinGW. So all that's needed goes here.</span>
00004 <span class="comment"> */</span>
00005 
00006 <span class="keyword">enum</span> ADDRESS_MODE
00007 {
00008   AddrMode1616,
00009   AddrMode1632,
00010   AddrModeReal,
00011   AddrModeFlat
00012 };
00013 
00014 <span class="keyword">struct </span>ADDRESS64 
00015 {
00016   uint64 Offset;
00017   WORD Segment;
00018   ADDRESS_MODE Mode;
00019 };
00020 <span class="keyword">typedef</span> ADDRESS64* LPADDRESS64;
00021 
00022 <span class="keyword">struct </span>KDHELP64 
00023 {  
00024   uint64 Thread;  
00025   DWORD ThCallbackStack;  
00026   DWORD ThCallbackBStore;  
00027   DWORD NextCallback;  
00028   DWORD FramePointer;  
00029   uint64 KiCallUserMode;  
00030   uint64 KeUserCallbackDispatcher;  
00031   uint64 SystemRangeStart;  
00032   uint64 Reserved[8];
00033 };
00034 <span class="keyword">typedef</span> KDHELP64* PKDHELP64;
00035 
00036 <span class="keyword">struct </span>STACKFRAME64 
00037 {  
00038   ADDRESS64 AddrPC;  
00039   ADDRESS64 AddrReturn;  
00040   ADDRESS64 AddrFrame;  
00041   ADDRESS64 AddrStack;  
00042   ADDRESS64 AddrBStore;  
00043   PVOID FuncTableEntry;  
00044   uint64 Params[4];  
00045   BOOL Far;  
00046   BOOL Virtual;  
00047   uint64 Reserved[3];  
00048   KDHELP64 KdHelp;
00049 };
00050 <span class="keyword">typedef</span> STACKFRAME64* LPSTACKFRAME64;
00051 
00052 <span class="keyword">typedef</span> BOOL (WINAPI* PREAD_PROCESS_MEMORY_ROUTINE64) (HANDLE hProcess,
00053   uint64 qwBaseAddress, PVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesRead);
00054 <span class="keyword">typedef</span> PVOID (WINAPI* PFUNCTION_TABLE_ACCESS_ROUTINE64) (HANDLE hProcess,
00055   uint64 AddrBase);
00056 <span class="keyword">typedef</span> uint64 (WINAPI* PGET_MODULE_BASE_ROUTINE64) (HANDLE  hProcess, 
00057   uint64 Address);
00058 <span class="keyword">typedef</span> uint64 (WINAPI* PTRANSLATE_ADDRESS_ROUTINE64) (HANDLE hProcess,
00059   HANDLE hThread, LPADDRESS64 lpaddr);
00060 
00061 <span class="keyword">struct </span>SYMBOL_INFO 
00062 {  
00063   ULONG SizeOfStruct;  
00064   ULONG TypeIndex;  
00065   uint64 Reserved[2];  
00066   ULONG Reserved2;  
00067   ULONG Size;  
00068   uint64 ModBase;  
00069   ULONG Flags;  
00070   uint64 Value;  
00071   uint64 Address;  
00072   ULONG Register;  
00073   ULONG Scope;  
00074   ULONG Tag;  
00075   ULONG NameLen;  
00076   ULONG MaxNameLen;  
00077   CHAR Name[1];
00078 };
00079 <span class="keyword">typedef</span> SYMBOL_INFO* PSYMBOL_INFO;
00080 
00081 <span class="preprocessor">#define SYMFLAG_PARAMETER        0x00000040</span>
00082 <span class="preprocessor"></span>
00083 <span class="preprocessor">#define SYMOPT_UNDNAME                  0x00000002</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define SYMOPT_DEFERRED_LOADS           0x00000004</span>
00085 <span class="preprocessor"></span><span class="preprocessor">#define SYMOPT_LOAD_LINES               0x00000010</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define SYMOPT_FAIL_CRITICAL_ERRORS     0x00000200</span>
00087 <span class="preprocessor"></span>
00088 <span class="keyword">enum</span> SYM_TYPE
00089 {
00090     SymNone = 0,
00091     SymCoff,
00092     SymCv,
00093     SymPdb,
00094     SymExport,
00095     SymDeferred,
00096     SymSym,
00097     SymDia,
00098     SymVirtual,
00099     NumSymTypes
00100 };
00101 
00102 <span class="keyword">struct </span>IMAGEHLP_MODULE64 
00103 {  
00104   DWORD SizeOfStruct;  
00105   uint64 BaseOfImage;  
00106   DWORD ImageSize;  
00107   DWORD TimeDateStamp;  
00108   DWORD CheckSum;  
00109   DWORD NumSyms;  
00110   SYM_TYPE SymType;  
00111   CHAR ModuleName[32];  
00112   CHAR ImageName[256];  
00113   CHAR LoadedImageName[256];  
00114   <span class="comment">/*</span>
00115 <span class="comment">    The following fields are only supported on newer versions of dbghelp.dll,</span>
00116 <span class="comment">    but the versions shipped with W2k resp. WXP lack them.</span>
00117 <span class="comment">   */</span>
00118   <span class="comment">/*CHAR LoadedPdbName[256];  </span>
00119 <span class="comment">  DWORD CVSig;  </span>
00120 <span class="comment">  CHAR CVData[MAX_PATH*3];  </span>
00121 <span class="comment">  DWORD PdbSig;  </span>
00122 <span class="comment">  GUID PdbSig70;  </span>
00123 <span class="comment">  DWORD PdbAge;  </span>
00124 <span class="comment">  BOOL PdbUnmatched;  </span>
00125 <span class="comment">  BOOL DbgUnmatched;  </span>
00126 <span class="comment">  BOOL LineNumbers;  </span>
00127 <span class="comment">  BOOL GlobalSymbols;  </span>
00128 <span class="comment">  BOOL TypeInfo;*/</span>
00129 };
00130 <span class="keyword">typedef</span> IMAGEHLP_MODULE64* PIMAGEHLP_MODULE64;
00131 
00132 <span class="keyword">struct </span>IMAGEHLP_LINE64
00133 {  
00134   DWORD SizeOfStruct;  
00135   PVOID Key;  
00136   DWORD LineNumber;  
00137   PCHAR FileName;  
00138   uint64 Address;
00139 };
00140 <span class="keyword">typedef</span> IMAGEHLP_LINE64* PIMAGEHLP_LINE64;
00141 
00142 <span class="keyword">typedef</span> BOOL (CALLBACK* PSYM_ENUMERATESYMBOLS_CALLBACK) (PSYMBOL_INFO pSymInfo,
00143   ULONG SymbolSize, PVOID UserContext);
00144 <span class="keyword">typedef</span> BOOL (CALLBACK* PSYM_ENUMMODULES_CALLBACK64) (PSTR ModuleName,
00145   uint64 BaseOfDll, PVOID UserContext);
00146 
00147 <span class="keyword">struct </span>IMAGEHLP_STACK_FRAME 
00148 {  
00149   uint64 InstructionOffset;  
00150   uint64 ReturnOffset;  
00151   uint64 FrameOffset;  
00152   uint64 StackOffset;  
00153   uint64 BackingStoreOffset;  
00154   uint64 FuncTableEntry;  
00155   uint64 Params[4];  
00156   uint64 Reserved[5];  
00157   BOOL Virtual;  
00158   ULONG Reserved2;
00159 };
00160 <span class="keyword">typedef</span> IMAGEHLP_STACK_FRAME* PIMAGEHLP_STACK_FRAME;
00161 <span class="keyword">typedef</span> <span class="keywordtype">void</span>* PIMAGEHLP_CONTEXT;
00162 
00163 <span class="keyword">struct </span>MINIDUMP_EXCEPTION_INFORMATION 
00164 {  
00165   DWORD ThreadId;  
00166   PEXCEPTION_POINTERS ExceptionPointers;  
00167   BOOL ClientPointers;
00168 };
00169 <span class="keyword">typedef</span> MINIDUMP_EXCEPTION_INFORMATION* PMINIDUMP_EXCEPTION_INFORMATION;
00170 
00171 <span class="keyword">struct </span>MINIDUMP_USER_STREAM 
00172 {  
00173   ULONG32 Type;  
00174   ULONG BufferSize;  
00175   PVOID Buffer;
00176 };
00177 <span class="keyword">typedef</span> MINIDUMP_USER_STREAM* PMINIDUMP_USER_STREAM;
00178                                                     
00179 <span class="keyword">struct </span>MINIDUMP_USER_STREAM_INFORMATION 
00180 {  
00181   ULONG UserStreamCount;  
00182   PMINIDUMP_USER_STREAM UserStreamArray;
00183 };
00184 <span class="keyword">typedef</span> MINIDUMP_USER_STREAM_INFORMATION* PMINIDUMP_USER_STREAM_INFORMATION;
00185 
00186 <span class="keyword">enum</span> MINIDUMP_CALLBACK_TYPE
00187 {
00188   ModuleCallback, 
00189   ThreadCallback, 
00190   ThreadExCallback, 
00191   IncludeThreadCallback, 
00192   IncludeModuleCallback
00193 };
00194 
00195 <span class="keyword">struct </span>MINIDUMP_THREAD_CALLBACK 
00196 {  
00197   ULONG ThreadId;  
00198   HANDLE ThreadHandle;  
00199   CONTEXT Context;  
00200   ULONG SizeOfContext;  
00201   ULONG64 StackBase;  
00202   ULONG64 StackEnd;
00203 };
00204 <span class="keyword">typedef</span> MINIDUMP_THREAD_CALLBACK* PMINIDUMP_THREAD_CALLBACK;
00205 
00206 <span class="keyword">struct </span>MINIDUMP_THREAD_EX_CALLBACK 
00207 {  
00208   ULONG ThreadId;  
00209   HANDLE ThreadHandle;  
00210   CONTEXT Context;  
00211   ULONG SizeOfContext;  
00212   ULONG64 StackBase;  
00213   ULONG64 StackEnd;  
00214   ULONG64 BackingStoreBase;  
00215   ULONG64 BackingStoreEnd;
00216 };
00217 <span class="keyword">typedef</span> MINIDUMP_THREAD_EX_CALLBACK* PMINIDUMP_THREAD_EX_CALLBACK;
00218 
00219 <span class="preprocessor">#include &lt;winver.h&gt;</span>
00220 
00221 <span class="keyword">struct </span>MINIDUMP_MODULE_CALLBACK 
00222 {  
00223   PWCHAR FullPath;  
00224   ULONG64 BaseOfImage;  
00225   ULONG SizeOfImage;  
00226   ULONG CheckSum;  
00227   ULONG TimeDateStamp;  
00228   VS_FIXEDFILEINFO VersionInfo;  
00229   PVOID CvRecord;  
00230   ULONG SizeOfCvRecord;  
00231   PVOID MiscRecord;  
00232   ULONG SizeOfMiscRecord;
00233 };
00234 <span class="keyword">typedef</span> MINIDUMP_MODULE_CALLBACK* PMINIDUMP_MODULE_CALLBACK;
00235 
00236 <span class="keyword">struct </span>MINIDUMP_INCLUDE_THREAD_CALLBACK 
00237 {  
00238   ULONG ThreadId;
00239 };
00240 <span class="keyword">typedef</span> MINIDUMP_INCLUDE_THREAD_CALLBACK* PMINIDUMP_INCLUDE_THREAD_CALLBACK;
00241 
00242 <span class="keyword">struct </span>MINIDUMP_INCLUDE_MODULE_CALLBACK 
00243 {  
00244   ULONG64 BaseOfImage;
00245 };
00246 <span class="keyword">typedef</span> MINIDUMP_INCLUDE_MODULE_CALLBACK* PMINIDUMP_INCLUDE_MODULE_CALLBACK;
00247 
00248 
00249 <span class="keyword">struct </span>MINIDUMP_CALLBACK_INPUT       
00250 {  
00251   ULONG ProcessId;  
00252   HANDLE ProcessHandle;  
00253   ULONG CallbackType;  
00254   <span class="keyword">union </span>
00255 <span class="keyword">  </span>{    
00256     MINIDUMP_THREAD_CALLBACK Thread;    
00257     MINIDUMP_THREAD_EX_CALLBACK ThreadEx;    
00258     MINIDUMP_MODULE_CALLBACK Module;    
00259     MINIDUMP_INCLUDE_THREAD_CALLBACK IncludeThread;    
00260     MINIDUMP_INCLUDE_MODULE_CALLBACK IncludeModule;  
00261   };
00262 };
00263 <span class="keyword">typedef</span> MINIDUMP_CALLBACK_INPUT* PMINIDUMP_CALLBACK_INPUT;
00264 
00265 <span class="keyword">enum</span> MODULE_WRITE_FLAGS
00266 {
00267   ModuleWriteModule                     = 0x0001, 
00268   ModuleWriteDataSeg                    = 0x0002, 
00269   ModuleWriteMiscRecord                 = 0x0004, 
00270   ModuleWriteCvRecord                   = 0x0008, 
00271   ModuleReferencedByMemory              = 0x0010
00272 };
00273 
00274 <span class="keyword">enum</span> THREAD_WRITE_FLAGS
00275 {
00276   ThreadWriteThread                     = 0x0001, 
00277   ThreadWriteStack                      = 0x0002, 
00278   ThreadWriteContext                    = 0x0004, 
00279   ThreadWriteBackingStore               = 0x0008, 
00280   ThreadWriteInstructionWindow          = 0x0010, 
00281   ThreadWriteThreadData                 = 0x0020
00282 };
00283 
00284 <span class="keyword">struct </span>MINIDUMP_CALLBACK_OUTPUT 
00285 {  
00286   <span class="keyword">union </span>
00287 <span class="keyword">  </span>{    
00288     ULONG ModuleWriteFlags;    
00289     ULONG ThreadWriteFlags;  
00290   };
00291 }; 
00292 <span class="keyword">typedef</span> MINIDUMP_CALLBACK_OUTPUT* PMINIDUMP_CALLBACK_OUTPUT;
00293 
00294 
00295 <span class="keyword">typedef</span> BOOL (CALLBACK* MINIDUMP_CALLBACK_ROUTINE) (PVOID CallbackParam, 
00296   <span class="keyword">const</span> PMINIDUMP_CALLBACK_INPUT CallbackInput, 
00297   PMINIDUMP_CALLBACK_OUTPUT CallbackOutput);
00298 
00299 <span class="keyword">struct </span>MINIDUMP_CALLBACK_INFORMATION 
00300 {  
00301   MINIDUMP_CALLBACK_ROUTINE CallbackRoutine;  
00302   PVOID CallbackParam;
00303 };
00304 <span class="keyword">typedef</span> MINIDUMP_CALLBACK_INFORMATION* PMINIDUMP_CALLBACK_INFORMATION;
00305 
00306 <span class="keyword">enum</span> MINIDUMP_TYPE
00307 {
00308   MiniDumpNormal                          = 0x0000, 
00309   MiniDumpWithDataSegs                    = 0x0001, 
00310   MiniDumpWithFullMemory                  = 0x0002, 
00311   MiniDumpWithHandleData                  = 0x0004, 
00312   MiniDumpFilterMemory                    = 0x0008, 
00313   MiniDumpScanMemory                      = 0x0010, 
00314   MiniDumpWithUnloadedModules             = 0x0020, 
00315   MiniDumpWithIndirectlyReferencedMemory  = 0x0040, 
00316   MiniDumpFilterModulePaths               = 0x0080, 
00317   MiniDumpWithProcessThreadData           = 0x0100, 
00318   MiniDumpWithPrivateReadWriteMemory      = 0x0200
00319 };
00320 
00321 <span class="keyword">enum</span> MINIDUMP_STREAM_TYPE
00322 {
00323   UnusedStream             = 0, 
00324   ReservedStream0          = 1, 
00325   ReservedStream1          = 2, 
00326   ThreadListStream         = 3, 
00327   ModuleListStream         = 4, 
00328   MemoryListStream         = 5, 
00329   ExceptionStream          = 6, 
00330   SystemInfoStream         = 7, 
00331   ThreadExListStream       = 8, 
00332   Memory64ListStream       = 9, 
00333   CommentStreamA           = 10, 
00334   CommentStreamW           = 11, 
00335   HandleDataStream         = 12, 
00336   FunctionTableStream      = 13, 
00337   UnloadedModuleListStream = 14, 
00338   MiscInfoStream           = 15, 
00339   LastReservedStream = 0xffff
00340 };
00341 
00342 <span class="keyword">struct </span>MINIDUMP_LOCATION_DESCRIPTOR 
00343 {  
00344   uint32 DataSize;  
00345   uint32 Rva;
00346 };
00347 
00348 <span class="keyword">struct </span>MINIDUMP_MEMORY_DESCRIPTOR 
00349 {  
00350   uint64 StartOfMemoryRange;  
00351   MINIDUMP_LOCATION_DESCRIPTOR Memory;
00352 };
00353 <span class="keyword">typedef</span> MINIDUMP_MEMORY_DESCRIPTOR* PMINIDUMP_MEMORY_DESCRIPTOR;
00354 
00355 <span class="keyword">struct </span>MINIDUMP_MEMORY_LIST 
00356 {  
00357   ULONG32 NumberOfMemoryRanges;  
00358   <span class="comment">/*MINIDUMP_MEMORY_DESCRIPTOR MemoryRanges[];*/</span>
00359 };
00360 <span class="keyword">typedef</span> MINIDUMP_MEMORY_LIST* PMINIDUMP_MEMORY_LIST;
00361 
00362 <span class="keyword">struct </span>MINIDUMP_HEADER 
00363 {
00364   ULONG32 Signature;
00365   ULONG32 Version;
00366   ULONG32 NumberOfStreams;
00367   uint32 StreamDirectoryRva;
00368   ULONG32 CheckSum;
00369   <span class="keyword">union </span>
00370 <span class="keyword">  </span>{
00371     ULONG32 Reserved;
00372     ULONG32 TimeDateStamp;
00373   };
00374   uint64 Flags;
00375 };
00376 <span class="keyword">typedef</span> MINIDUMP_HEADER* PMINIDUMP_HEADER;
00377 
00378 <span class="keyword">struct </span>MINIDUMP_DIRECTORY 
00379 {
00380   ULONG32 StreamType;
00381   MINIDUMP_LOCATION_DESCRIPTOR Location;
00382 };
00383 <span class="keyword">typedef</span> MINIDUMP_DIRECTORY* PMINIDUMP_DIRECTORY;
00384 
00385 <span class="preprocessor">#define CS_API_NAME             DbgHelp</span>
00386 <span class="preprocessor"></span><span class="preprocessor">#define CS_API_FUNCTIONS        "csutil/win32/DbgHelpAPI.fun"</span>
00387 <span class="preprocessor"></span>
00388 <span class="preprocessor">#include "APIdeclare.inc"</span>
</pre></div><hr><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.2.18 
</small></address> </div></body> </html>
