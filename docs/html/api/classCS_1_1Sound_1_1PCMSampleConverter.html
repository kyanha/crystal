<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: CS::Sound::PCMSampleConverter Class Reference (Crystal Space Public API Reference)</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr height="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr height="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespaceCS.html">CS</a>::<a class="el" href="namespaceCS_1_1Sound.html">Sound</a>::<a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html">PCMSampleConverter</a></div>
<h1>CS::Sound::PCMSampleConverter Class Reference</h1><!-- doxytag: class="CS::Sound::PCMSampleConverter" -->A <a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html">PCMSampleConverter</a> object converts PCM data from one format to another.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="convert_8h-source.html">csplugincommon/sndsys/convert.h</a>&gt;</code>
<p>
<a href="classCS_1_1Sound_1_1PCMSampleConverter-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#56b8f424bd8d8a4b8350bab395f5d014">ConvertBuffer</a> (const void *source, size_t source_len, void *dest, int dest_channels, int dest_bitspersample, int dest_frequency)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a buffer of PCM data from the currently set source format to the desired dest format.  <a href="#56b8f424bd8d8a4b8350bab395f5d014"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#284304f4151dc0c105f49a12a602c465">GetRequiredOutputBufferMultiple</a> (int dest_channels, int dest_bitspersample, int dest_frequency)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a multiplier that relates input buffer samples/size to output buffer samples/size.  <a href="#284304f4151dc0c105f49a12a602c465"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#922663dc8a4e6f6d13bf2ea12ba736a8">PCMSampleConverter</a> (int source_channels, int source_bitspersample, int source_frequency, bool swap16=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html">PCMSampleConverter</a> with initial source properties provided.  <a href="#922663dc8a4e6f6d13bf2ea12ba736a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#7f5b84b8117a1c3130804d603286f24c">SetSourceProperties</a> (int source_channels, int source_bitspersample, int source_frequency)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adjust the source properties for data being presented in the next call to ConvertBuffer.  <a href="#7f5b84b8117a1c3130804d603286f24c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0948d923408688c7b4182d0a81c73041"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::last_sample" ref="0948d923408688c7b4182d0a81c73041" args="[CS_SOUND_ELEMENT_MAX_CHANNELS]" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#0948d923408688c7b4182d0a81c73041">last_sample</a> [CS_SOUND_ELEMENT_MAX_CHANNELS]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1af63e1e02a0848ab3fe466f20c910ec"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::position_offset" ref="1af63e1e02a0848ab3fe466f20c910ec" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#1af63e1e02a0848ab3fe466f20c910ec">position_offset</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="72f4939394ae87066e26f7f4fc8ff08f"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::src_bytes" ref="72f4939394ae87066e26f7f4fc8ff08f" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#72f4939394ae87066e26f7f4fc8ff08f">src_bytes</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="85a8876b86a26f2b108f9a71468d44e2"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::src_channels" ref="85a8876b86a26f2b108f9a71468d44e2" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#85a8876b86a26f2b108f9a71468d44e2">src_channels</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="56e9a2da8b76b3a6883c8bc0845cbf9e"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::src_frequency" ref="56e9a2da8b76b3a6883c8bc0845cbf9e" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#56e9a2da8b76b3a6883c8bc0845cbf9e">src_frequency</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e15ea86ada8a778f8d9a89c47c81e2b8"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::swap_16" ref="e15ea86ada8a778f8d9a89c47c81e2b8" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html#e15ea86ada8a778f8d9a89c47c81e2b8">swap_16</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A <a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html">PCMSampleConverter</a> object converts PCM data from one format to another. 
<p>
The converter can convert between different number of channels, bits per sample and sampling frequency.<p>
UNCOMPRESSED PCM SAMPLES ONLY!<p>
8 and 16 bit samples are supported.<p>
When converting between streams with different numbers of channels, mono source streams will have audio data copied to the second channel. If the destination is a stereo (2 channel) output, this will duplicate the mono/left stream onto the right stream. Additional channels will be left in silence. Converting a mono sample to a 5.1 sample will result in identical samples in streams 0 and 1 and silence in all other streams.<p>
Frequency conversion is performed using linear interpolation between adjacent samples. If a direct-ratio conversion is performed (for example, if a 44100 khz stream is converted into a 11025 stream) then only direct data points will be considered and the rest will be thrown out.<p>
Frequency conversion can be used to alter the playback speed of stream. If the output format should be 22050 khz and you specify 11025 khz, the sound will play twice as fast (no, this isn't a typo - the slower output data is read at a faster rate, causing the data to be traversed faster). Internally, speed can be stepped in 1/CS_SOUND INTERNAL_FREQUENCY_DIVISOR increments from the source frequency. This means if you specify more accurate than this increment, truncation to the next lowest value will occur. If you have a source at 44100 khz and specify an output at 44101 khz, the rate will most likely be reduced to 44100 khz - so no frequency conversion will take place.<p>
Beware of very high frequency conversion rates! If your source audio is of poor sampling rate (11025 khz), increasing the speed of playback will make it sound worse! At some point it will degenerate into indistinguishable noise. If you intend to speed up playback it's best to start with a higher sampling rate (44100 khz). 
<p>

<p>
Definition at line <a class="el" href="convert_8h-source.html#l00101">101</a> of file <a class="el" href="convert_8h-source.html">convert.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="922663dc8a4e6f6d13bf2ea12ba736a8"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::PCMSampleConverter" ref="922663dc8a4e6f6d13bf2ea12ba736a8" args="(int source_channels, int source_bitspersample, int source_frequency, bool swap16=false)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">CS::Sound::PCMSampleConverter::PCMSampleConverter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_channels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_bitspersample</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_frequency</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>swap16</em> = <code>false</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a <a class="el" href="classCS_1_1Sound_1_1PCMSampleConverter.html">PCMSampleConverter</a> with initial source properties provided. 
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="56b8f424bd8d8a4b8350bab395f5d014"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::ConvertBuffer" ref="56b8f424bd8d8a4b8350bab395f5d014" args="(const void *source, size_t source_len, void *dest, int dest_channels, int dest_bitspersample, int dest_frequency)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CS::Sound::PCMSampleConverter::ConvertBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>source_len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_channels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_bitspersample</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_frequency</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert a buffer of PCM data from the currently set source format to the desired dest format. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source_len</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_channels</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_bitspersample</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_frequency</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="284304f4151dc0c105f49a12a602c465"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::GetRequiredOutputBufferMultiple" ref="284304f4151dc0c105f49a12a602c465" args="(int dest_channels, int dest_bitspersample, int dest_frequency)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int CS::Sound::PCMSampleConverter::GetRequiredOutputBufferMultiple           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_channels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_bitspersample</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_frequency</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return a multiplier that relates input buffer samples/size to output buffer samples/size. 
<p>
Note that in many cases one extra source sample should be presumed to be present. To be safe, use ((source_samples+1)*source_sample_size*GetRequiredOutputBufferMultiple()) for the size. The value returned will be constant for a given source format and destination format.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest_channels</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_bitspersample</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest_frequency</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="7f5b84b8117a1c3130804d603286f24c"></a><!-- doxytag: member="CS::Sound::PCMSampleConverter::SetSourceProperties" ref="7f5b84b8117a1c3130804d603286f24c" args="(int source_channels, int source_bitspersample, int source_frequency)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CS::Sound::PCMSampleConverter::SetSourceProperties           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_channels</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_bitspersample</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>source_frequency</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adjust the source properties for data being presented in the next call to ConvertBuffer. 
<p>
This is primarily intended for variable-rate audio formats such as some Ogg and MP3 files. <dl compact><dt><b>Remarks:</b></dt><dd>At this time this function does not properly consider the transition between formats at the proper location and instead presumes the transition is at the last "step" from the previous buffer.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source_channels</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source_bitspersample</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source_frequency</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li>csplugincommon/sndsys/<a class="el" href="convert_8h-source.html">convert.h</a></ul>
<hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.4.6 
</small></address> </div></body> </html>
