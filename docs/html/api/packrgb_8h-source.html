<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csgfx/packrgb.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>csgfx/packrgb.h</h1><a href="packrgb_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">    Copyright (C) 1998-2003 by Jorrit Tyberghein</span>
00003 <span class="comment">                       2003 by Frank Richter</span>
00004 <span class="comment"></span>
00005 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00006 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
00007 <span class="comment">    License as published by the Free Software Foundation; either</span>
00008 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00009 <span class="comment"></span>
00010 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00013 <span class="comment">    Library General Public License for more details.</span>
00014 <span class="comment"></span>
00015 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
00016 <span class="comment">    License along with this library; if not, write to the Free</span>
00017 <span class="comment">    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00018 <span class="comment">*/</span>
00019 
00025 <span class="preprocessor">#ifndef __CSGFX_PACKRGB_H__</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define __CSGFX_PACKRGB_H__</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include "csextern.h"</span>
00029 
00030 <span class="preprocessor">#include "<a class="code" href="cstypes_8h.html">cstypes.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="databuff_8h.html">iutil/databuff.h</a>"</span>
00032 <span class="preprocessor">#include "csutil/databuf.h"</span>
00033 <span class="preprocessor">#include "<a class="code" href="rgbpixel_8h.html">rgbpixel.h</a>"</span>
00034 
<a name="l00056"></a><a class="code" href="structcsPackRGB.html">00056</a> <span class="keyword">struct </span><a class="code" href="structcsPackRGB.html">csPackRGB</a>
00057 {
00058   <span class="keyword">static</span> <span class="keywordtype">bool</span> IsRGBcolorSane() { <span class="keywordflow">return</span> (<span class="keyword">sizeof</span>(<a class="code" href="structcsRGBcolor.html">csRGBcolor</a>) == 3); }
<a name="l00065"></a><a class="code" href="structcsPackRGB.html#e1">00065</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGB.html#e1">PackRGBcolorToRGBBuffer</a> (uint8* buf, 
00066     <span class="keyword">const</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* pixels, size_t numPixels)
00067   {
00068     <span class="keywordflow">if</span> (IsRGBcolorSane())
00069       memcpy (buf, pixels, numPixels * 3);
00070     <span class="keywordflow">else</span>
00071     {
00072       uint8* bufptr = buf;
00073       <span class="keywordflow">while</span> (numPixels--)
00074       {
00075         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBcolor.html#o0">red</a>;
00076         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBcolor.html#o1">green</a>;
00077         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBcolor.html#o2">blue</a>;
00078         pixels++; 
00079       }
00080     }
00081   }
<a name="l00091"></a><a class="code" href="structcsPackRGB.html#e2">00091</a>   <span class="keyword">static</span> <span class="keyword">const</span> uint8* <a class="code" href="structcsPackRGB.html#e2">PackRGBcolorToRGB</a> (<span class="keyword">const</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* pixels, 
00092     size_t numPixels)
00093   {
00094     <span class="keywordflow">if</span> (IsRGBcolorSane())
00095       <span class="keywordflow">return</span> (uint8*)pixels;
00096     <span class="keywordflow">else</span>
00097     {
00098       uint8* buf = <span class="keyword">new</span> uint8[numPixels * 3];
00099       <a class="code" href="structcsPackRGB.html#e1">PackRGBcolorToRGBBuffer</a> (buf, pixels, numPixels);
00100       <span class="keywordflow">return</span> buf;
00101     }
00102   }
<a name="l00107"></a><a class="code" href="structcsPackRGB.html#e3">00107</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGB.html#e3">DiscardPackedRGB</a> (<span class="keyword">const</span> uint8* rgb) 
00108   {
00109     <span class="keywordflow">if</span> (!IsRGBcolorSane())
00110       <span class="keyword">delete</span>[] (uint8*)rgb;
00111   }
<a name="l00118"></a><a class="code" href="structcsPackRGB.html#e4">00118</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGB.html#e4">UnpackRGBtoRGBcolor</a> (<a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* buf, <span class="keyword">const</span> uint8* rgb, 
00119     size_t numPixels)
00120   {
00121     <span class="keywordflow">if</span> (IsRGBcolorSane())
00122       memcpy (buf, rgb, numPixels * 3);
00123     <span class="keywordflow">else</span>
00124     {
00125       <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* bufptr = buf;
00126       <span class="keywordflow">while</span> (numPixels--)
00127       {
00128         bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o0">red</a> = *rgb++;
00129         bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o1">green</a> = *rgb++;
00130         bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o2">blue</a> = *rgb++;
00131         bufptr++; 
00132       }
00133     }
00134   }
<a name="l00144"></a><a class="code" href="structcsPackRGB.html#e5">00144</a>   <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* <a class="code" href="structcsPackRGB.html#e4">UnpackRGBtoRGBcolor</a> (<span class="keyword">const</span> uint8* rgb, 
00145     size_t numPixels)
00146   {
00147     <span class="keywordflow">if</span> (IsRGBcolorSane())
00148       <span class="keywordflow">return</span> (<span class="keyword">const</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>*)rgb;
00149     <span class="keywordflow">else</span>
00150     {
00151       <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* buf = <span class="keyword">new</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>[numPixels];
00152       <a class="code" href="structcsPackRGB.html#e4">UnpackRGBtoRGBcolor</a> (buf, rgb, numPixels);
00153       <span class="keywordflow">return</span> buf;
00154     }
00155   }
<a name="l00160"></a><a class="code" href="structcsPackRGB.html#e6">00160</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGB.html#e6">DiscardUnpackedRGBcolor</a> (<span class="keyword">const</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* pixels) 
00161   {
00162     <span class="keywordflow">if</span> (!IsRGBcolorSane())
00163       <span class="keyword">delete</span>[] (<a class="code" href="structcsRGBcolor.html">csRGBcolor</a>*)pixels;
00164   }
<a name="l00174"></a><a class="code" href="structcsPackRGB.html#e7">00174</a>   <span class="keyword">static</span> <span class="keyword">inline</span> uint8* <a class="code" href="structcsPackRGB.html#e7">PackRGBpixelToRGB</a> (<span class="keyword">const</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* pixels, 
00175     size_t numPixels)
00176   {
00177     uint8* buf = <span class="keyword">new</span> uint8[numPixels * 3];
00178     uint8* bufptr = buf;
00179     <span class="keywordflow">while</span> (numPixels--)
00180     {
00181       *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o0">red</a>;
00182       *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o1">green</a>;
00183       *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o2">blue</a>;
00184       pixels++; 
00185     }
00186     <span class="keywordflow">return</span> buf;
00187   }
00188 };
00189 
<a name="l00193"></a><a class="code" href="structcsPackRGBA.html">00193</a> <span class="keyword">struct </span><a class="code" href="structcsPackRGBA.html">csPackRGBA</a>
00194 {
00195   <span class="keyword">static</span> <span class="keywordtype">bool</span> IsRGBpixelSane() { <span class="keywordflow">return</span> (<span class="keyword">sizeof</span>(<a class="code" href="structcsRGBpixel.html">csRGBpixel</a>) == 4); }
<a name="l00202"></a><a class="code" href="structcsPackRGBA.html#e1">00202</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGBA.html#e1">PackRGBpixelToRGBA</a> (uint8* buf, <span class="keyword">const</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* pixels, 
00203     size_t numPixels)
00204   {
00205     <span class="keywordflow">if</span> (IsRGBpixelSane())
00206       memcpy (buf, pixels, numPixels * 4);
00207     <span class="keywordflow">else</span>
00208     {
00209       uint8* bufptr = buf;
00210       <span class="keywordflow">while</span> (numPixels--)
00211       {
00212         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o0">red</a>;
00213         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o1">green</a>;
00214         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o2">blue</a>;
00215         *bufptr++ = pixels-&gt;<a class="code" href="structcsRGBpixel.html#o3">alpha</a>;
00216         pixels++; 
00217       }
00218     }
00219   }
<a name="l00229"></a><a class="code" href="structcsPackRGBA.html#e2">00229</a>   <span class="keyword">static</span> <span class="keyword">const</span> uint8* <a class="code" href="structcsPackRGBA.html#e1">PackRGBpixelToRGBA</a> (<span class="keyword">const</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* pixels, 
00230     size_t numPixels)
00231   {
00232     <span class="keywordflow">if</span> (IsRGBpixelSane())
00233       <span class="keywordflow">return</span> (uint8*)pixels;
00234     <span class="keywordflow">else</span>
00235     {
00236       uint8* buf = <span class="keyword">new</span> uint8[numPixels * 4];
00237       <a class="code" href="structcsPackRGBA.html#e1">PackRGBpixelToRGBA</a> (buf, pixels, numPixels);
00238       <span class="keywordflow">return</span> buf;
00239     }
00240   }
<a name="l00245"></a><a class="code" href="structcsPackRGBA.html#e3">00245</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGBA.html#e3">DiscardPackedRGBA</a> (<span class="keyword">const</span> uint8* rgba) 
00246   {
00247     <span class="keywordflow">if</span> (!IsRGBpixelSane())
00248     {
00249       <span class="keyword">delete</span>[] (uint8*)rgba;
00250     }
00251   }
<a name="l00258"></a><a class="code" href="structcsPackRGBA.html#e4">00258</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGBA.html#e4">UnpackRGBAtoRGBpixel</a> (<a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* buf, <span class="keyword">const</span> uint8* rgba, 
00259     size_t numPixels)
00260   {
00261     <span class="keywordflow">if</span> (IsRGBpixelSane())
00262       memcpy (buf, rgba, numPixels * 4);
00263     <span class="keywordflow">else</span>
00264     {
00265       <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* bufptr = buf;
00266       <span class="keywordflow">while</span> (numPixels--)
00267       {
00268         bufptr-&gt;<a class="code" href="structcsRGBpixel.html#o0">red</a> = *rgba++;
00269         bufptr-&gt;<a class="code" href="structcsRGBpixel.html#o1">green</a> = *rgba++;
00270         bufptr-&gt;<a class="code" href="structcsRGBpixel.html#o2">blue</a> = *rgba++;
00271         bufptr-&gt;<a class="code" href="structcsRGBpixel.html#o3">alpha</a> = *rgba++;
00272         bufptr++; 
00273       }
00274     }
00275   }
<a name="l00285"></a><a class="code" href="structcsPackRGBA.html#e5">00285</a>   <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* <a class="code" href="structcsPackRGBA.html#e4">UnpackRGBAtoRGBpixel</a> (<span class="keyword">const</span> uint8* rgba, 
00286     size_t numPixels)
00287   {
00288     <span class="keywordflow">if</span> (IsRGBpixelSane())
00289       <span class="keywordflow">return</span> (<a class="code" href="structcsRGBpixel.html">csRGBpixel</a>*)rgba;
00290     <span class="keywordflow">else</span>
00291     {
00292       <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* buf = <span class="keyword">new</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>[numPixels];
00293       <a class="code" href="structcsPackRGBA.html#e4">UnpackRGBAtoRGBpixel</a> (buf, rgba, numPixels);
00294       <span class="keywordflow">return</span> buf;
00295     }
00296   }
<a name="l00306"></a><a class="code" href="structcsPackRGBA.html#e6">00306</a>   <span class="keyword">static</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* <a class="code" href="structcsPackRGBA.html#e6">CopyUnpackRGBAtoRGBpixel</a> (<span class="keyword">const</span> uint8* rgba, 
00307     size_t numPixels)
00308   {
00309     <span class="keywordflow">if</span> (IsRGBpixelSane())
00310     {
00311       <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* buf = <span class="keyword">new</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>[numPixels];
00312       memcpy (buf, rgba, numPixels * <span class="keyword">sizeof</span>(csRGBpixel));
00313       <span class="keywordflow">return</span> buf;
00314     }
00315     <span class="keywordflow">else</span>
00316       <span class="keywordflow">return</span> (<a class="code" href="structcsRGBpixel.html">csRGBpixel</a>*)<a class="code" href="structcsPackRGBA.html#e4">UnpackRGBAtoRGBpixel</a> (rgba, numPixels);
00317   }
<a name="l00323"></a><a class="code" href="structcsPackRGBA.html#e7">00323</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structcsPackRGBA.html#e7">csDiscardUnpackedRGBpixel</a> (<span class="keyword">const</span> <a class="code" href="structcsRGBpixel.html">csRGBpixel</a>* pixels) 
00324   {
00325     <span class="keywordflow">if</span> (!IsRGBpixelSane())
00326       <span class="keyword">delete</span>[] (<a class="code" href="structcsRGBpixel.html">csRGBpixel</a>*)pixels;
00327   }
<a name="l00337"></a><a class="code" href="structcsPackRGBA.html#e8">00337</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* <a class="code" href="structcsPackRGBA.html#e8">UnpackRGBAtoRGBcolor</a> (<span class="keyword">const</span> uint8* rgba, 
00338     size_t numPixels)
00339   {
00340     <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>* buf = <span class="keyword">new</span> <a class="code" href="structcsRGBcolor.html">csRGBcolor</a>[numPixels];
00341     csRGBcolor* bufptr = buf;
00342     <span class="keywordflow">while</span> (numPixels--)
00343     {
00344       bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o0">red</a> = *rgba++;
00345       bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o1">green</a> = *rgba++;
00346       bufptr-&gt;<a class="code" href="structcsRGBcolor.html#o2">blue</a> = *rgba++;
00347       rgba++;
00348       bufptr++; 
00349     }
00350     <span class="keywordflow">return</span> buf;
00351   }
00352 };
00353 
00358 <span class="preprocessor">#endif // __CSGFX_PACKRGB_H__</span>
</pre></div><hr><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.3 
</small></address> </div></body> </html>
