<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csutil/scf.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000026.html">csutil</a></div>
<h1>scf.h</h1><a href="scf_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">    Crystal Space Shared Class Facility (SCF)</span>
<a name="l00003"></a>00003 <span class="comment">    Copyright (C) 1999 by Andrew Zabolotny</span>
<a name="l00004"></a>00004 <span class="comment">              (C) 2005 by Marten Svanfeldt</span>
<a name="l00005"></a>00005 <span class="comment">              (C) 2005 by Michael Adams</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">    This library is free software; you can redistribute it and/or</span>
<a name="l00008"></a>00008 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
<a name="l00009"></a>00009 <span class="comment">    License as published by the Free Software Foundation; either</span>
<a name="l00010"></a>00010 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00015"></a>00015 <span class="comment">    Library General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
<a name="l00018"></a>00018 <span class="comment">    License along with this library; if not, write to the Free</span>
<a name="l00019"></a>00019 <span class="comment">    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00020"></a>00020 <span class="comment">*/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef __CSSCF_H__</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define __CSSCF_H__</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "csextern.h"</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include "<a class="code" href="array_8h.html">csutil/array.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="ref_8h.html">csutil/ref.h</a>"</span>
<a name="l00029"></a>00029 
<a name="l00038"></a>00038 <span class="keyword">class </span><a class="code" href="classcsPathsList.html">csPathsList</a>;
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">// INTERFACE DEFINITIONS</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="scf__interface_8h.html">csutil/scf_interface.h</a>"</span>
<a name="l00043"></a>00043 <span class="comment">// NEW STYLE IMPLEMENTATION</span>
<a name="l00044"></a>00044 <span class="comment">//#include "csutil/scf_implementation.h"</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">//-- Helper macros</span>
<a name="l00048"></a>00048 
<a name="l00053"></a>00053 <span class="preprocessor">#ifdef SCF_DEBUG</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#  define SCF_TRACE(x)                                                  \</span>
<a name="l00055"></a>00055 <span class="preprocessor">   {                                                                    \</span>
<a name="l00056"></a>00056 <span class="preprocessor">     printf ("SCF [%s:%d]:\n", __FILE__, (int)__LINE__);                \</span>
<a name="l00057"></a>00057 <span class="preprocessor">     printf x; SCF_PRINT_CALL_ADDRESS                                   \</span>
<a name="l00058"></a>00058 <span class="preprocessor">   }</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00060"></a><a class="code" href="group__scf.html#ga28">00060</a> <span class="preprocessor"></span><span class="preprocessor">#  define SCF_TRACE(x)</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span>
<a name="l00067"></a>00067 <span class="preprocessor">#if (__GNUC__ &gt;= 3) || ((__GNUC__ &gt;= 2) &amp;&amp; (__GNUC_MINOR__ &gt;= 8))</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span><span class="preprocessor">#  define SCF_PRINT_CALL_ADDRESS                                        \</span>
<a name="l00069"></a>00069 <span class="preprocessor">   printf ("  Called from address %p\n", __builtin_return_address (0));</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00071"></a><a class="code" href="group__scf.html#ga29">00071</a> <span class="preprocessor"></span><span class="preprocessor">#  define SCF_PRINT_CALL_ADDRESS</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="preprocessor">#ifdef CS_REF_TRACKER</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor"> #include &lt;typeinfo&gt;</span>
<a name="l00077"></a>00077 <span class="preprocessor"> #include "<a class="code" href="string_8h.html">iutil/string.h</a>"</span>
<a name="l00078"></a>00078 <span class="preprocessor"> #include "<a class="code" href="databuff_8h.html">iutil/databuff.h</a>"</span>
<a name="l00079"></a>00079 <span class="preprocessor"> #define CS_TYPENAME(x)             typeid(x).name()</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span> <span class="comment">/* @@@ HACK: Force an AddAlias() call for every contained interface</span>
<a name="l00081"></a>00081 <span class="comment">  * However, when iSCF::SCF == 0, don't call QI to prevent interface ID </span>
<a name="l00082"></a>00082 <span class="comment">  * resolution (which will fail).</span>
<a name="l00083"></a>00083 <span class="comment">  */</span>
<a name="l00084"></a>00084 <span class="preprocessor"> #define SCF_INIT_TRACKER_ALIASES    \</span>
<a name="l00085"></a>00085 <span class="preprocessor">  if (iSCF::SCF != 0) QueryInterface ((scfInterfaceID)-1, -1);</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00087"></a><a class="code" href="group__scf.html#ga30">00087</a> <span class="preprocessor"></span><span class="preprocessor"> #define CS_TYPENAME(x)             0</span>
<a name="l00088"></a><a class="code" href="group__scf.html#ga31">00088</a> <span class="preprocessor"></span><span class="preprocessor"> #define SCF_INIT_TRACKER_ALIASES</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>
<a name="l00091"></a>00091 <span class="comment">//-- Old style implementation</span>
<a name="l00096"></a><a class="code" href="group__scf.html#ga32">00096</a> <span class="comment"></span><span class="preprocessor">#define SCF_DECLARE_IBASE                                               \</span>
<a name="l00097"></a>00097 <span class="preprocessor">  int scfRefCount;              </span><span class="comment">/* Reference counter */</span>                 \
<a name="l00098"></a>00098   csArray&lt;iBase**&gt;* scfWeakRefOwners;                                   \
<a name="l00099"></a>00099   void scfRemoveRefOwners ();                                           \
<a name="l00100"></a>00100   SCF_DECLARE_EMBEDDED_IBASE (iBase)
<a name="l00101"></a>00101 
<a name="l00106"></a><a class="code" href="group__scf.html#ga33">00106</a> <span class="preprocessor">#define SCF_DECLARE_EMBEDDED_IBASE(OuterClass)                          \</span>
<a name="l00107"></a>00107 <span class="preprocessor">public:                                                                 \</span>
<a name="l00108"></a>00108 <span class="preprocessor">  OuterClass *scfParent;        </span><span class="comment">/* The parent object */</span>                 \
<a name="l00109"></a>00109   virtual void IncRef ();                                               \
<a name="l00110"></a>00110   virtual void DecRef ();                                               \
<a name="l00111"></a>00111   virtual int GetRefCount ();                                           \
<a name="l00112"></a>00112   virtual void AddRefOwner (iBase** ref_owner);                         \
<a name="l00113"></a>00113   virtual void RemoveRefOwner (iBase** ref_owner);                      \
<a name="l00114"></a>00114   virtual void *QueryInterface (scfInterfaceID iInterfaceID, int iVersion)
<a name="l00115"></a>00115 
<a name="l00125"></a><a class="code" href="group__scf.html#ga34">00125</a> <span class="preprocessor">#define SCF_CONSTRUCT_IBASE(Parent)                                     \</span>
<a name="l00126"></a>00126 <span class="preprocessor">  csRefTrackerAccess::TrackConstruction (this);                         \</span>
<a name="l00127"></a>00127 <span class="preprocessor">  csRefTrackerAccess::SetDescription (this, CS_TYPENAME(*this));        \</span>
<a name="l00128"></a>00128 <span class="preprocessor">  scfRefCount = 1;                                                      \</span>
<a name="l00129"></a>00129 <span class="preprocessor">  scfWeakRefOwners = 0;                                                 \</span>
<a name="l00130"></a>00130 <span class="preprocessor">  scfParent = Parent; if (scfParent) scfParent-&gt;IncRef();               \</span>
<a name="l00131"></a>00131 <span class="preprocessor">  SCF_INIT_TRACKER_ALIASES                                              </span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00142"></a><a class="code" href="group__scf.html#ga35">00142</a> <span class="preprocessor">#define SCF_CONSTRUCT_EMBEDDED_IBASE(Interface)                         \</span>
<a name="l00143"></a>00143 <span class="preprocessor">  Interface.scfParent = this;                                           \</span>
<a name="l00144"></a>00144 <span class="preprocessor">  csRefTrackerAccess::AddAlias (&amp;Interface, this);</span>
<a name="l00145"></a>00145 <span class="preprocessor"></span>
<a name="l00151"></a><a class="code" href="group__scf.html#ga36">00151</a> <span class="preprocessor">#define SCF_DESTRUCT_IBASE()                                            \</span>
<a name="l00152"></a>00152 <span class="preprocessor">  csRefTrackerAccess::TrackDestruction (this, scfRefCount);             \</span>
<a name="l00153"></a>00153 <span class="preprocessor">  scfRemoveRefOwners ();</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>
<a name="l00161"></a><a class="code" href="group__scf.html#ga37">00161</a> <span class="preprocessor">#define SCF_DESTRUCT_EMBEDDED_IBASE(Interface)                          \</span>
<a name="l00162"></a>00162 <span class="preprocessor">  csRefTrackerAccess::RemoveAlias (&amp;Interface, this);                   \</span>
<a name="l00163"></a>00163 <span class="preprocessor">  Interface.scfParent = 0;</span>
<a name="l00164"></a>00164 <span class="preprocessor"></span>
<a name="l00170"></a><a class="code" href="group__scf.html#ga38">00170</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_INCREF(Class)                               \</span>
<a name="l00171"></a>00171 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
<a name="l00172"></a>00172 <span class="preprocessor">{                                                                       \</span>
<a name="l00173"></a>00173 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;IncRef (%d)\n", #Class, this, scfRefCount + 1));\</span>
<a name="l00174"></a>00174 <span class="preprocessor">  csRefTrackerAccess::TrackIncRef (this, scfRefCount);                  \</span>
<a name="l00175"></a>00175 <span class="preprocessor">  scfRefCount++;                                                        \</span>
<a name="l00176"></a>00176 <span class="preprocessor">}</span>
<a name="l00177"></a>00177 <span class="preprocessor"></span>
<a name="l00186"></a><a class="code" href="group__scf.html#ga39">00186</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_DECREF(Class)                               \</span>
<a name="l00187"></a>00187 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
<a name="l00188"></a>00188 <span class="preprocessor">{                                                                       \</span>
<a name="l00189"></a>00189 <span class="preprocessor">  csRefTrackerAccess::TrackDecRef (this, scfRefCount);                  \</span>
<a name="l00190"></a>00190 <span class="preprocessor">  if (scfRefCount == 1)                                                 \</span>
<a name="l00191"></a>00191 <span class="preprocessor">  {                                                                     \</span>
<a name="l00192"></a>00192 <span class="preprocessor">    SCF_TRACE ((" delete (%s *)%p\n", #Class, this));                   \</span>
<a name="l00193"></a>00193 <span class="preprocessor">    scfRemoveRefOwners ();                                              \</span>
<a name="l00194"></a>00194 <span class="preprocessor">    if (scfParent)                                                      \</span>
<a name="l00195"></a>00195 <span class="preprocessor">      scfParent-&gt;DecRef ();                                             \</span>
<a name="l00196"></a>00196 <span class="preprocessor">    delete this;                                                        \</span>
<a name="l00197"></a>00197 <span class="preprocessor">    return;                                                             \</span>
<a name="l00198"></a>00198 <span class="preprocessor">  }                                                                     \</span>
<a name="l00199"></a>00199 <span class="preprocessor">  scfRefCount--;                                                        \</span>
<a name="l00200"></a>00200 <span class="preprocessor">}</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="group__scf.html#ga40">00208</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_REMOVE_REF_OWNERS(Class)                    \</span>
<a name="l00209"></a>00209 <span class="preprocessor">void Class::scfRemoveRefOwners ()                                       \</span>
<a name="l00210"></a>00210 <span class="preprocessor">{                                                                       \</span>
<a name="l00211"></a>00211 <span class="preprocessor">  if (!scfWeakRefOwners) return;                                        \</span>
<a name="l00212"></a>00212 <span class="preprocessor">  for (size_t i = 0 ; i &lt; scfWeakRefOwners-&gt;Length () ; i++)            \</span>
<a name="l00213"></a>00213 <span class="preprocessor">  {                                                                     \</span>
<a name="l00214"></a>00214 <span class="preprocessor">    iBase** p = (*scfWeakRefOwners)[i];                                 \</span>
<a name="l00215"></a>00215 <span class="preprocessor">    *p = 0;                                                             \</span>
<a name="l00216"></a>00216 <span class="preprocessor">  }                                                                     \</span>
<a name="l00217"></a>00217 <span class="preprocessor">  delete scfWeakRefOwners;                                              \</span>
<a name="l00218"></a>00218 <span class="preprocessor">  scfWeakRefOwners = 0;                                                 \</span>
<a name="l00219"></a>00219 <span class="preprocessor">}</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="group__scf.html#ga41">00225</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_REFOWNER(Class)                             \</span>
<a name="l00226"></a>00226 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
<a name="l00227"></a>00227 <span class="preprocessor">{                                                                       \</span>
<a name="l00228"></a>00228 <span class="preprocessor">  if (!scfWeakRefOwners)                                                \</span>
<a name="l00229"></a>00229 <span class="preprocessor">    scfWeakRefOwners = new csArray&lt;iBase**&gt; (0, 4);                     \</span>
<a name="l00230"></a>00230 <span class="preprocessor">  scfWeakRefOwners-&gt;InsertSorted (ref_owner);                           \</span>
<a name="l00231"></a>00231 <span class="preprocessor">}                                                                       \</span>
<a name="l00232"></a>00232 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
<a name="l00233"></a>00233 <span class="preprocessor">{                                                                       \</span>
<a name="l00234"></a>00234 <span class="preprocessor">  if (!scfWeakRefOwners)                                                \</span>
<a name="l00235"></a>00235 <span class="preprocessor">    return;                                                             \</span>
<a name="l00236"></a>00236 <span class="preprocessor">  size_t index = scfWeakRefOwners-&gt;FindSortedKey (                      \</span>
<a name="l00237"></a>00237 <span class="preprocessor">    csArrayCmp&lt;iBase**, iBase**&gt; (ref_owner));                          \</span>
<a name="l00238"></a>00238 <span class="preprocessor">  if (index != csArrayItemNotFound) scfWeakRefOwners-&gt;DeleteIndex (     \</span>
<a name="l00239"></a>00239 <span class="preprocessor">    index);                                                             \</span>
<a name="l00240"></a>00240 <span class="preprocessor">}</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>
<a name="l00246"></a><a class="code" href="group__scf.html#ga42">00246</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_GETREFCOUNT(Class)                          \</span>
<a name="l00247"></a>00247 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
<a name="l00248"></a>00248 <span class="preprocessor">{                                                                       \</span>
<a name="l00249"></a>00249 <span class="preprocessor">  return scfRefCount;                                                   \</span>
<a name="l00250"></a>00250 <span class="preprocessor">}</span>
<a name="l00251"></a>00251 <span class="preprocessor"></span>
<a name="l00258"></a><a class="code" href="group__scf.html#ga43">00258</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_QUERY(Class)                                \</span>
<a name="l00259"></a>00259 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
<a name="l00260"></a>00260 <span class="preprocessor">{                                                                       \</span>
<a name="l00261"></a>00261 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;QueryInterface (%lu, %08X)\n",               \</span>
<a name="l00262"></a>00262 <span class="preprocessor">    #Class, this, iInterfaceID, iVersion));</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span>
<a name="l00270"></a><a class="code" href="group__scf.html#ga44">00270</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_QUERY_END                                   \</span>
<a name="l00271"></a>00271 <span class="preprocessor">  return scfParent ?                                                    \</span>
<a name="l00272"></a>00272 <span class="preprocessor">    scfParent-&gt;QueryInterface (iInterfaceID, iVersion) : 0;             \</span>
<a name="l00273"></a>00273 <span class="preprocessor">}</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>
<a name="l00280"></a><a class="code" href="group__scf.html#ga45">00280</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE(Class)                                      \</span>
<a name="l00281"></a>00281 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_INCREF(Class)                                     \</span>
<a name="l00282"></a>00282 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_DECREF(Class)                                     \</span>
<a name="l00283"></a>00283 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_GETREFCOUNT(Class)                                \</span>
<a name="l00284"></a>00284 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_REFOWNER(Class)                                   \</span>
<a name="l00285"></a>00285 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_REMOVE_REF_OWNERS(Class)                          \</span>
<a name="l00286"></a>00286 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_QUERY(Class)</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>
<a name="l00292"></a><a class="code" href="group__scf.html#ga46">00292</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_END                                         \</span>
<a name="l00293"></a>00293 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_QUERY_END</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>
<a name="l00301"></a><a class="code" href="group__scf.html#ga47">00301</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_INCREF(Class)                      \</span>
<a name="l00302"></a>00302 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
<a name="l00303"></a>00303 <span class="preprocessor">{                                                                       \</span>
<a name="l00304"></a>00304 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;IncRef (%d)\n", #Class, this,                \</span>
<a name="l00305"></a>00305 <span class="preprocessor">    scfParent-&gt;GetRefCount () + 1));                                    \</span>
<a name="l00306"></a>00306 <span class="preprocessor">  scfParent-&gt;IncRef ();                                                 \</span>
<a name="l00307"></a>00307 <span class="preprocessor">}</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>
<a name="l00315"></a><a class="code" href="group__scf.html#ga48">00315</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_DECREF(Class)                      \</span>
<a name="l00316"></a>00316 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
<a name="l00317"></a>00317 <span class="preprocessor">{                                                                       \</span>
<a name="l00318"></a>00318 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;DecRef (%d)\n", #Class, this,                \</span>
<a name="l00319"></a>00319 <span class="preprocessor">              scfParent-&gt;GetRefCount ()-1));                            \</span>
<a name="l00320"></a>00320 <span class="preprocessor">  scfParent-&gt;DecRef ();                                                 \</span>
<a name="l00321"></a>00321 <span class="preprocessor">}</span>
<a name="l00322"></a>00322 <span class="preprocessor"></span>
<a name="l00327"></a><a class="code" href="group__scf.html#ga49">00327</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_GETREFCOUNT(Class)                 \</span>
<a name="l00328"></a>00328 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
<a name="l00329"></a>00329 <span class="preprocessor">{                                                                       \</span>
<a name="l00330"></a>00330 <span class="preprocessor">  return scfParent-&gt;GetRefCount ();                                     \</span>
<a name="l00331"></a>00331 <span class="preprocessor">}</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span>
<a name="l00337"></a><a class="code" href="group__scf.html#ga50">00337</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_REFOWNER(Class)                    \</span>
<a name="l00338"></a>00338 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
<a name="l00339"></a>00339 <span class="preprocessor">{                                                                       \</span>
<a name="l00340"></a>00340 <span class="preprocessor">  scfParent-&gt;AddRefOwner (ref_owner);                                   \</span>
<a name="l00341"></a>00341 <span class="preprocessor">}                                                                       \</span>
<a name="l00342"></a>00342 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
<a name="l00343"></a>00343 <span class="preprocessor">{                                                                       \</span>
<a name="l00344"></a>00344 <span class="preprocessor">  scfParent-&gt;RemoveRefOwner (ref_owner);                                \</span>
<a name="l00345"></a>00345 <span class="preprocessor">}</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span>
<a name="l00353"></a><a class="code" href="group__scf.html#ga51">00353</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY(Class)                       \</span>
<a name="l00354"></a>00354 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
<a name="l00355"></a>00355 <span class="preprocessor">{                                                                       \</span>
<a name="l00356"></a>00356 <span class="preprocessor">  SCF_TRACE (("  (%s *)%p-&gt;QueryInterface (%lu, %08X)\n",               \</span>
<a name="l00357"></a>00357 <span class="preprocessor">    #Class, this, iInterfaceID, iVersion));</span>
<a name="l00358"></a>00358 <span class="preprocessor"></span>
<a name="l00365"></a><a class="code" href="group__scf.html#ga52">00365</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY_END                          \</span>
<a name="l00366"></a>00366 <span class="preprocessor">  return scfParent-&gt;QueryInterface (iInterfaceID, iVersion);            \</span>
<a name="l00367"></a>00367 <span class="preprocessor">}</span>
<a name="l00368"></a>00368 <span class="preprocessor"></span>
<a name="l00375"></a><a class="code" href="group__scf.html#ga53">00375</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE(Class)                             \</span>
<a name="l00376"></a>00376 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_INCREF(Class)                            \</span>
<a name="l00377"></a>00377 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_DECREF(Class)                            \</span>
<a name="l00378"></a>00378 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_GETREFCOUNT(Class)                       \</span>
<a name="l00379"></a>00379 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_REFOWNER(Class)                          \</span>
<a name="l00380"></a>00380 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY(Class)</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>
<a name="l00386"></a><a class="code" href="group__scf.html#ga54">00386</a> <span class="preprocessor">#define SCF_IMPLEMENT_EMBEDDED_IBASE_END                                \</span>
<a name="l00387"></a>00387 <span class="preprocessor">  SCF_IMPLEMENT_EMBEDDED_IBASE_QUERY_END</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>
<a name="l00395"></a><a class="code" href="group__scf.html#ga55">00395</a> <span class="preprocessor">#define SCF_IMPLEMENTS_INTERFACE(Interface)                             \</span>
<a name="l00396"></a>00396 <span class="preprocessor">  csRefTrackerAccess::AddAlias (CS_STATIC_CAST(Interface*, this), this);\</span>
<a name="l00397"></a>00397 <span class="preprocessor">  SCF_IMPLEMENTS_INTERFACE_COMMON (Interface, this)</span>
<a name="l00398"></a>00398 <span class="preprocessor"></span>
<a name="l00403"></a><a class="code" href="group__scf.html#ga56">00403</a> <span class="preprocessor">#define SCF_IMPLEMENTS_EMBEDDED_INTERFACE(Interface)                    \</span>
<a name="l00404"></a>00404 <span class="preprocessor">  SCF_IMPLEMENTS_INTERFACE_COMMON (Interface, (&amp;scf##Interface))</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
<a name="l00409"></a><a class="code" href="group__scf.html#ga57">00409</a> <span class="preprocessor">#define SCF_IMPLEMENTS_INTERFACE_COMMON(Interface,Object)               \</span>
<a name="l00410"></a>00410 <span class="preprocessor">  if (iInterfaceID == scfInterfaceTraits&lt;Interface&gt;::GetID() &amp;&amp;         \</span>
<a name="l00411"></a>00411 <span class="preprocessor">    scfCompatibleVersion (iVersion, scfInterfaceTraits&lt;Interface&gt;::GetVersion())) \</span>
<a name="l00412"></a>00412 <span class="preprocessor">  {                                                                     \</span>
<a name="l00413"></a>00413 <span class="preprocessor">    (Object)-&gt;IncRef ();                                                \</span>
<a name="l00414"></a>00414 <span class="preprocessor">    return CS_STATIC_CAST(Interface*, Object);                          \</span>
<a name="l00415"></a>00415 <span class="preprocessor">  }</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00427"></a><a class="code" href="group__scf.html#ga58">00427</a> <span class="preprocessor">#define SCF_DECLARE_IBASE_EXT(ParentClass)                              \</span>
<a name="l00428"></a>00428 <span class="preprocessor">  typedef ParentClass __scf_superclass;                                 \</span>
<a name="l00429"></a>00429 <span class="preprocessor">  virtual void IncRef ();                                               \</span>
<a name="l00430"></a>00430 <span class="preprocessor">  virtual void DecRef ();                                               \</span>
<a name="l00431"></a>00431 <span class="preprocessor">  virtual int GetRefCount ();                                           \</span>
<a name="l00432"></a>00432 <span class="preprocessor">  virtual void AddRefOwner (iBase** ref_owner);                         \</span>
<a name="l00433"></a>00433 <span class="preprocessor">  virtual void RemoveRefOwner (iBase** ref_owner);                      \</span>
<a name="l00434"></a>00434 <span class="preprocessor">  virtual void *QueryInterface (scfInterfaceID iInterfaceID, int iVersion)</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>
<a name="l00442"></a><a class="code" href="group__scf.html#ga59">00442</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_INCREF(Class)                           \</span>
<a name="l00443"></a>00443 <span class="preprocessor">void Class::IncRef ()                                                   \</span>
<a name="l00444"></a>00444 <span class="preprocessor">{                                                                       \</span>
<a name="l00445"></a>00445 <span class="preprocessor">  __scf_superclass::IncRef ();                                          \</span>
<a name="l00446"></a>00446 <span class="preprocessor">}</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>
<a name="l00454"></a><a class="code" href="group__scf.html#ga60">00454</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_DECREF(Class)                           \</span>
<a name="l00455"></a>00455 <span class="preprocessor">void Class::DecRef ()                                                   \</span>
<a name="l00456"></a>00456 <span class="preprocessor">{                                                                       \</span>
<a name="l00457"></a>00457 <span class="preprocessor">  __scf_superclass::DecRef ();                                          \</span>
<a name="l00458"></a>00458 <span class="preprocessor">}</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span>
<a name="l00466"></a><a class="code" href="group__scf.html#ga61">00466</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_GETREFCOUNT(Class)                      \</span>
<a name="l00467"></a>00467 <span class="preprocessor">int Class::GetRefCount ()                                               \</span>
<a name="l00468"></a>00468 <span class="preprocessor">{                                                                       \</span>
<a name="l00469"></a>00469 <span class="preprocessor">  return __scf_superclass::GetRefCount ();                              \</span>
<a name="l00470"></a>00470 <span class="preprocessor">}</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span>
<a name="l00476"></a><a class="code" href="group__scf.html#ga62">00476</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_REFOWNER(Class)                 \</span>
<a name="l00477"></a>00477 <span class="preprocessor">void Class::AddRefOwner (iBase** ref_owner)                             \</span>
<a name="l00478"></a>00478 <span class="preprocessor">{                                                                       \</span>
<a name="l00479"></a>00479 <span class="preprocessor">  __scf_superclass::AddRefOwner (ref_owner);                            \</span>
<a name="l00480"></a>00480 <span class="preprocessor">}                                                                       \</span>
<a name="l00481"></a>00481 <span class="preprocessor">void Class::RemoveRefOwner (iBase** ref_owner)                          \</span>
<a name="l00482"></a>00482 <span class="preprocessor">{                                                                       \</span>
<a name="l00483"></a>00483 <span class="preprocessor">  __scf_superclass::RemoveRefOwner (ref_owner);                         \</span>
<a name="l00484"></a>00484 <span class="preprocessor">}</span>
<a name="l00485"></a>00485 <span class="preprocessor"></span>
<a name="l00492"></a><a class="code" href="group__scf.html#ga63">00492</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_QUERY(Class)                            \</span>
<a name="l00493"></a>00493 <span class="preprocessor">void *Class::QueryInterface (scfInterfaceID iInterfaceID, int iVersion) \</span>
<a name="l00494"></a>00494 <span class="preprocessor">{</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span>
<a name="l00502"></a><a class="code" href="group__scf.html#ga64">00502</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_QUERY_END                               \</span>
<a name="l00503"></a>00503 <span class="preprocessor">  return __scf_superclass::QueryInterface (iInterfaceID, iVersion);     \</span>
<a name="l00504"></a>00504 <span class="preprocessor">}</span>
<a name="l00505"></a>00505 <span class="preprocessor"></span>
<a name="l00510"></a><a class="code" href="group__scf.html#ga65">00510</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT(Class)                                  \</span>
<a name="l00511"></a>00511 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_INCREF(Class)                                 \</span>
<a name="l00512"></a>00512 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_DECREF(Class)                                 \</span>
<a name="l00513"></a>00513 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_GETREFCOUNT(Class)                            \</span>
<a name="l00514"></a>00514 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_REFOWNER(Class)                               \</span>
<a name="l00515"></a>00515 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_QUERY(Class)</span>
<a name="l00516"></a>00516 <span class="preprocessor"></span>
<a name="l00521"></a><a class="code" href="group__scf.html#ga66">00521</a> <span class="preprocessor">#define SCF_IMPLEMENT_IBASE_EXT_END                                     \</span>
<a name="l00522"></a>00522 <span class="preprocessor">  SCF_IMPLEMENT_IBASE_EXT_QUERY_END</span>
<a name="l00523"></a>00523 <span class="preprocessor"></span>
<a name="l00539"></a>00539 <span class="preprocessor">#ifdef CS_MEMORY_TRACKER</span>
<a name="l00540"></a>00540 <span class="preprocessor"></span><span class="comment">// This special version of SCF_IMPLEMENT_FACTORY_INIT will make sure that</span>
<a name="l00541"></a>00541 <span class="comment">// the memory tracker for this plugin is implemented.</span>
<a name="l00542"></a>00542 <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_INIT(Class)                               \</span>
<a name="l00543"></a>00543 <span class="preprocessor">static inline void Class ## _scfUnitInitialize(iSCF* SCF)               \</span>
<a name="l00544"></a>00544 <span class="preprocessor">{                                                                       \</span>
<a name="l00545"></a>00545 <span class="preprocessor">  iSCF::SCF = SCF;                                                      \</span>
<a name="l00546"></a>00546 <span class="preprocessor">  extern void mtiRegisterModule (char*);                                \</span>
<a name="l00547"></a>00547 <span class="preprocessor">  mtiRegisterModule (#Class);                                           \</span>
<a name="l00548"></a>00548 <span class="preprocessor">}                                                                       \</span>
<a name="l00549"></a>00549 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
<a name="l00550"></a>00550 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfInitialize)(iSCF* SCF)                  \</span>
<a name="l00551"></a>00551 <span class="preprocessor">{ Class ## _scfUnitInitialize(SCF); }</span>
<a name="l00552"></a>00552 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00553"></a><a class="code" href="group__scf.html#ga67">00553</a> <span class="preprocessor"></span><span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_INIT(Class)                               \</span>
<a name="l00554"></a>00554 <span class="preprocessor">static inline void Class ## _scfUnitInitialize(iSCF* SCF)               \</span>
<a name="l00555"></a>00555 <span class="preprocessor">{ iSCF::SCF = SCF; }                                                    \</span>
<a name="l00556"></a>00556 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
<a name="l00557"></a>00557 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfInitialize)(iSCF* SCF)                  \</span>
<a name="l00558"></a>00558 <span class="preprocessor">{ Class ## _scfUnitInitialize(SCF); }</span>
<a name="l00559"></a>00559 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00560"></a>00560 <span class="preprocessor"></span>
<a name="l00566"></a><a class="code" href="group__scf.html#ga68">00566</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_FINIS(Class)                              \</span>
<a name="l00567"></a>00567 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
<a name="l00568"></a>00568 <span class="preprocessor">void CS_EXPORTED_NAME(Class,_scfFinalize)()                             \</span>
<a name="l00569"></a>00569 <span class="preprocessor">{                                                                       \</span>
<a name="l00570"></a>00570 <span class="preprocessor">CS_STATIC_VARIABLE_CLEANUP                                              \</span>
<a name="l00571"></a>00571 <span class="preprocessor">}</span>
<a name="l00572"></a>00572 <span class="preprocessor"></span>
<a name="l00579"></a><a class="code" href="group__scf.html#ga69">00579</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY_CREATE(Class)                             \</span>
<a name="l00580"></a>00580 <span class="preprocessor">CS_EXPORTED_FUNCTION                                                    \</span>
<a name="l00581"></a>00581 <span class="preprocessor">iBase* CS_EXPORTED_NAME(Class,_Create)(iBase *iParent)                  \</span>
<a name="l00582"></a>00582 <span class="preprocessor">{                                                                       \</span>
<a name="l00583"></a>00583 <span class="preprocessor">  iBase *ret = new Class (iParent);                                     \</span>
<a name="l00584"></a>00584 <span class="preprocessor">  SCF_TRACE (("  %p = new %s ()\n", ret, #Class));                      \</span>
<a name="l00585"></a>00585 <span class="preprocessor">  return ret;                                                           \</span>
<a name="l00586"></a>00586 <span class="preprocessor">}</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span>
<a name="l00594"></a><a class="code" href="group__scf.html#ga70">00594</a> <span class="preprocessor">#define SCF_IMPLEMENT_FACTORY(Class)                                    \</span>
<a name="l00595"></a>00595 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_INIT(Class)                                     \</span>
<a name="l00596"></a>00596 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_FINIS(Class)                                    \</span>
<a name="l00597"></a>00597 <span class="preprocessor">  SCF_IMPLEMENT_FACTORY_CREATE(Class)</span>
<a name="l00598"></a>00598 <span class="preprocessor"></span>
<a name="l00599"></a><a class="code" href="group__scf.html#ga71">00599</a> <span class="preprocessor">#define SCF_STATIC_CLASS_CONTEXT      "*static*"</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span>
<a name="l00609"></a><a class="code" href="group__scf.html#ga72">00609</a> <span class="preprocessor">#define SCF_REGISTER_STATIC_CLASS(Class,Ident,Desc,Dep)                 \</span>
<a name="l00610"></a>00610 <span class="preprocessor">  CS_EXPORTED_FUNCTION iBase* CS_EXPORTED_NAME(Class,_Create)(iBase*);  \</span>
<a name="l00611"></a>00611 <span class="preprocessor">  class Class##_StaticInit__                                            \</span>
<a name="l00612"></a>00612 <span class="preprocessor">  {                                                                     \</span>
<a name="l00613"></a>00613 <span class="preprocessor">  public:                                                               \</span>
<a name="l00614"></a>00614 <span class="preprocessor">    Class##_StaticInit__()                                              \</span>
<a name="l00615"></a>00615 <span class="preprocessor">    {                                                                   \</span>
<a name="l00616"></a>00616 <span class="preprocessor">      scfRegisterStaticClass(                                           \</span>
<a name="l00617"></a>00617 <span class="preprocessor">        CS_EXPORTED_NAME(Class,_Create), Ident, Desc, Dep);             \</span>
<a name="l00618"></a>00618 <span class="preprocessor">    }                                                                   \</span>
<a name="l00619"></a>00619 <span class="preprocessor">  } Class##_static_init__;</span>
<a name="l00620"></a>00620 <span class="preprocessor"></span>
<a name="l00625"></a><a class="code" href="group__scf.html#ga73">00625</a> <span class="preprocessor">#define SCF_REGISTER_STATIC_LIBRARY(Module, MetaInfo)                   \</span>
<a name="l00626"></a>00626 <span class="preprocessor">  class Module##_StaticInit                                             \</span>
<a name="l00627"></a>00627 <span class="preprocessor">  {                                                                     \</span>
<a name="l00628"></a>00628 <span class="preprocessor">  public:                                                               \</span>
<a name="l00629"></a>00629 <span class="preprocessor">    Module##_StaticInit()                                               \</span>
<a name="l00630"></a>00630 <span class="preprocessor">    {                                                                   \</span>
<a name="l00631"></a>00631 <span class="preprocessor">      scfRegisterStaticClasses (MetaInfo);                              \</span>
<a name="l00632"></a>00632 <span class="preprocessor">    }                                                                   \</span>
<a name="l00633"></a>00633 <span class="preprocessor">  } Module##_static_init__;</span>
<a name="l00634"></a>00634 <span class="preprocessor"></span>
<a name="l00639"></a><a class="code" href="group__scf.html#ga74">00639</a> <span class="preprocessor">#define SCF_DEFINE_FACTORY_FUNC_REGISTRATION(Class)                     \</span>
<a name="l00640"></a>00640 <span class="preprocessor">  CS_EXPORTED_FUNCTION iBase* CS_EXPORTED_NAME(Class,_Create)(iBase*);  \</span>
<a name="l00641"></a>00641 <span class="preprocessor">  class Class##_StaticInit                                              \</span>
<a name="l00642"></a>00642 <span class="preprocessor">  {                                                                     \</span>
<a name="l00643"></a>00643 <span class="preprocessor">  public:                                                               \</span>
<a name="l00644"></a>00644 <span class="preprocessor">    Class##_StaticInit()                                                \</span>
<a name="l00645"></a>00645 <span class="preprocessor">    {                                                                   \</span>
<a name="l00646"></a>00646 <span class="preprocessor">      scfRegisterStaticFactoryFunc (CS_EXPORTED_NAME(Class,_Create),    \</span>
<a name="l00647"></a>00647 <span class="preprocessor">        #Class);                                                        \</span>
<a name="l00648"></a>00648 <span class="preprocessor">    }                                                                   \</span>
<a name="l00649"></a>00649 <span class="preprocessor">  };</span>
<a name="l00650"></a>00650 <span class="preprocessor"></span>
<a name="l00655"></a><a class="code" href="group__scf.html#ga75">00655</a> <span class="preprocessor">#define SCF_USE_STATIC_PLUGIN(Module)                                   \</span>
<a name="l00656"></a>00656 <span class="preprocessor">  namespace csStaticPluginInit                                          \</span>
<a name="l00657"></a>00657 <span class="preprocessor">  {                                                                     \</span>
<a name="l00658"></a>00658 <span class="preprocessor">    class Module { public: Module(); };                                 \</span>
<a name="l00659"></a>00659 <span class="preprocessor">    Module Module##_StaticInit;                                         \</span>
<a name="l00660"></a>00660 <span class="preprocessor">  }</span>
<a name="l00661"></a>00661 <span class="preprocessor"></span>
<a name="l00670"></a><a class="code" href="group__scf.html#ga76">00670</a> <span class="preprocessor">#define SCF_REGISTER_FACTORY_FUNC(Class)                                \</span>
<a name="l00671"></a>00671 <span class="preprocessor">  SCF_DEFINE_FACTORY_FUNC_REGISTRATION(Class)                           \</span>
<a name="l00672"></a>00672 <span class="preprocessor">  Class##_StaticInit Class##_static_init__;</span>
<a name="l00673"></a>00673 <span class="preprocessor"></span>
<a name="l00674"></a>00674 <span class="comment">//--------------------------------------------- Class factory interface -----//</span>
<a name="l00675"></a>00675 
<a name="l00689"></a><a class="code" href="structiFactory.html">00689</a> <span class="keyword">struct </span><a class="code" href="structiFactory.html">iFactory</a> : <span class="keyword">public</span> <a class="code" href="structiBase.html">iBase</a>
<a name="l00690"></a>00690 {
<a name="l00692"></a>00692   <span class="keyword">virtual</span> <a class="code" href="structiBase.html">iBase</a> *<a class="code" href="structiFactory.html#a0">CreateInstance</a> () = 0;
<a name="l00694"></a>00694   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structiFactory.html#a5">TryUnload</a> () = 0;
<a name="l00696"></a>00696   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a3">QueryDescription</a> () = 0;
<a name="l00698"></a>00698   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a2">QueryDependencies</a> () = 0;
<a name="l00700"></a>00700   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a1">QueryClassID</a> () = 0;
<a name="l00702"></a>00702   <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structiFactory.html#a4">QueryModuleName</a> () = 0;
<a name="l00703"></a>00703 };
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="comment">//----------------------------------------------- Client-side functions -----//</span>
<a name="l00706"></a>00706 
<a name="l00711"></a>00711 <span class="keyword">enum</span>
<a name="l00712"></a>00712 {
<a name="l00713"></a>00713   <a class="code" href="group__scf.html#gga88a52">SCF_VERBOSE_NONE</a>            = 0,      
<a name="l00714"></a>00714   <a class="code" href="group__scf.html#gga88a53">SCF_VERBOSE_PLUGIN_SCAN</a>     = 1 &lt;&lt; 0, 
<a name="l00715"></a>00715   <a class="code" href="group__scf.html#gga88a54">SCF_VERBOSE_PLUGIN_LOAD</a>     = 1 &lt;&lt; 1, 
<a name="l00716"></a>00716   <a class="code" href="group__scf.html#gga88a55">SCF_VERBOSE_PLUGIN_REGISTER</a> = 1 &lt;&lt; 2, 
<a name="l00717"></a>00717   <a class="code" href="group__scf.html#gga88a56">SCF_VERBOSE_CLASS_REGISTER</a>  = 1 &lt;&lt; 3, 
<a name="l00718"></a><a class="code" href="group__scf.html#gga88a57">00718</a>   <a class="code" href="group__scf.html#gga88a57">SCF_VERBOSE_ALL</a>             = ~0      
<a name="l00719"></a>00719 };
<a name="l00720"></a>00720 
<a name="l00736"></a>00736 CS_CRYSTALSPACE_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga3">scfInitialize</a>(<a class="code" href="classcsPathsList.html">csPathsList</a> <span class="keyword">const</span>* pluginPaths,
<a name="l00737"></a>00737   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> verbose = <a class="code" href="group__scf.html#gga88a52">SCF_VERBOSE_NONE</a>);
<a name="l00738"></a>00738 
<a name="l00743"></a>00743 CS_CRYSTALSPACE_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga3">scfInitialize</a>(<span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> argv[]);
<a name="l00744"></a>00744 
<a name="l00746"></a>00746 
<a name="l00752"></a>00752 CS_CRYSTALSPACE_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga5">scfRegisterStaticClass</a> (<a class="code" href="group__scf.html#ga2">scfFactoryFunc</a>, 
<a name="l00753"></a>00753   <span class="keyword">const</span> <span class="keywordtype">char</span> *iClassID, <span class="keyword">const</span> <span class="keywordtype">char</span> *Description, 
<a name="l00754"></a>00754   <span class="keyword">const</span> <span class="keywordtype">char</span> *Dependencies = 0);
<a name="l00755"></a>00755 CS_CRYSTALSPACE_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga6">scfRegisterStaticClasses</a> (<span class="keywordtype">char</span> <span class="keyword">const</span>* xml);
<a name="l00756"></a>00756 CS_CRYSTALSPACE_EXPORT <span class="keywordtype">void</span> <a class="code" href="group__scf.html#ga7">scfRegisterStaticFactoryFunc</a> (<a class="code" href="group__scf.html#ga2">scfFactoryFunc</a>, 
<a name="l00757"></a>00757   <span class="keyword">const</span> <span class="keywordtype">char</span> *FactClass);
<a name="l00759"></a>00759   
<a name="l00760"></a>00760 <span class="comment">//---------- IMPLEMENTATION OF HELPER FUNCTIONS</span>
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 
<a name="l00767"></a>00767 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Interface, <span class="keyword">class</span> ClassPtr&gt;
<a name="l00768"></a><a class="code" href="group__scf.html#ga8">00768</a> <span class="keyword">inline</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> <a class="code" href="group__scf.html#ga8">scfQueryInterface</a> (ClassPtr object)
<a name="l00769"></a>00769 {
<a name="l00770"></a>00770   Interface *x = (Interface*)object-&gt;QueryInterface (
<a name="l00771"></a>00771     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetID (),
<a name="l00772"></a>00772     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetVersion ());
<a name="l00773"></a>00773   <span class="keywordflow">return</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> (x);
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 <span class="comment">//Compatibility macro for scfQueryInterface</span>
<a name="l00777"></a><a class="code" href="group__scf.html#ga77">00777</a> <span class="preprocessor">#define SCF_QUERY_INTERFACE(Object,Interface) \</span>
<a name="l00778"></a>00778 <span class="preprocessor">  scfQueryInterface&lt;Interface&gt; (Object)</span>
<a name="l00779"></a>00779 <span class="preprocessor"></span>
<a name="l00784"></a>00784 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Interface, <span class="keyword">class</span> ClassPtr&gt;
<a name="l00785"></a><a class="code" href="group__scf.html#ga9">00785</a> <span class="keyword">inline</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> <a class="code" href="group__scf.html#ga9">scfQueryInterfaceSafe</a> (ClassPtr object)
<a name="l00786"></a>00786 {
<a name="l00787"></a>00787   <span class="keywordflow">if</span> (object == 0) <span class="keywordflow">return</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> (0);
<a name="l00788"></a>00788 
<a name="l00789"></a>00789   Interface *x = (Interface*)object-&gt;QueryInterface (
<a name="l00790"></a>00790     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetID (),
<a name="l00791"></a>00791     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetVersion ());
<a name="l00792"></a>00792   <span class="keywordflow">return</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> (x);
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 <span class="comment">//Compatibility macro for scfQueryInterfaceSafe</span>
<a name="l00795"></a><a class="code" href="group__scf.html#ga78">00795</a> <span class="preprocessor">#define SCF_QUERY_INTERFACE_SAFE(Object,Interface) \</span>
<a name="l00796"></a>00796 <span class="preprocessor">  scfQueryInterfaceSafe&lt;Interface&gt; (Object)</span>
<a name="l00797"></a>00797 <span class="preprocessor"></span>
<a name="l00801"></a>00801 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Interface&gt;
<a name="l00802"></a><a class="code" href="group__scf.html#ga10">00802</a> <span class="keyword">inline</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> <a class="code" href="group__scf.html#ga10">scfCreateInstance</a> (<span class="keywordtype">char</span> <span class="keyword">const</span> * <span class="keyword">const</span> ClassID)
<a name="l00803"></a>00803 {
<a name="l00804"></a>00804   <a class="code" href="structiBase.html">iBase</a> *base = <a class="code" href="structiSCF.html#s0">iSCF::SCF</a>-&gt;<a class="code" href="structiSCF.html#a1">CreateInstance</a> (ClassID);
<a name="l00805"></a>00805 
<a name="l00806"></a>00806   <span class="keywordflow">if</span> (base == 0) <span class="keywordflow">return</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> (0);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   Interface *x = (Interface*)base-&gt;<a class="code" href="structiBase.html#a4">QueryInterface</a> (
<a name="l00809"></a>00809     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetID (),
<a name="l00810"></a>00810     <a class="code" href="classscfInterfaceTraits.html">scfInterfaceTraits&lt;Interface&gt;</a>::GetVersion ());
<a name="l00811"></a>00811 
<a name="l00812"></a>00812   <span class="keywordflow">if</span> (x) base-&gt;<a class="code" href="structiBase.html#a1">DecRef</a> (); <span class="comment">//release our base interface</span>
<a name="l00813"></a>00813   <span class="keywordflow">return</span> <a class="code" href="classcsPtr.html">csPtr&lt;Interface&gt;</a> (x);
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="comment">// Compatibility macro for scfCreateInstance function</span>
<a name="l00817"></a><a class="code" href="group__scf.html#ga79">00817</a> <span class="preprocessor">#define SCF_CREATE_INSTANCE(ClassID,Interface) \</span>
<a name="l00818"></a>00818 <span class="preprocessor">  scfCreateInstance&lt;Interface&gt; (ClassID)</span>
<a name="l00819"></a>00819 <span class="preprocessor"></span>
<a name="l00820"></a>00820 <span class="comment">// Give versions to above declared classes.</span>
<a name="l00821"></a>00821 <a class="code" href="group__scf.html#ga83">SCF_VERSION</a> (<a class="code" href="structiFactory.html">iFactory</a>, 0, 0, 2);
<a name="l00822"></a>00822 
<a name="l00823"></a>00823 <span class="comment">// A bit hacky.</span>
<a name="l00824"></a>00824 <span class="preprocessor">#include "<a class="code" href="reftrackeraccess_8h.html">csutil/reftrackeraccess.h</a>"</span>
<a name="l00825"></a>00825 
<a name="l00828"></a>00828 <span class="preprocessor">#endif // __CSSCF_H__</span>
</pre></div><hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.4.4 
</small></address> </div></body> </html>
