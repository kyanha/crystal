<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Crystal Space: csplugincommon/directx/directdetection.h Source File (Crystal Space Public API Reference)</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="head">
 <tr heigth="59">
  <td class="head" width="202" valign="bottom" style="padding-left:0;"><a href="http://www.crystalspace3d.org/"><img src="csblur.png" width="236" height="59" alt="CrystalSpace" border="0"></a></td>
  <td class="head"><h2>Public API Reference</h2></td>
 </tr>
 <tr heigth="11">
  <td colspan="2" class="headshadow" valign="top" style="padding-left:0;"><img src="csblurb.png" width="236" height="11" alt="" border="0"></td>
 </tr>
</table>
<div class="content">
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000005.html">csplugincommon</a>&nbsp;/&nbsp;<a class="el" href="dir_000008.html">directx</a></div>
<h1>directdetection.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">    Copyright (C) 1998 by Jorrit Tyberghein</span>
00003 <span class="comment"></span>
00004 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00005 <span class="comment">    modify it under the terms of the GNU Library General Public</span>
00006 <span class="comment">    License as published by the Free Software Foundation; either</span>
00007 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00008 <span class="comment"></span>
00009 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00010 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00012 <span class="comment">    Library General Public License for more details.</span>
00013 <span class="comment"></span>
00014 <span class="comment">    You should have received a copy of the GNU Library General Public</span>
00015 <span class="comment">    License along with this library; if not, write to the Free</span>
00016 <span class="comment">    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#ifndef __CS_DIRECTDETECTION_H__</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define __CS_DIRECTDETECTION_H__</span>
00021 <span class="preprocessor"></span>
00022 <span class="preprocessor">#include "csextern.h"</span>
00023 
00024 <span class="preprocessor">#if WINVER &gt;= 0x0500</span>
00025 <span class="preprocessor"></span><span class="preprocessor">  #define DIRECTINPUT_VERSION 0x0800</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00027 <span class="preprocessor"></span><span class="preprocessor">  #define DIRECTINPUT_VERSION 0x0300</span>
00028 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>
00030 <span class="preprocessor">#include &lt;windows.h&gt;</span>
00031 <span class="preprocessor">#include &lt;ddraw.h&gt;</span>
00032 <span class="preprocessor">#include &lt;d3d.h&gt;</span>
00033 <span class="preprocessor">#include &lt;d3dcaps.h&gt;</span>
00034 
00035 <span class="preprocessor">#include "csplugincommon/directx/iddetect.h"</span>
00036 
<a name="l00038"></a><a class="code" href="classDirectDetection2D.html">00038</a> <span class="keyword">class </span>CS_CSPLUGINCOMMON_DX_EXPORT DirectDetection2D
00039 {
00040 <span class="keyword">public</span>:
00041   DirectDetection2D()
00042   {
00043     Mipmap = <span class="keyword">false</span>; Texture = <span class="keyword">false</span>; Can3D = <span class="keyword">false</span>; Windowed = <span class="keyword">false</span>;
00044     IsPrimary2D = <span class="keyword">true</span>; DeviceName2D = 0; DeviceDescription2D = 0;
00045     ZeroMemory(&amp;Guid2D, <span class="keyword">sizeof</span>(GUID));
00046   }
00047   <span class="keyword">virtual</span> ~DirectDetection2D() 
00048   {
00049   }
00050 
00051   <span class="keywordtype">bool</span> Mipmap;                <span class="comment">// Can enable ddraw surface as mipmap ?</span>
00052   <span class="keywordtype">bool</span> Texture;               <span class="comment">// Can enable ddraw surface as texture ?</span>
00053   GUID Guid2D;                <span class="comment">// Guid for DirectDraw device</span>
00054   <span class="keywordtype">bool</span> Can3D;                 <span class="comment">// Have a support for d3d device ?</span>
00055   <span class="keywordtype">bool</span> Windowed;              <span class="comment">// Can enable windowed mode for graphics ?</span>
00056   <span class="keywordtype">bool</span> IsPrimary2D;           <span class="comment">// Is a primary ddraw device ?</span>
00057   <span class="keywordtype">char</span> * DeviceName2D;        <span class="comment">// Name of device</span>
00058   <span class="keywordtype">char</span> * DeviceDescription2D; <span class="comment">// Description of device</span>
00059 };
00060 
<a name="l00062"></a><a class="code" href="classDirectDetection3D.html">00062</a> <span class="keyword">class </span>CS_CSPLUGINCOMMON_DX_EXPORT DirectDetection3D : <span class="keyword">public</span> DirectDetection2D
00063 {
00064 <span class="keyword">public</span>:
00065   <span class="comment">// construct a device from ddraw (2d) device</span>
00066   DirectDetection3D(DirectDetection2D * dd2d)
00067   {
00068     Hardware = <span class="keyword">false</span>; AlphaBlendType = 0; AlphaBlend = <span class="keyword">false</span>, AlphaBlendHalo = <span class="keyword">false</span>;
00069     Perspective = <span class="keyword">false</span>; HighColor = <span class="keyword">false</span>; ZBuffer = <span class="keyword">false</span>;
00070     ZeroMemory(&amp;Desc3D, <span class="keyword">sizeof</span>(D3DDEVICEDESC));
00071     ZeroMemory(&amp;Guid3D, <span class="keyword">sizeof</span>(GUID));
00072     DeviceName3D = 0; DeviceDescription3D = 0;
00073     IsPrimary3D = <span class="keyword">true</span>;
00074 
00075     memcpy((DirectDetection2D *)<span class="keyword">this</span>, dd2d, <span class="keyword">sizeof</span>(DirectDetection2D));
00076   }
00077   DirectDetection3D():DirectDetection2D()
00078   {
00079     Hardware = <span class="keyword">false</span>; AlphaBlendType = 0; AlphaBlend = <span class="keyword">false</span>, AlphaBlendHalo = <span class="keyword">false</span>;
00080     Perspective = <span class="keyword">false</span>; HighColor = <span class="keyword">false</span>; ZBuffer = <span class="keyword">false</span>;
00081     ZeroMemory(&amp;Desc3D, <span class="keyword">sizeof</span>(D3DDEVICEDESC));
00082     ZeroMemory(&amp;Guid3D, <span class="keyword">sizeof</span>(GUID));
00083     DeviceName3D = 0; DeviceDescription3D = 0;
00084     IsPrimary3D = <span class="keyword">true</span>;
00085   }
00086   <span class="keyword">virtual</span> ~DirectDetection3D() {}
00087 
00088   <span class="keywordtype">bool</span> Hardware;              <span class="comment">// Is hardware device ?</span>
00089   <span class="keywordtype">bool</span> AlphaBlend;            <span class="comment">// Can enable AlphaBlend for lightmap ?</span>
00090   <span class="keywordtype">bool</span> AlphaBlendHalo;            <span class="comment">// Can enable AlphaBlend for halo ?</span>
00091   <span class="keywordtype">int</span> AlphaBlendType;         <span class="comment">// type of AphaBlend supported</span>
00092   <span class="keywordtype">bool</span> Perspective;           <span class="comment">// Can enable perspective ?</span>
00093   <span class="keywordtype">bool</span> VideoMemoryTexture;    <span class="comment">// Can push texture in video memory ?</span>
00094   <span class="keywordtype">bool</span> HighColor;             <span class="comment">// Can enable 16 bit mode</span>
00095   <span class="keywordtype">bool</span> ZBuffer;               <span class="comment">// Have a ZBuffer ?</span>
00096   D3DDEVICEDESC Desc3D;       <span class="comment">// D3DDEVICEDESC for complete information</span>
00097   GUID Guid3D;                <span class="comment">// Guid for Direct3D device</span>
00098   <span class="keywordtype">bool</span> IsPrimary3D;           <span class="comment">// Is a primary d3d device ?</span>
00099   <span class="keywordtype">char</span> * DeviceName3D;        <span class="comment">// Device name</span>
00100   <span class="keywordtype">char</span> * DeviceDescription3D; <span class="comment">// Device description</span>
00101 };
00102 
<a name="l00104"></a><a class="code" href="classDirectDetectionDevice.html">00104</a> <span class="keyword">class </span>CS_CSPLUGINCOMMON_DX_EXPORT DirectDetectionDevice : <span class="keyword">public</span> DirectDetection3D, 
00105   <span class="keyword">public</span> IDirectDetectionInternal
00106 {
00107 <span class="keyword">public</span>:
00108   DirectDetectionDevice():DirectDetection3D() {next = 0; Only2D = <span class="keyword">true</span>;}
00109   <span class="keyword">virtual</span> ~DirectDetectionDevice() {}
00110 
00111   <span class="keywordtype">bool</span> Only2D; <span class="comment">// Is only a 2d device ?</span>
00112   DirectDetectionDevice * next;
00113 
00114   STDMETHODIMP_(LPD3DDEVICEDESC) GetDesc3D()  { <span class="keywordflow">return</span> &amp;Desc3D; }
00115   STDMETHODIMP_(LPGUID) GetGuid3D() { <span class="keywordflow">return</span> &amp;Guid3D; }
00116   STDMETHODIMP_(<span class="keywordtype">bool</span>) GetMipmap() { <span class="keywordflow">return</span> Mipmap; }
00117   STDMETHODIMP_(<span class="keywordtype">bool</span>) GetAlphaBlend() { <span class="keywordflow">return</span> AlphaBlend; }
00118   STDMETHODIMP_(<span class="keywordtype">int</span>) GetAlphaBlendType() { <span class="keywordflow">return</span> AlphaBlendType; }
00119   STDMETHODIMP_(<span class="keywordtype">bool</span>) GetAlphaBlendHalo() { <span class="keywordflow">return</span> AlphaBlendHalo; }
00120   STDMETHODIMP_(<span class="keywordtype">bool</span>) GetHardware() { <span class="keywordflow">return</span> Hardware; }
00121 };
00122 
00123 <span class="comment">// master class of the device detection of direct3d and directdraw</span>
00124 <span class="keyword">class </span>CS_CSPLUGINCOMMON_DX_EXPORT DirectDetection
00125 {
00126 <span class="keyword">public</span>:
00127   <span class="keywordtype">bool</span> Have2DDevice();
00128   <span class="keywordtype">bool</span> Have3DDevice();
00129   DirectDetection();
00130   <span class="keyword">virtual</span> ~DirectDetection();
00131   DirectDetectionDevice * findBestDevice3D(<span class="keywordtype">bool</span> fscreen);
00132   DirectDetectionDevice * findBestDevice2D(<span class="keywordtype">int</span> displayNumber = 0);
00133   <span class="keywordtype">int</span> addDevice(DirectDetection2D * dd2d);
00134   <span class="keywordtype">int</span> addDevice(DirectDetection3D * dd3d);
00135   <span class="keywordtype">bool</span> checkDevices();
00136   <span class="keywordtype">bool</span> checkDevices2D();
00137   <span class="keywordtype">bool</span> checkDevices3D();
00138 
00139   <span class="keywordtype">void</span> ReportResult (<span class="keywordtype">int</span> severity, <span class="keywordtype">char</span> *str, HRESULT hRes);
00140   <span class="keywordtype">void</span> SystemFatalError (<span class="keywordtype">char</span> *str, HRESULT hRes);
00141 
00142   DirectDetectionDevice * Devices; <span class="comment">// list of devices</span>
00143   <a class="code" href="structiObjectRegistry.html">iObjectRegistry</a>* object_reg;
00144 };
00145 
00146 <span class="preprocessor">#endif // __CS_DIRECTDETECTION_H__</span>
</pre></div><hr size="1"><address><small>Generated for Crystal Space by 
<a href="http://www.doxygen.org/index.html">doxygen</a> 1.3.9.1 
</small></address> </div></body> </html>
