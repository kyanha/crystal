<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HTML>
<HEAD>
<TITLE>Crystal Space: En Socket</TITLE>

<META NAME="description" CONTENT="Crystal Space: En Socket">
<META NAME="keywords" CONTENT="Crystal Space: En Socket">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC404"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_164.html#SEC403"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_166.html#SEC408"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_163.html#SEC395"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_164.html#SEC403"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_166.html#SEC408"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_288.html#SEC939">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H3> 7.5.1 EN Socket </H3>
<!--docid::SEC404::-->
<P>

The EN Network Driver consists of two components.
</P><P>

<DL COMPACT>
<DT><EM>Network Driver</EM>
<DD>System independent network driver.  This driver implements a TCP/IP
networking interface.  The network driver and socket driver currently support
BSD compliant calls.
<P>

<EM>Note</EM>: Some operating systems may not support all the functions of
this plugin.
</P><P>

<DT><EM>Network Driver</EM>
<DD>Network Driver.  This driver is used to create an implementation of the Socket
Driver via the <CODE>CreateSocket()</CODE> call.  The Network Driver calls
appropriate socket startup/shutdown calls for the operating system.
<P>

<DT><EM>Socket Driver</EM>
<DD>This driver handles all the connection functions.  This driver is implemented
by calling the <CODE>CreateSocket()</CODE> call located in the Network Driver.  The
Socket Driver supports the following features (some might not work on all
operating systems):
<P>

<UL>
<LI>
TCP/UDP connections over TCP/IP networks.
<LI>
Blocking/non-blocking calls.
<LI>
Sending/receiving of data across the connection.
<LI>
Blocking/non-blocking buffered read function.
</UL>
</DL>
<P>

<A NAME="SEC405"></A>
<H3> Network Driver </H3>
<!--docid::SEC405::-->
<P>

The Network Driver is used to setup the socket sub-system.  The driver's
purpose is to provide a method for creating a BSD sockets compliant socket
of either UDP or TCP type.  Upon construction all appropriate socket
start-up calls are made, like wise with the destructor.
</P><P>

<DL COMPACT>
<DT><CODE>CreateSocket()</CODE>
<DD>Returns a socket that has been created with the type of TCP or UDP.
<DT><CODE>LastError()</CODE>
<DD>Returns the last error that was encountered.
</DL>
<P>

<A NAME="SEC406"></A>
<H3> Socket Driver </H3>
<!--docid::SEC406::-->
<P>

The Socket Driver is used to supply a common interface to a low-level
TCP/IP network connection.  It allows connecting/accepting TCP and
UDP based socket connections.  It provides very basic BSD compliant
functionality.
</P><P>

<DL COMPACT>
<DT><CODE>LastError()</CODE>
<DD>Returns the last error that was encountered.
<DT><CODE>LastOSError()</CODE>
<DD>Returns the last error that is returned by the operating system.
<DT><CODE>IsConnected()</CODE>
<DD>Returns true or false depending upon the status of the connection.
<DT><CODE>SetSocketBlock()</CODE>
<DD>This function sets the blocking/non-blocking attribute of the socket.
<DT><CODE>SetSocketReuse()</CODE>
<DD>This function sets the "reuse" attribute of a listening socket.
<DT><CODE>Connect()</CODE>
<DD>This function connects to a remote host and port.
<DT><CODE>Send()</CODE>
<DD>This function sends a number of bytes to the remote connection.
<DT><CODE>Recv()</CODE>
<DD>This function reads a number of bytes from the remote connection.
<DT><CODE>Close()</CODE>
<DD>This function closes the socket and it is no longer valid after this point.
<DT><CODE>Disconnect()</CODE>
<DD>This function closes the connection then closes the socket.
<DT><CODE>WaitForConnection()</CODE>
<DD>This function sets the socket up for incoming connections on a port.
<DT><CODE>Accept()</CODE>
<DD>This function returns a socket that is connected to a incoming connection 
from a remote system.
<DT><CODE>set()</CODE>
<DD>This function is for internal use and should not be called.
<DT><CODE>ReadLine()</CODE>
<DD>This function performs a buffered read in both tcp blocking/non-blocking modes.
<DT><CODE>RemoteName()</CODE>
<DD>This function returns the remote name/IP of the remote connection.
</DL>
<P>

<A NAME="SEC407"></A>
<H3> Example </H3>
<!--docid::SEC407::-->
<P>

Here is a simple example showing the module in use.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include "inetwork/driver2.h"
#include "inetwork/socket2.h"
#include "inetwork/sockerr.h"

csRef&#60;iNetworkDriver2&#62; netdriver;
csRef&#60;iSocketDriver2&#62; client;
csRef&#60;iSocketDriver2&#62; server;

<small>...</small>

netdriver = CS_QUERY_REGISTRY(object_reg, iNetworkDriver2);
if (!netdriver)
{
  <small>...</small>
}

// Create TCP socket.
server = netdriver-&#62;CreateSocket(CS_NET_SOCKET_TYPE_TCP);

// Last error is netdriver-&#62;LastError().
if (server)
{
  server-&#62;SetSocketReuse(true);
  if (server-&#62;LastError() != CS_NET_SOCKET_NOERROR)
    printf("Unable to set reuse option.\n");
  server-&#62;SetSocketBlock(true);
  if (server-&#62;LastError() != CS_NET_SOCKET_NOERROR)
    printf("Unable to set block option.\n");
  // Wait on port 9999 queue up to 5 connections.
  server-&#62;WaitForConnection(0, 9999, 5);
  if (server-&#62;LastError() != CS_NET_SOCKET_NOERROR)
    printf("Unable to bind to port.\n");
}

<small>...</small>

if (server)
{
  client = server-&#62;Accept();
  if (client != 0)
  {
    // We have a connection.
    client-&#62;Send("hello\r\n",7);
    client-&#62;Disconnect();
  }
  server-&#62;Close();
}
</pre></td></tr></table></P><P>

<A NAME="csEngine"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_164.html#SEC403"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_166.html#SEC408"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_163.html#SEC395"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_164.html#SEC403"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_166.html#SEC408"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_288.html#SEC939">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated using
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
