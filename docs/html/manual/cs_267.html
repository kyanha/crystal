<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HTML>
<HEAD>
<TITLE>Crystal Space: MacOS/X Dynamic Linking</TITLE>

<META NAME="description" CONTENT="Crystal Space: MacOS/X Dynamic Linking">
<META NAME="keywords" CONTENT="Crystal Space: MacOS/X Dynamic Linking">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC806"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_266.html#SEC805"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_268.html#SEC807"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_263.html#SEC802"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_264.html#SEC803"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_268.html#SEC807"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC957">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H4> 8.1.1.3 Dynamic Linking </H4>
<!--docid::SEC806::-->
<P>

On most platforms, symbols are private to a plugin module unless explicitly
exported.  However, on MacOS/X, symbols in plugin modules are typically public
by default.  Prior to MacOS/X 10.1, symbols in plugins existed in a <EM>flat
namespace</EM> shared by the application and all plugin modules.  This means that
it was possible for symbols defined in one plugin to conflict with those
defined in the application or in other plugins.  As of MacOS/X 10.1, Apple
introduced the concept of <EM>two-level namespace</EM>, in which symbols for a
plugin exist within that plugin's own namespace, thus eliminating the problem
of symbolic conflicts between plugins and the application, or plugins and other
plugins.
</P><P>

On other platforms, where plugin symbols are private by default, plugin modules
are themselves link against any required static libraries in order to satisfy
external symbolic references.  Historically, this differed from pre-10.1
MacOS/X in which it was customary to link the application against any libraries
which might have been required by plugin modules, rather than linking the
plugin modules, themselves, against the libraries.  There are a couple problems
with this older approach.
</P><P>

<UL>
<LI>
It is not always possible to know ahead of time which static libraries will be
required by a set of plugin modules since those modules may come from
independent sources.  Thus, it is neither practical nor always possible to
link the application against the correct set of static libraries.  As a
corollary, this often means having to add special cases to otherwise general
makefiles in order to specify an extended set of static libraries when invoking
the static linker to build the application's executable image.
<P>

<LI>
Even though an application may be linked against a static library for the
purpose of making that library available to a plugin module, often the
application itself makes no reference to symbols within the library.  In order
to force the linker to actually incorporate the library into the application
some artificial mechanism for forcing references to symbols within the library
must be invented.  Often this involves employing special switches when
invoking the linker or manually faking hard symbolic references within the
source code itself.
<P>

<LI>
It is highly fragile and often problematic since even a small change to the
external symbolic references of a plugin module may require that the
application be relinked against a different set of static libraries.
</UL>
<P>

The approach used by other platforms, where plugin modules are linked directly
against any static libraries which they require, has several advantages.
</P><P>

<UL>
<LI>
Plugin modules are self-contained since external symbolic references have
already been satisfied, thus there is no need for the application to attempt to
satisfy those references.
<P>

<LI>
An application needs to be linked only against the set of libraries which it
requires.  There is no need to try to fathom the set of libraries which
<EM>might</EM> one day be required by plugin modules.  As a corollary there is
no need to invent artificial mechanisms for forcing libraries to be linked into
the application which are not required by the application itself.
<P>

<LI>
It is much more robust since a change in the symbolic requirements of any
given plugin module will not require re-linking of the application against
a new set of libraries.
</UL>
<P>

Prior to the introduction of two-level namespaces with MacOS/X 10.1, in order
to avoid the fragility of flat namespaces, and in order to avoid having to
invent special case solutions to work around these problems, the MacOS/X port
of Crystal Space emulated the model of dynamic linking used on other platforms.
This was accomplished by linking plugin modules against the static libraries
which they require, rather than linking those libraries into the application.
</P><P>

The one major pitfall which makes employment of this approach difficult in a
flat namespace, is that of symbolic conflicts where the same symbol is defined
in more than one place.  This problem can occur, for instance, when more than
one plugin module links with the same static library, and when both a plugin
module and the application link against the same static library.  To work
around this problem, the MacOS/X port takes advantage of DYLD's
`<SAMP>NSLinkEditErrorHandlers</SAMP>' which allows the loader to ignore duplicate
symbols at load time.
</P><P>

Although this special manual symbol management is not required with two-level
namespaces, the functionality is nevertheless retained for backward
compatibility with older MacOS/X releases.
<A NAME="Threads in CS"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_266.html#SEC805"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_268.html#SEC807"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_263.html#SEC802"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_264.html#SEC803"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_268.html#SEC807"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC957">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated using
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
