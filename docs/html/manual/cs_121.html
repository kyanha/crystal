<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HTML>
<HEAD>
<TITLE>Crystal Space: HOWTO Pixmaps</TITLE>

<META NAME="description" CONTENT="Crystal Space: HOWTO Pixmaps">
<META NAME="keywords" CONTENT="Crystal Space: HOWTO Pixmaps">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC277"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_120.html#SEC273"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_122.html#SEC283"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_102.html#SEC210"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_110.html#SEC226"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_135.html#SEC355"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC950">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H3> 5.8.11 Loading Images for Pixmaps </H3>
<!--docid::SEC277::-->
<P>

This section describes how you can load an image and use it on a pixmap.  A
pixmap is a small graphics class that can be used independently from the
engine.  It is very useful for CSWS (see section <A HREF="cs_151.html#SEC376">6.4 Crystal Space Windowing System (CSWS)</A>), to draw a logo on
screen or to use for a <EM>heads-up-display</EM> (HUD).
</P><P>

<A NAME="SEC278"></A>
<H4> Getting the Image Loader Plugin </H4>
<!--docid::SEC278::-->
<P>

To load an image you need the image loader plugin. There are two
ways to make sure you have this plugin in your application. You can put
a line in your configuration file like this:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>System.Plugins.iImageIO = crystalspace.graphic.image.io.multiplex
</pre></td></tr></table></P><P>

Or you can add the following line to the call to
<CODE>csInitializer::RequestPlugins()</CODE> in your <CODE>main()</CODE> function:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>CS_REQUEST_IMAGELOADER,
</pre></td></tr></table></P><P>

To actually use the image loader in your application you need to ask the
shared-object registry for a handle to the image loader:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>csRef&#60;iImageIO&#62; imgldr = CS_QUERY_REGISTRY (object_reg, iImageIO);
</pre></td></tr></table></P><P>

<A NAME="SEC279"></A>
<H4> Loading the Image from VFS </H4>
<!--docid::SEC279::-->
<P>

Next, you will probably want to load the image from VFS (see section <A HREF="cs_159.html#SEC393">7.2 Virtual File System (VFS)</A>).
This is accomplished by loading the image as raw data and then asking the image
loader to re-interpret the raw data as an actual `<SAMP>iImage</SAMP>' resource.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>csRef&#60;iDataBuffer&#62; buf = VFS-&#62;ReadFile ("/lib/mydata/test.jpg");
csRef&#60;iImage&#62; ifile = imgldr-&#62;Load (buf-&#62;GetUint8 (),
  buf-&#62;GetSize (), txtmgr-&#62;GetTextureFormat ());
iTextureHandle* txt = txtmgr-&#62;RegisterTexture (ifile, CS_TEXTURE_2D);
txt-&#62;Prepare ();
</pre></td></tr></table></P><P>

This code first uses VFS to load the image from the given VFS
path. This will only load the image data. VFS doesn't know how to parse
images. This is the responsibility of the image loader. This is what the
next line does. Here you give the loaded buffer to the image loader which
will return the loaded image with an <CODE>iImage</CODE> pointer.
</P><P>

Now you have to make sure the image becomes a texture that is usable for
drawing on screen. This is done with <CODE>txtmgr-&#62;RegisterTexture()</CODE>. Because
we are going to use the texture for a pixmap (which is 2D) we use the
`<SAMP>CS_TEXTURE_2D</SAMP>' flag. After registering the texture we have to
<CODE>Prepare()</CODE> it for use.
</P><P>

<A NAME="SEC280"></A>
<H4> Using the Texture in a Pixmap </H4>
<!--docid::SEC280::-->
<P>

To create a pixmap using this texture you can simply do:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>csSimplePixmap* pixmap = new csSimplePixmap (txt);
</pre></td></tr></table></P><P>

<A NAME="SEC281"></A>
<H4> Drawing the Pixmap </H4>
<!--docid::SEC281::-->
<P>

There are various ways to draw the pixmap. Check out the API documentation
for more info. But here is one example:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>pixmap-&#62;DrawScaled (G3D, 10, 10, 400, 400);
</pre></td></tr></table></P><P>

This will draw the pixmap at location 10, 10 with dimension 400, 400.
If needed it will scale so that the pixmap really fits there.
</P><P>

<A NAME="SEC282"></A>
<H4> Include Files         </H4>
<!--docid::SEC282::-->
<P>

The include files useful for this section are:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include "cstool/cspixmap.h"
#include "igraphic/image.h"
#include "igraphic/imageio.h"
#include "ivideo/texture.h"
#include "ivideo/txtmgr.h"
#include "iutil/vfs.h"
</pre></td></tr></table><A NAME="HOWTO Render Priorities"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_120.html#SEC273"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_122.html#SEC283"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_102.html#SEC210"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_110.html#SEC226"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_135.html#SEC355"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="index.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_286.html#SEC950">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="cs_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated using
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
