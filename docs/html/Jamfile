SubDir TOP docs html ;

## InstallHTMLDocs dir : installdir
##   Recursively scan 'dir' for HTML and related files (such as .jpg,
##   .png, .css, etc.) and invoke InstallDoc for each discovered
##   resource. 'installdir' is passed to InstallDoc as the root of the
##   installed directory corresponding to 'dir'.
rule InstallHTMLDocs
{
    local dir = [ ConcatDirs $(SUBDIR) $(<) ] ;
    local i ;
    local docfiles ;
    local files = [ GLOB $(dir) : * ] ;

    for i in $(files) {
        switch $(i:S) {
            case .html : docfiles += $(i) ;
            case .jpg  : docfiles += $(i) ;
            case .jpeg : docfiles += $(i) ;
            case .png  : docfiles += $(i) ;
            case .gif  : docfiles += $(i) ;
            case .css  : docfiles += $(i) ;
            case $(DOT)  :
            case $(DOTDOT) :
            case *  : InstallHTMLDocs $(<) $(i:BS) : $(2) ;
        }
    }
    InstallDoc $(docfiles) : $(2) $(<) ;
}

# The 'manual' and 'api' subdirectories are generated automatically by
# $(TOP)/bin/jobber.pl on a daily basis. That script processes and knows about
# generated files only, and will correctly 'cvs add' and 'cvs remove' items
# from those directories as required.  Consequently, we can not have Jamfiles
# in those directories (since jobber.pl would "cvs remove" them because they
# are not "generated").  Therefore, we perform tasks for those subdirectories
# here instead.

SubDir TOP docs html manual ;
InstallHTMLDocs : html manual ;

SubDir TOP docs html api ;
InstallHTMLDocs : html api ;
