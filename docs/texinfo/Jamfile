SubDir TOP docs texinfo ;

{
local alltexi = cs-unix.txi [ Filter [ Recurse : .txi ] :
  cs-unix.txi cs-dos.txi cs-mac.txi dosdef.txi macdef.txi unixdef.txi ] ;

Texi2Info manualinfo : $(alltexi) : info : info manual : crystalspace.info ;
Help manualinfo : "Convert user manual to Info format" ;

Texi2HTML manualhtml : $(alltexi) : html manual : : -prefix=cs ;
Help manualhtml : "Convert user manual to HTML format" ;

Texi2DVI manualdvi : $(alltexi) : dvi manual : csmanual.dvi ;
Help manualdvi : "Convert user manual to DVI format" ;

Texi2PS manualps : $(alltexi) : ps manual : csmanual.ps ;
Help manualps : "Convert user manual to PostScript format" ;

Texi2PDF manualpdf : $(alltexi) : pdf manual : csmanual.pdf ;
Help manualpdf : "Convert user manual to PDF format" ;

if $(PERL)
{
  NODEFIX ?= [ ConcatDirs $(TOP) docs support nodefix.pl ] ;

  rule RepairNodes
  {
    Depends $(<) : $(>) ;
    NotFile $(<) ;
    Always $(<) ;
    SEARCH on $(>) = $(3) ;
    TEXINFO.INCDIR on $(<) = $(3) ;
  }

  actions RepairNodes
  {
    $(PERL) "$(NODEFIX)" --include-dir="$(TEXINFO.INCDIR)" "$(>)" ;
  }

  RepairNodes repairdoc : cs-unix.txi : $(SUBDIR) ;
  Help repairdoc : "Repair Texinfo @node and @menu directives" ;
}

}
