<?xml version="1.0" encoding="utf-8" ?> 
<shader name="lightmap">
    <!-- This should be defined by renderloop somehow and track sector ambient -->
    <declare name="STANDARD_LIGHT_AMBIENT" type="vector3" default="1.0, 1.0, 1.0" />
    <technique priority="50">
	<pass>
	    <mixmode><copy /></mixmode>
	    <streammapping stream="vertices" destination="position" />
	    <streammapping stream="texture coordinates" destination="texture coordinate 0" />
	    <streammapping stream="lightmap coordinates" destination="texture coordinate 1" />
	    <vp type="gl_fixed_vp" file="/shader/lightmap.fvp"/>
	    <texturemapping unit="0" name="tex diffuse" />
	    <texturemapping unit="1" name="tex lightmap" />
	    <fp type="gl_fixed_fp">
		<fixedfp>
		    <layer>
			<colorsource num="0" source="texture" modifier="color"/>
			<coloroperation operation="replace"/>
		    </layer>
		    <layer>
			<colorsource num="0" source="previous layer" modifier="color"/>
			<colorsource num="1" source="texture" modifier="color"/>
			<coloroperation operation="modulate" scale="2" />
		    </layer>
		</fixedfp>
	    </fp>
	</pass>
    </technique>
</shader>
